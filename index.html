<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.1">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.1" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.1">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="雅俗共赏">
<meta property="og:url" content="https://houzixiashanxiedaima.github.io/index.html">
<meta property="og:site_name" content="雅俗共赏">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="GenJi Wang">
<meta name="twitter:card" content="summary">
  <link rel="canonical" href="https://houzixiashanxiedaima.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>雅俗共赏</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">雅俗共赏</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
        
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      
    
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">
          <i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/%E5%A4%9A%E4%BB%93%E5%BA%93%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/%E5%A4%9A%E4%BB%93%E5%BA%93%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">多仓库配置</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 16:10:18 / 修改时间：08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T16:10:18+00:00">2020-01-13</time>
            </span>
          
            

            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%88%86%E7%B1%BB/" itemprop="url" rel="index">
                    <span itemprop="name">分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#　多仓库配置</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/Material-Design-%E4%B9%8BTabLayout%E4%B8%8EToolbar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/Material-Design-%E4%B9%8BTabLayout%E4%B8%8EToolbar/" class="post-title-link" itemprop="url">Material-Design-之TabLayout与Toolbar</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T08:11:53+00:00">2020-01-13</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天在学习Material Design的过程中，遇到了一个比较坑的问题，在这里记录一下，以后如果有人遇到的话，可以做个参考吧。首先来看看我们的需求，今天我们需要实现下面这个效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-d8903fa389d460a8.gif?imageMogr2/auto-orient/strip" alt="需求.gif"></p>
<blockquote>
<p>图片来自blog：<a href="http://blog.csdn.net/eclipsexys/article/details/46349721" target="_blank" rel="noopener">http://blog.csdn.net/eclipsexys/article/details/46349721</a></p>
</blockquote>
<p>大家可以看到这个需求其实是非常简单的，就是有个Toolbar和一个TabLayout，然后在TabLayout中有个列表，根据列表的上下滑动，Toolbar也相应的隐藏和显示。我们都知道这个是Material Design中的动画效果，那么我们就直接开始动手编码来实现这个效果。首先贴出布局部分的代码吧：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.design.widget.CoordinatorLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/activity_base"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.AppBarLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/appbar"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:theme</span>=<span class="string">"@style/AppTheme.AppBarOverlay"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_scrollFlags</span>=<span class="string">"scroll|enterAlways"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:popupTheme</span>=<span class="string">"@style/AppTheme.PopupOverlay"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.design.widget.TabLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/tabs"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.design.widget.AppBarLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.v4.view.ViewPager</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/viewpager"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_behavior</span>=<span class="string">"@string/appbar_scrolling_view_behavior"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.design.widget.CoordinatorLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面就是我们主布局的代码，然后我们看看ViewPager对应的布局的代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.NestedScrollView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_behavior</span>=<span class="string">"@string/appbar_scrolling_view_behavior"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/section_label"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">ListView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/listview"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_below</span>=<span class="string">"@id/section_label"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.NestedScrollView</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这个里面的代码也很简单，就是一个ListView，主要的作用就是上下滑动，然后触发Toolbar的动画。<br>剩下的就是一些简单的Fragment和一些控件初始化之类的，就不贴代码了，然后我们直接运行。运行之后截图如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-82aeab75e5c07db8.gif?imageMogr2/auto-orient/strip" alt="运行结果.gif"></p>
<p>运行结果如上图，请大家忽视这个画质的问题，视频转GIF真是心累。</p>
<blockquote>
<p>如果大家有什么好的视频转GIF的工具，可以给我推荐一下。</p>
</blockquote>
<p>有细心的朋友可能已经发现问题了，当我们将列表往上滑动时，Toolbar确实隐藏了起来，但是在最后，屏幕的左上角还留有一些没有隐藏起来。这是第一个问题，还有一个比较细节的问题是我们通过对比我们的<code>需求图片</code>和<code>运行结果</code>图片，可以发现：<br>需求图片中向上滑动时，状态栏是保持不动的，Toolbar和TabLayout向上滑动，给人一种状态栏是在Toolbar和Tablayout上方的感觉。<br>运行结果向上滑动时，状态栏也会向上滑，给人的感觉就像是被Toolbar和TabLayout挤上去的样子。</p>
<p>基于以上的两个不同之处，我们大致可以推断出Toolbar没有完全隐藏可能是因为状态栏的原因，那么我们就开始着手解决这个问题。</p>
<ul>
<li>从布局开始<br>首先我们进行了将主布局的<code>android:fitsSystemWindows=&quot;true&quot;</code>放到不同的地方，看看是否是这行代码出了问题，我分别将这行代码放到了CoordinatorLayout、AppBarLayout、Toolbar、TabLayout等多个地方，最后发现并没有解决问题。但是在这个过程中，却有一个小的变化是比较奇怪的，那就是当我<code>android:fitsSystemWindows=&quot;true&quot;</code>这行代码移出CoordinatorLayout中时，我们运行程序之后会出现如下结果：<br><img src="http://upload-images.jianshu.io/upload_images/2524102-cdda1190eb30c4a7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="将上述代码移动到AppBarLayout中的结果"></li>
</ul>
<p>从上图中我们可以看到，上面的状态栏变白了。这个发现就更加印证了我们之前的推测：这件事情肯定和状态栏有关系。既然已经知道这个，那么我们就可以从第二个方面来解决。</p>
<ul>
<li><p>从代码入手<br>我们尝试着在<strong>进行了第一步尝试的基础上</strong>在代码中将状态栏的颜色修改一下<code>getWindow().setStatusBarColor(getResources().getColor(R.color.colorPrimaryDark));</code>修改完之后，发现是可以得到和需求一样的结果。问题得到了完美的解决……吗？我们都知道上面这修改状态栏颜色的代码是在api&gt;=21才可以用的，那如果api&lt;21怎么办？可能有人会说用开源库来修改啊。这个确实是一种非常好的解决办法，但是我并不想“撞大运”式的将这个问题解决。所以我们还得继续的深入查找问题，那么这个时候就想到了，和状态栏有关的属性，除了布局文件中和代码中，还有一个地方，就是<code>style.xml</code>中。</p>
</li>
<li><p>从<code>style.xml</code>入手<br>先贴出代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme.NoActionBar"</span>&gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"windowActionBar"</span>&gt;</span>false<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"windowNoTitle"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowDrawsSystemBarBackgrounds"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:statusBarColor"</span>&gt;</span>@android:color/transparent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面这个是<code>style.xml</code>(v21)的代码，从这段代码中我们就可以找到这次这个bug的罪魁祸首了。就是这一行<code>&lt;item name=&quot;android:statusBarColor&quot;&gt;@android:color/transparent&lt;/item&gt;</code><br>就是这行代码将我们的状态栏给弄成了透明了，结果就导致我们看到的状态栏和布局文件是在同一个z轴上，也就是会被挤上去，从而导致我们的Toolbar不能完全的隐藏起来。</p>
</li>
</ul>
<p>最后，为什么这个小bug费了这么大劲才找出来，我上面这一整套代码，基本上都是在android studio 中新建一个TabActivity 自动生成的。也就说原本自动生成的代码就有这个Bug，谁能想到android studio 这个浓眉大眼的家伙也”叛变革命”了呢。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/NavigationView-%E5%AD%90%E8%8F%9C%E5%8D%95%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/NavigationView-%E5%AD%90%E8%8F%9C%E5%8D%95%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">NavigationView-子菜单问题</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T08:11:53+00:00">2020-01-13</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在Android 5.0之后，Google推出了Material Design兼容库，在Material Design的兼容库中，有个用的比较多的控件就是<code>NavigationView</code>。在我们平时使用过程中，对于<code>NavigationView</code>的一些小细节可能也并没有过多的关注，所以就导致我们在遇到特殊需求的时候无从下手，那么在这里我就简单记录一下使用<code>NavigationView</code>的一些小坑，暂时可能也并没有遇到很多的坑，如果以后遇到的话会不定时更新。</p>
<h2 id="NavigationView基本使用"><a href="#NavigationView基本使用" class="headerlink" title="NavigationView基本使用"></a>NavigationView基本使用</h2><p>有很多人对于<code>NavigationView</code>的基本使用还是比较了解的， 那么我这里推荐一种非常偷懒的方法，就是我们在<code>Android Studio</code>中新建<code>Activity</code>时可以直接进行如下操作：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-ed42f064db473404.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="New Navigation Activity.png"></p>
<p>在选择了<code>Navigation Drawer Activity</code>之后会出现如下界面：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-ba08509342d568c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Navigation Drawer Activity.png"></p>
<p>然后点击<code>Finish</code>就可以完成一个最基础的带有<code>NavigationView</code>的<code>Activity</code>创建，创建之后就可以在原有的基础上进行修改了，这样也是非常的方便。</p>
<h2 id="NavigationView-Menu的设置"><a href="#NavigationView-Menu的设置" class="headerlink" title="NavigationView Menu的设置"></a>NavigationView Menu的设置</h2><h3 id="Menu的第一种布局设置"><a href="#Menu的第一种布局设置" class="headerlink" title="Menu的第一种布局设置"></a>Menu的第一种布局设置</h3><p>最基本的<code>Menu</code>的设置就是每行一个项目。在<code>menu</code>中的代码是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;menu xmlns:android&#x3D;&quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&quot;&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id&#x3D;&quot;@+id&#x2F;nav_camera&quot;</span><br><span class="line">        android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_camera&quot;</span><br><span class="line">        android:title&#x3D;&quot;Import&quot;&#x2F;&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id&#x3D;&quot;@+id&#x2F;nav_gallery&quot;</span><br><span class="line">        android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_gallery&quot;</span><br><span class="line">        android:title&#x3D;&quot;Gallery&quot;&#x2F;&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id&#x3D;&quot;@+id&#x2F;nav_slideshow&quot;</span><br><span class="line">        android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_slideshow&quot;</span><br><span class="line">        android:title&#x3D;&quot;Slideshow&quot;&#x2F;&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id&#x3D;&quot;@+id&#x2F;nav_manage&quot;</span><br><span class="line">        android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_manage&quot;</span><br><span class="line">        android:title&#x3D;&quot;Tools&quot;&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;item</span><br><span class="line">        android:id&#x3D;&quot;@+id&#x2F;nav_share&quot;</span><br><span class="line">        android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_share&quot;</span><br><span class="line">        android:title&#x3D;&quot;Share&quot;&#x2F;&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:id&#x3D;&quot;@+id&#x2F;nav_send&quot;</span><br><span class="line">        android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_send&quot;</span><br><span class="line">        android:title&#x3D;&quot;Send&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;menu&gt;</span><br></pre></td></tr></table></figure>
<p>实际效果是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-d4299d3d8b622021.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="normal menu.png"></p>
<p>通过上面的图片我们可以看到，这样设置之后，每个<code>item</code>都是独立的，各占一行，每一行代表着一个操作。</p>
<h3 id="Menu的第二种布局设置"><a href="#Menu的第二种布局设置" class="headerlink" title="Menu的第二种布局设置"></a>Menu的第二种布局设置</h3><p>子菜单的设置是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;menu xmlns:android&#x3D;&quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;group android:checkableBehavior&#x3D;&quot;single&quot;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_camera&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_camera&quot;</span><br><span class="line">            android:title&#x3D;&quot;Import&quot;&#x2F;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_gallery&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_gallery&quot;</span><br><span class="line">            android:title&#x3D;&quot;Gallery&quot;&#x2F;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_slideshow&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_slideshow&quot;</span><br><span class="line">            android:title&#x3D;&quot;Slideshow&quot;&#x2F;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_manage&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_manage&quot;</span><br><span class="line">            android:title&#x3D;&quot;Tools&quot;&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;group&gt;</span><br><span class="line">    &lt;item android:title&#x3D;&quot;Communicate&quot;&gt;</span><br><span class="line">        &lt;menu&gt;</span><br><span class="line">            &lt;item</span><br><span class="line">                android:id&#x3D;&quot;@+id&#x2F;nav_share&quot;</span><br><span class="line">                android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_share&quot;</span><br><span class="line">                android:title&#x3D;&quot;Share&quot;&#x2F;&gt;</span><br><span class="line">            &lt;item</span><br><span class="line">                android:id&#x3D;&quot;@+id&#x2F;nav_send&quot;</span><br><span class="line">                android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_send&quot;</span><br><span class="line">                android:title&#x3D;&quot;Send&quot;&#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;menu&gt;</span><br><span class="line">    &lt;&#x2F;item&gt;</span><br><span class="line">    &lt;item</span><br><span class="line">        android:title&#x3D;&quot;about&quot;&gt;</span><br><span class="line">        &lt;menu&gt;</span><br><span class="line">            &lt;item</span><br><span class="line">                android:id&#x3D;&quot;@+id&#x2F;nav_about&quot;</span><br><span class="line">                android:icon&#x3D;&quot;@drawable&#x2F;ic_history&quot;</span><br><span class="line">                android:title&#x3D;&quot;about&quot;&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;&#x2F;menu&gt;</span><br><span class="line">    &lt;&#x2F;item&gt;</span><br><span class="line">&lt;&#x2F;menu&gt;</span><br></pre></td></tr></table></figure>
<p>设置之后的效果是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-14bcb6aaaca2a190.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="group menu.png"></p>
<p>通过这种设置分组之后，我们可以发现，每个组是一起的，是通过<code>group</code>将同一个组的<code>item</code>包裹起来，组内的<code>item</code>可能会相互影响，这取决于你设置属性<code>android:checkableBehavior</code>的值。而且在上面的图片中我们也可以发现一个小的细节，就是我们组和组之间有一条小横线隔开了，有点类似于我们在<code>ListView</code>中设置的<code>divider</code>属性。</p>
<h3 id="Menu的第三种布局设置"><a href="#Menu的第三种布局设置" class="headerlink" title="Menu的第三种布局设置"></a>Menu的第三种布局设置</h3><p>那么在我们实际的开发过程中，有时候我们需要把第一种和第二种结合起来，也就是说呈现出下图中的效果：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-e5c2c8f0c2f049d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="group menu special.png"></p>
<p>细心的朋友可能已经看出来第三种和第二种的区别。<br>第二种的布局结果是每个<code>group</code>下有一个<code>title</code>，然后在<code>title</code>下面才是我们的子<code>item</code><br>第三种是直接每个<code>group</code>下就是子<code>item</code>并没有第二种中出现的<code>title</code><br>很显然在某些情况下，我们的开发需求需要像第三种这样简约但是不简单的<code>Navigation Menu</code>还是先来看看我们第三种布局的<code>menu</code>文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;menu xmlns:android&#x3D;&quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;group</span><br><span class="line">        android:id&#x3D;&quot;@+id&#x2F;nav_group_normal&quot;</span><br><span class="line">        android:checkableBehavior&#x3D;&quot;single&quot;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_camera&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_camera&quot;</span><br><span class="line">            android:title&#x3D;&quot;Import&quot;&#x2F;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_gallery&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_gallery&quot;</span><br><span class="line">            android:title&#x3D;&quot;Gallery&quot;&#x2F;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_slideshow&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_slideshow&quot;</span><br><span class="line">            android:title&#x3D;&quot;Slideshow&quot;&#x2F;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_manage&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_manage&quot;</span><br><span class="line">            android:title&#x3D;&quot;Tools&quot;&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;group&gt;</span><br><span class="line">    &lt;group</span><br><span class="line">        android:id&#x3D;&quot;@+id&#x2F;nav_commnunicate&quot;</span><br><span class="line">        android:title&#x3D;&quot;Communicate&quot;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_share&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_share&quot;</span><br><span class="line">            android:title&#x3D;&quot;Share&quot;&#x2F;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:id&#x3D;&quot;@+id&#x2F;nav_send&quot;</span><br><span class="line">            android:icon&#x3D;&quot;@drawable&#x2F;ic_menu_send&quot;</span><br><span class="line">            android:title&#x3D;&quot;Send&quot;&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;group&gt;</span><br><span class="line">    &lt;group</span><br><span class="line">        android:id&#x3D;&quot;@+id&#x2F;nav_about_group&quot;&gt;</span><br><span class="line">        &lt;item</span><br><span class="line">            android:title&#x3D;&quot;about&quot;&gt;</span><br><span class="line">            &lt;item</span><br><span class="line">                android:id&#x3D;&quot;@+id&#x2F;nav_about&quot;</span><br><span class="line">                android:icon&#x3D;&quot;@drawable&#x2F;ic_history&quot;</span><br><span class="line">                android:title&#x3D;&quot;about&quot;&#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;item&gt;</span><br><span class="line">    &lt;&#x2F;group&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;menu&gt;</span><br></pre></td></tr></table></figure>
<p>这个布局文件就是用<code>group</code>包裹起每个组的<code>item</code>，有点类似第二种布局，但是<strong>最关键</strong>的地方就是要为每一个<code>group</code>设置一个<code>id</code>，设置完成之后就可以得到第三种布局的效果。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/Virtualbox%E4%B8%8EMactype%E5%85%B1%E5%AD%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/Virtualbox%E4%B8%8EMactype%E5%85%B1%E5%AD%98/" class="post-title-link" itemprop="url">Virtualbox与Mactype共存</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T08:11:53+00:00">2020-01-13</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近心血来潮，准备重启吃灰好久的ubuntu虚拟机玩玩，于是开开心心准备打开机器，顺利进入，准备更新下软件，发现网速好慢，虽然主机能够高速访问“外网”，但是虚拟机并没有享受到这种福利，那么能不能让虚拟机也享受呢？这么一说，就是一段折腾史……<br>##　虚拟机“外网”访问<br>虚拟机访问“外网”，可以通过设置虚拟机的网络为桥接模式，然后在虚拟机中设置主机的ip和端口即可。具体设置我们后面再说，先来打开桥接模式。<br>首先我们打开virtualbox的设置-&gt;网络-&gt;网卡1-&gt;连接方式-&gt;桥接网卡。到这一步的时候，被无情的提示“未指定”。原因是下图中红色箭头标记的那个东西没有<br><img src="http://upload-images.jianshu.io/upload_images/2524102-7d2b077d6ffba4d3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="未指定.png"><br>根据网上的<a href="http://www.dabu.info/the-virtual-box-bridging-error-not-specified-network-interface-to-be-bridged.html" target="_blank" rel="noopener">提示</a>安装桥接网卡驱动，但是安装完毕之后，依然没有显示出来。经过多方查证，发现是虚拟机版本太低，于是选择将4.3.12升级到5.1.18（最新版），升级完毕之后选择桥接网卡，一切顺利。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-c9fc08a01d6f881c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="桥接网卡.png"></p>
<p>准备开机起飞……还没飞起来就被无情打脸，虚拟机不能启动，报错信息如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-4cb56fa29e06e494.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="虚拟机报错.png"><br>这个报错信息就是我们今天的关键信息，这个报错信息一般都是出现在<code>virtualbox 5.0+</code>和<code>windows 8+</code>上面，那么具体是什么原因呢，是因为virtualbox5.0之后对于系统的要求更严格了，说白了就是系统中如果安装了一些杀毒软件、主题修改的东西，那么虚拟机基本上就是会报这个错误。但是由于我的电脑一直是裸奔状态，于是我就将目标转向了mactype，这是我装的唯一一个主题修改类软件，于是经过多方查证找到了<a href="https://www.zhihu.com/question/27159349" target="_blank" rel="noopener">解决办法</a><br>按照上面的步骤操作之后，然后准备再次起飞……依然没飞起来被打脸，打脸的还是那个报错信息。于是再次排查，找了半天，发现virtualbox5.0之后安装完虚拟机还要安装一个驱动，具体操作<a href="https://jingyan.baidu.com/article/4d58d541186ad89dd4e9c018.html" target="_blank" rel="noopener">在这里</a><br>这次安装完毕之后，再次信心满满的准备起飞……最后还是被打脸，我在想这飞机是不是有问题，准备换回4.3.12了，但是内心有个声音告诉我，一定要征服这个虚拟机，我就不信了。然后又到处找资料，找来找去还是找回到之前的杀毒软件和主题修改软件方向上，于是我仔细检查了一下我的电脑，搞了一下午，结果发现电脑右下角有一个净网大师，于是怒卸载之。<br>卸载完毕，再次小心翼翼的准备起飞，这一次飞机平稳的起飞，心中的大石头也落地了，这一下午算是值了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-81efa0e0b9c7c6b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="飞机平稳起飞咯"><br>最后说一下关于ubuntu虚拟机桥接主机高速访问“外网”的方法：<br>在宿主机windows上运行shadowsocks.exe并勾选“允许局域网连接”<br>使用桥接方式运行虚拟机（这时虚拟机与宿主处于同一个局域网）<br>进入ubuntu系统，System Settings – Network – Network proxy勾选Manual（手动）,地址全部填宿主机IP（局域网网段），设置好代理端口（可在windows下的shadowsocks查看，一般为默认1080）<br>ubuntu用浏览器访问<a href="http://www.google.com，成功。" target="_blank" rel="noopener">www.google.com，成功。</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/-Android%E5%BC%80%E5%8F%91%E4%BD%BF%E7%94%A8lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/-Android%E5%BC%80%E5%8F%91%E4%BD%BF%E7%94%A8lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="post-title-link" itemprop="url">-Android开发使用lambda表达式</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T08:11:53+00:00">2020-01-13</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在Java9即将发布之际，我们来讲讲如何使用Java8的新特性–&gt;lambda表达式。lambda表达式可以让我们的代码非常简洁，提高代码的可读性，那么如何在Android开发中来使用lambda表达式呢。</p>
<ol>
<li><p>在项目根目录的build.gradle中添加classpath</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">buildscript</span> &#123;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">        mavenCentral() <span class="comment">//添加</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">dependencies</span> &#123;</span><br><span class="line">       	……</span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'me.tatarka:gradle-retrolambda:3.2.5'</span>  <span class="comment">//添加</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在项目module的build.gradle中添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: &#39;me.tatarka.retrolambda&#39;&#x2F;&#x2F;引用lambda插件</span><br></pre></td></tr></table></figure>
</li>
<li><p>在项目module的build.gradle中添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">         ...</span><br><span class="line">         &#x2F;&#x2F;设置java版本</span><br><span class="line">        compileOptions &#123;</span><br><span class="line">            sourceCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">            targetCompatibility JavaVersion.VERSION_1_8</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>以上的内容添加完毕之后，即可在Android中使用lambda表达式，这时候我们可以回到Android Studio中看看我们使用匿名内部类的一些情况，比如注册View的点击事件、RxJava的一些事件，可以发现IDE会提示我们可以使用lambda来代替。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/AlertDialog%E4%B8%AD%E4%BD%BF%E7%94%A8WebView%E6%98%BE%E7%A4%BA%E5%86%85%E5%AE%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/AlertDialog%E4%B8%AD%E4%BD%BF%E7%94%A8WebView%E6%98%BE%E7%A4%BA%E5%86%85%E5%AE%B9/" class="post-title-link" itemprop="url">AlertDialog中使用WebView显示内容</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T08:11:53+00:00">2020-01-13</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在最近的开发中，需要用到在AlertDialog中通过WebView显示内容，但是在实际操作过程中，发现有一个小小的问题需要注意一下，在此也记录一下。<br>首先放出代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AlertDialog.Builder builder &#x3D; new Builder(this)</span><br><span class="line">           .setView(R.layout.new_dialog_user_guide);</span><br><span class="line">       View view &#x3D; getLayoutInflater().inflate(R.layout.new_dialog_user_guide, null);</span><br><span class="line">       WebView webView &#x3D; (WebView) view.findViewById(R.id.web_user_guide);</span><br><span class="line">       webView.loadUrl(&quot;http:&#x2F;&#x2F;www.baidu.com&quot;);</span><br><span class="line">       builder.show();</span><br></pre></td></tr></table></figure>
<p>上面这段代码，看似是没问题的，但是在实际显示过程中，WebView一直都是空白页面，啥也没有。开始排查问题：</p>
<h4 id="网络问题"><a href="#网络问题" class="headerlink" title="网络问题"></a>网络问题</h4><p>一开始以为是网络问题，于是将<code>http://www.baidu.com</code>换成本地的assets中的文件，更换后关键代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webView.loadUrl(&quot;file:&#x2F;&#x2F;&#x2F;android_asset&#x2F;test.html&quot;);</span><br></pre></td></tr></table></figure>
<p>更换为本地文件之后，WebView中显示的依然是空白页面，啥也没有。继续排查</p>
<h4 id="文件问题"><a href="#文件问题" class="headerlink" title="文件问题"></a>文件问题</h4><p>是否是这个HTML的文件有问题，如果直接加载HTML字符串，问题能否结局，继续修改关键代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">webView.loadData(&quot;&lt;html&gt;这是一段HTML的代码&lt;&#x2F;html&gt;&quot;,&quot;text&#x2F;html&quot;, &quot;utf-8&quot;);</span><br><span class="line">&#x2F;&#x2F;或者也可以这样</span><br><span class="line">webView.loadDataWithBaseURL(null, &quot;&lt;html&gt;这是一段html代码&lt;&#x2F;html&gt;&quot;, &quot;text&#x2F;html&quot;, &quot;utf-8&quot;, null);</span><br></pre></td></tr></table></figure>
<p>更改成直接加载HTML字符串之后，WebView还是现实空白页面，啥也没有。最后想来想去，是不是因为我们将WebView放在了AlertDialog中，所以导致我们的WebView显示有问题。于是我们将WebView单独移出来，结果发现可以显示出正确的内容。那也就是说这个问题出在AlertDialog身上了，难道WebView不能放在AlertDialog中吗。显然不是的，于是参考了官方教程之后，终于发现了问题所在。</p>
<h4 id="震惊！导致WebView显示空白的罪魁祸首竟然是……"><a href="#震惊！导致WebView显示空白的罪魁祸首竟然是……" class="headerlink" title="震惊！导致WebView显示空白的罪魁祸首竟然是……"></a>震惊！导致WebView显示空白的罪魁祸首竟然是……</h4><p>先直接贴出可以运行的正确代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">AlertDialog.Builder builder &#x3D; new Builder(this);</span><br><span class="line">        View view &#x3D; getLayoutInflater().inflate(R.layout.new_dialog_user_guide, null);</span><br><span class="line">        WebView webView &#x3D; (WebView) view.findViewById(R.id.web_user_guide);</span><br><span class="line">        webView.setWebViewClient(new WebViewClient());</span><br><span class="line">        webView.loadUrl(&quot;http:&#x2F;&#x2F;www.baidu.com&quot;);</span><br><span class="line">        builder.setView(view);</span><br><span class="line">        builder.setPositiveButton(R.string.confirm, null);</span><br><span class="line">        builder.show();</span><br></pre></td></tr></table></figure>
<p>问题就出在这个<code>setView</code>身上，我们的”错误代码”是先setView，然后再使用webview进行load，但是正确的顺序应该是先使用webview进行load，然后再setView。<br>问题到此排查结束。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/Android-5-0%E9%80%8F%E6%98%8E%E7%8A%B6%E6%80%81%E6%A0%8F%E8%AE%BE%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/Android-5-0%E9%80%8F%E6%98%8E%E7%8A%B6%E6%80%81%E6%A0%8F%E8%AE%BE%E7%BD%AE/" class="post-title-link" itemprop="url">Android-5-0透明状态栏设置</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T08:11:53+00:00">2020-01-13</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>##声明<br>这篇文章是针对Android 5.0及以上版本的系统进行透明的状态栏设置，Android 5.0以下的系统暂不在本篇文章的讨论范围之内。</p>
<p>##Android 5.0透明状态栏——普通界面<br>先贴出MainActivity布局代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"@color/colorPrimary"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">"stephen.com.material_design.NoteActivity"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span></span></span><br><span class="line"><span class="tag">        <span class="attr">layout</span>=<span class="string">"@layout/app_bar_note"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面的代码中，最主要的两行分别是：</p>
<ul>
<li>设置最外层布局背景色为Toolbar的颜色：<code>android:background=&quot;@color/colorPrimary&quot;</code></li>
<li>设置Toolbar不扩展到状态栏：<code>android:fitsSystemWindows=&quot;true&quot;</code><br>在布局文件中设置完毕后，还需要在<code>onCreate()</code>里面加上如下的代码：</li>
<li>设置状态栏颜色为透明：<code>getWindow().setStatusBarColor(Color.TRANSPARENT);</code></li>
<li>设置状态栏和APP的位置关系：<code>getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN | View.SYSTEM_UI_FLAG_LAYOUT_STABLE);</code><blockquote>
<p>setSystemUiVisibility(int visibility)传入的实参类型如下：</p>
<ol>
<li>View.SYSTEM_UI_FLAG_VISIBLE：显示状态栏，Activity不全屏显示(恢复到有状态的正常情况)。</li>
<li>View.INVISIBLE：隐藏状态栏，同时Activity会伸展全屏显示。</li>
<li>View.SYSTEM_UI_FLAG_FULLSCREEN：Activity全屏显示，且状态栏被隐藏覆盖掉。</li>
<li>View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN：Activity全屏显示，但状态栏不会被隐藏覆盖，状态栏依然可见，Activity顶端布局部分会被状态遮住。</li>
</ol>
</blockquote>
</li>
</ul>
<p>主要需要用到的参数就是以上的几个，其他的参数在实际的开发中用的相对较少，这里也就不列举出来了。<br>通过上面的两个地方的代码设置之后，我们的APP就可以实现透明状态栏的效果了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-c81ed81629099945.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="普通界面的透明状态栏.png"></p>
<p>以上就是普通的界面设置透明状态栏的方法。</p>
<p>##Android 5.0透明状态栏——带DrawerLayout界面<br>带有DrawerLayout的界面设置透明状态栏，最终效果是和网易云音乐一样的，方法其实和上面的差不多，但是有个小的地方需要注意，在这里我还是把代码和方法都完整的讲一遍。<br>带有DrawerLayout的布局文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/drawer_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"@color/colorPrimary"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:openDrawer</span>=<span class="string">"start"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span></span></span><br><span class="line"><span class="tag">            <span class="attr">layout</span>=<span class="string">"@layout/app_bar_main"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.NavigationView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/nav_view"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">"start"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:headerLayout</span>=<span class="string">"@layout/nav_header_main"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:menu</span>=<span class="string">"@menu/activity_main_drawer"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在这里说一下要注意的几个点：</p>
<ol>
<li>这个<code>&lt;LinearLayout&gt; ... &lt;/LinearLayout&gt;</code>的作用，我之前没有用这个<code>&lt;LinearLayout&gt;</code>包裹<code>Toolbar</code>，结果怎么设置，都不能实现非常完美的透明状态栏，要么是statusbar颜色问题，要么是statusbar和NavigationView颜色不统一的问题。后来查找了很多资料，在一个小角落里面发现了，需要外层用<code>&lt;LinearLayout&gt;</code>包裹一下，这样的话就可以非常完美的显示出网易云音乐的效果了。</li>
<li><code>NavigationView</code>里面设置的<code>android:fitsSystemWindows=&quot;true&quot;</code>，这个也是为了让侧边栏即抽屉能够和状态栏颜色统一。</li>
<li><code>&lt;include  ... /&gt;</code>里面就是正常的设置<code>Toolbar</code>什么的了，但是要注意在<code>Toolbar</code>布局的最外层中也记得要添加<code>android:fitsSystemWindows=&quot;true&quot;</code></li>
</ol>
<p>在布局文件中设置完毕之后，接着就是在代码中设置了，在<code>onCreate()</code>里面加上如下的代码：</p>
<ul>
<li>设置状态栏颜色为透明：<code>getWindow().setStatusBarColor(Color.TRANSPARENT);</code></li>
<li>设置状态栏和APP的位置关系：<code>getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN | View.SYSTEM_UI_FLAG_LAYOUT_STABLE);</code></li>
</ul>
<p>将以上的所有代码都设置完毕之后，最终呈现的效果如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-d795e4d2e40a3f9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="没有打开抽屉.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-911543b2ad913c29.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="打开抽屉"></p>
<p>至此，我们已经在Android 5.0上实现透明状态栏。但是对于这样的透明状态栏，我个人是不推荐的。因为我们进行的Android开发，而这个透明状态栏却给人一种IOS的风格，Android开发就应该从方方面面都能够体现出Android的特性。虽然在Android 5.0之前，Android的UI风格一直都惨不忍睹，但是我们一路都坚持下来了，而在Android 5.0之后，因为Material Design的推出，Android的颜值可以说是提升了非常多。所以我们开发人员更应该开发Pure Android的程序，而不是模仿和抄袭IOS的各种风格。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/Android%E4%B8%AD%E8%BE%93%E5%87%BAHTML%E6%A0%BC%E5%BC%8F%E4%B8%8B%E7%9A%84%E6%96%87%E5%AD%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/Android%E4%B8%AD%E8%BE%93%E5%87%BAHTML%E6%A0%BC%E5%BC%8F%E4%B8%8B%E7%9A%84%E6%96%87%E5%AD%97/" class="post-title-link" itemprop="url">Android中输出HTML格式下的文字</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T08:11:53+00:00">2020-01-13</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Android中输出HTML格式下的文字"><a href="#Android中输出HTML格式下的文字" class="headerlink" title="Android中输出HTML格式下的文字"></a>Android中输出HTML格式下的文字</h1><p>在Android中，我们经常会用到TextView这个控件，在使用的过程中，我们用到最多的方法就是setText()，单纯的使用基本上能够满足我们日常的需求，但是有时候我们需要对文字进行一些处理，比如说加粗、斜体、下划线等等，这些也都是可以通过Android提供的原生方法完成。但是如果我们需要实现下面的效果呢：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-92f803de79292a20.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图1"></p>
<h2 id="HTML下的文字解析-快速版"><a href="#HTML下的文字解析-快速版" class="headerlink" title="HTML下的文字解析(快速版)"></a>HTML下的文字解析(快速版)</h2><p>从图片上我们可以看到，这段文字分别有<code>两种大小，三种颜色</code>。我们当然可以定义多个TextView来实现这样的效果，但是如果我们的文字变化较多，那么定义多个TextView也非常的麻烦。那么接下来我们就来介绍一个比较简单的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="string">"恭喜您！您的手机跑分为&lt;font color='#F50057'&gt;&lt;big&gt;&lt;big&gt;&lt;big&gt;888888分&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;&lt;/font&gt;，已经超过全国&lt;font color='#00E676'&gt;&lt;big&gt;&lt;big&gt;&lt;big&gt;99%&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;&lt;/font&gt;的Android手机。"</span>;</span><br><span class="line">tv.setText(Html.fromHtml(str));</span><br></pre></td></tr></table></figure>
<p>上面的代码中，我们用到了一个方法<code>Html.fromHtml()</code>，这个方法是Android中专门用来解析HTML格式的一个方法，我们可以将任意的HTML格式下的代码通过此方法解析，最后得到我们需要的结果。<br>通过上面的方法，我们就可以实现在<code>setText()</code>中使用各种带HTML效果的文字了。这样应该能够实现我们开发中98%的需求了，那么还有1-2%的需求是什么呢？</p>
<h2 id="HTML下的文字解析-多语言支持"><a href="#HTML下的文字解析-多语言支持" class="headerlink" title="HTML下的文字解析(多语言支持)"></a>HTML下的文字解析(多语言支持)</h2><p>比如说我们现在的APP需要兼容多种语言，包括中文、法语、英语、日语等等。在平时的开发过程中，我们都知道多语言的实现可以通过不同<code>values</code>文件夹下的<code>string.xml</code>文件来实现。我们这里就以中文来举例，看看我们如何在<code>string.xml</code>文件中定义HTML格式的文字。<br>首先我们来尝试将我们上面定义的<code>str</code>中的字符串直接放到<code>string.xml</code>中。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">"test_string"</span>&gt;</span></span><br><span class="line">      恭喜您！您的手机跑分为<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">'#F50057'</span>&gt;</span><span class="tag">&lt;<span class="name">big</span>&gt;</span><span class="tag">&lt;<span class="name">big</span>&gt;</span><span class="tag">&lt;<span class="name">big</span>&gt;</span>888888分<span class="tag">&lt;/<span class="name">big</span>&gt;</span><span class="tag">&lt;/<span class="name">big</span>&gt;</span><span class="tag">&lt;/<span class="name">big</span>&gt;</span><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">      ，已经超过全国<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">'#00E676'</span>&gt;</span><span class="tag">&lt;<span class="name">big</span>&gt;</span><span class="tag">&lt;<span class="name">big</span>&gt;</span><span class="tag">&lt;<span class="name">big</span>&gt;</span>99%<span class="tag">&lt;/<span class="name">big</span>&gt;</span><span class="tag">&lt;/<span class="name">big</span>&gt;</span><span class="tag">&lt;/<span class="name">big</span>&gt;</span><span class="tag">&lt;/<span class="name">font</span>&gt;</span>的Android手机。</span><br><span class="line">   <span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tv.setText(Html.fromHtml(getString(R.string.test_string)));</span><br></pre></td></tr></table></figure>


<p>运行程序，结果如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-d8922d1d6ea9bc47.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图2"></p>
<p>并没有出现我们预期的效果，HTML格式并没有被解析出来。这是什么原因呢？原因就在于我们使用的<code>getString()</code>方法，官方对于这个方法的解释如下：</p>
<blockquote>
<p>Return the string value associated with a particular resource ID. It will be stripped of any styled text information.<br>返回与特定资源ID相关联的字符串值，它将删除任何样式的文本信息。</p>
</blockquote>
<p>那么也就是说我们的HTML格式被<code>getString()</code>方法给删除了，所以我们的文字才会变成普通的字符串。要解决这个问题，我们需要将我们的<code>string.xml</code>中的字符串使用<code>&lt;![CDATA[...your html...]]&gt;</code>包裹起来，被<code>CDATA</code>包裹起来的字符都会被解析器忽略，也就是说<code>CDATA</code>中的HTML格式将会被原封不动的保留下来，最终交给我们的<code>Html.fromHtml()</code>进行解析。那么我们来尝试以下，将我们<code>string.xml</code>中的字符串改为如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">"test_string"</span>&gt;</span></span><br><span class="line">        &lt;![CDATA[</span><br><span class="line">            恭喜您！您的手机跑分为&lt;font color='#F50057'&gt;&lt;big&gt;&lt;big&gt;&lt;big&gt;888888分&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;&lt;/font&gt;</span><br><span class="line">            ，已经超过全国&lt;font color='#00E676'&gt;&lt;big&gt;&lt;big&gt;&lt;big&gt;99%&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;&lt;/font&gt;的Android手机。</span><br><span class="line">        ]]&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>编译运行，结果编译时报错：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error:(17, 5) Apostrophe not preceded by \ (in  鎭枩鎮紒鎮ㄧ殑鎵嬫満璺戝垎涓?&lt;font color='#F50057'&gt;&lt;big&gt;&lt;big&gt;&lt;big&gt;888888鍒?&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;&lt;/font&gt;</span><br></pre></td></tr></table></figure>
<p>报错的关键词为：</p>
<blockquote>
<p>Apostrophe not preceded by <br>撇号前面没有\</p>
</blockquote>
<p>通过上面的这个报错信息我们可以知道，这是因为<code>&#39;</code>没有进行转义，那么我根据报错信息将所有的单引号进行转义。最后的结果如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">"test_string"</span>&gt;</span></span><br><span class="line">       &lt;![CDATA[</span><br><span class="line">           恭喜您！您的手机跑分为&lt;font color=\'#F50057\'&gt;&lt;big&gt;&lt;big&gt;&lt;big&gt;888888分&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;&lt;/font&gt;</span><br><span class="line">           ，已经超过全国&lt;font color=\'#00E676\'&gt;&lt;big&gt;&lt;big&gt;&lt;big&gt;99%&lt;/big&gt;&lt;/big&gt;&lt;/big&gt;&lt;/font&gt;的Android手机。</span><br><span class="line">       ]]&gt;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>最后我们再次运行，得到的就是和我们文章开头一样的结果。<br>关于Android中HTML格式下的文字解析大概就是这样了，如果大家还有其他的方法，欢迎交流。</p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>最后附上一个在尝试过程中遇到的错误，本来想情景重现的，结果怎么样都无法再遇到那个错误了。如果有遇到这个错误的朋友，可以尝试下面的解决办法。<br>错误：</p>
<blockquote>
<p>Multiple annotations found at this line:  </p>
</blockquote>
<ul>
<li>error: Multiple substitutions specified in non-positional format; did you mean to add<br>the formatted=”false” attribute?  </li>
<li>error: Unexpected end tag string  </li>
</ul>
<p>导致错误的可能原因及解决方法：</p>
<ol>
<li>string.xml中的字符串中有<code>%</code>，对<code>%</code>进行转义，即改为<code>\%</code>；或者使用两个百分号表示一个，即改为<code>%%</code>。</li>
<li>string.xml中的字符串被格式化了，导致解析器解析出错，解决办法为<code>&lt;string name=&quot;test_string&quot; formatted=&quot;false&quot;&gt;</code>，将formatted设置为false即可。</li>
</ol>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/Android%E5%85%89%E9%80%9F%E6%89%93%E5%8C%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/Android%E5%85%89%E9%80%9F%E6%89%93%E5%8C%85/" class="post-title-link" itemprop="url">Android光速打包</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T08:11:53+00:00">2020-01-13</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="快速打包插件-packer-ng-plugin-使用心得"><a href="#快速打包插件-packer-ng-plugin-使用心得" class="headerlink" title="快速打包插件 packer-ng-plugin 使用心得"></a>快速打包插件 packer-ng-plugin 使用心得</h1><p>首先放出这个工具的Github地址：<a href="https://github.com/mcxiaoke/packer-ng-plugin" target="_blank" rel="noopener">https://github.com/mcxiaoke/packer-ng-plugin</a> 在这个工具里面，作者已经非常详细的介绍了该如何使用这个打包工具，在此我主要记录一下我使用这个打包工具的过程。</p>
<h2 id="导入依赖库文件"><a href="#导入依赖库文件" class="headerlink" title="导入依赖库文件"></a>导入依赖库文件</h2><p>这个工具导入依赖库文件有两个地方</p>
<ul>
<li>在项目的根目录中的<code>build.gradle</code>添加依赖</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    ......</span><br><span class="line">    dependencies&#123;</span><br><span class="line">    &#x2F;&#x2F; add packer-ng</span><br><span class="line">        classpath &#39;com.mcxiaoke.gradle:packer-ng:1.0.7&#39;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>在APP中的<code>build.gradle</code>添加依赖</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: &#39;packer&#39;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    compile &#39;com.mcxiaoke.gradle:packer-helper:1.0.7&#39;</span><br><span class="line">&#125;</span><br><span class="line">android &#123;</span><br><span class="line">    &#x2F;&#x2F;...</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">      release &#123;</span><br><span class="line">        &#x2F;&#x2F; 同时满足下面两个条件才需要此配置</span><br><span class="line">        &#x2F;&#x2F; 1. Gradle版本 &gt;&#x3D; 2.14.1</span><br><span class="line">        &#x2F;&#x2F; 2. Android Gradle Plugin 版本 &gt;&#x3D; 2.2.0</span><br><span class="line">        &#x2F;&#x2F; 作用是只使用旧版签名，禁用V2版签名模式</span><br><span class="line">        &#x2F;&#x2F; 兼容7.0版本的Android系统才需要,否则不需要</span><br><span class="line">        v2SigningEnabled false</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>##这里有个非常重要的信息大家要注意一下，就是<code>packer-helper:1.0.7</code>和<code>packer-ng:1.0.7</code>这两个地方的版本号一定要保持一致##</p>
<ul>
<li>在APP的<code>build.gradle</code>中配置签名信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">signingConfigs &#123;</span><br><span class="line">       release &#123;</span><br><span class="line">           storeFile file(&quot;D:&#x2F;keystore&#x2F;release.keystore&quot;)</span><br><span class="line">           storePassword &quot;release&quot;</span><br><span class="line">           keyAlias &quot;release123&quot;</span><br><span class="line">           keyPassword &quot;release123&quot;</span><br><span class="line">       &#125;</span><br><span class="line">       debug &#123;</span><br><span class="line">          &#x2F;&#x2F;debug 的签名信息</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在APP的<code>build.gradle</code>中添加<code>buildTypes</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">buildTypes &#123;</span><br><span class="line">       release &#123;</span><br><span class="line">          ......</span><br><span class="line">           &#x2F;&#x2F;这里是配置签名的关键信息</span><br><span class="line">           signingConfig signingConfigs.release</span><br><span class="line">       &#125;</span><br><span class="line">       debug &#123;</span><br><span class="line">          ......</span><br><span class="line">          &#x2F;&#x2F;这里是配置签名的关键信息</span><br><span class="line">           signingConfig signingConfigs.debug</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>以上的工作完成之后,我们的配置基本上就完成了,但是这个工具的作者在文档的最后说了</p>
<blockquote>
<ul>
<li>注意事项<br>不支持productFlavors中定义的条件编译变量，不支持修改AndroidManifest<br>如果你的项目有多个productFlavors，默认只会用第一个flavor生成的APK文件作为打包工具的输入参数，忽略其它flavor生成的apk，代码里用的是 theVariant.outputs[0].outputFile。如果你想指定使用某个flavor来生成渠道包，可以用 apkFlavor1Release，apkFlavor2Beta这样的名字，示例（假设flavor名字是Intel）：./gradlew -Pmarket=markets.txt clean apkIntelRelease</li>
</ul>
</blockquote>
<p>注意事项中给我们说明了两件事情:</p>
<ol>
<li>不支持<code>productFlavors</code>中定义的条件编译</li>
<li>不支持修改<code>AndroidManifest</code>文件</li>
</ol>
<p>那么这个时候就会有个问题,如果我们需要多渠道打包怎么办?</p>
<h2 id="多渠道打包"><a href="#多渠道打包" class="headerlink" title="多渠道打包"></a>多渠道打包</h2><p>首先在项目的根目录中添加一个<code>markets.txt</code> 文件,文件中每一行表示一个渠道,这个工具会自动识别空行和不符合规定的行,每一行的<code>渠道</code>和<code>注释</code>之间用<strong>#</strong>隔开,但是也可以没有注释,比如我可以在<code>markets.txt</code> 中进行如下定义:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Google#google channel</span><br><span class="line">Baidu#baidu channel</span><br><span class="line">Test</span><br></pre></td></tr></table></figure>
<p>在进行了如上的定义之后,我们就可以进行多渠道打包,多渠道打包时我个人还是比较喜欢用<code>Gradle</code>来进行打包，在项目的根目录中执行<code>Gradle</code>命令行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gradlew -Pmarket&#x3D;markets.txt clean apkRelease</span><br></pre></td></tr></table></figure>
<p>但是这个时候如果我们有对友盟的配置,就不能使用友盟官方SDK文档中推荐的方法,友盟官方推荐的方法是在AndroidManifest中设置各种配置信息,但是因为这个工具的限制,我们需要在代码中进行配置.</p>
<h2 id="配置友盟的多渠道信息"><a href="#配置友盟的多渠道信息" class="headerlink" title="配置友盟的多渠道信息"></a>配置友盟的多渠道信息</h2><p>首先我们在程序的入口处,一般都是<code>ApplicationMain</code>中的<code>onCreate()</code>中进行如下的配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">private static final String APP_KEY &#x3D; &quot;YOUR_APP_KEY&quot;;</span><br><span class="line">private MobclickAgent.UMAnalyticsConfig mUMAnalyticsConfig;</span><br><span class="line"></span><br><span class="line"> @Override</span><br><span class="line">    public void onCreate() &#123;</span><br><span class="line">        super.onCreate();</span><br><span class="line">        setChannelID();</span><br><span class="line">    &#125;</span><br><span class="line">    private void setChannelID() &#123;</span><br><span class="line">          final String channelID &#x3D; PackerNg.getMarket(this);</span><br><span class="line">          mUMAnalyticsConfig &#x3D; new MobclickAgent.UMAnalyticsConfig(this, APP_KEY, channelID);</span><br><span class="line">          MobclickAgent.startWithConfigure(mUMAnalyticsConfig);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<p>当然最后别忘记在<code>AndroidManifest.xml</code>的<code>application</code>结点中加上<code>android:name=&quot;.Application.ApplicationMain&quot;</code></p>
<p>进行了以上的所有设置之后,我们就可以享受光速打包了,根据我亲测,打50个包的速度是1分钟左右,这一分钟包括检查插件和编译信息等等.其实开始打第0个包到第49个包大概是10多秒钟吧。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://houzixiashanxiedaima.github.io/2020/01/13/Android%E5%BC%80%E5%8F%91%E4%B9%8BView%E5%9D%90%E6%A0%87%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GenJi Wang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="雅俗共赏">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            
            <a href="/2020/01/13/Android%E5%BC%80%E5%8F%91%E4%B9%8BView%E5%9D%90%E6%A0%87%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">Android开发之View坐标问题</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-01-13 08:11:53" itemprop="dateCreated datePublished" datetime="2020-01-13T08:11:53+00:00">2020-01-13</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在我们日常的开发过程中，接触最多的就是View了，各种各样的View，但是我们可能对View的知识了解一些，但是还是感觉有些地方不太够，尤其是View的坐标问题。我们今天就来看看这个View的坐标到底是怎么定义的。</p>
<p>别的不说，先上代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_behavior</span>=<span class="string">"@string/appbar_scrolling_view_behavior"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">"stephen.com.bugstest.MainActivity"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:showIn</span>=<span class="string">"@layout/activity_main"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/tv_test"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_centerInParent</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">"@color/colorPrimary"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:padding</span>=<span class="string">"10dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"测试文本"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">"#FFFFFF"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面这个是一个简单布局文件，这个布局文件对应的<code>坐标信息</code>：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2524102-c83b13d3a71e882f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="TextView的坐标信息"></p>
<blockquote>
<p>图画的很粗糙，意思表达到了就行。<br>win10 下有什么好的画这种图的软件也可以推荐下。</p>
</blockquote>
<p>上面图中，外层红色框表示的RelativeLayout，里面的蓝色实心矩形表示的是TextView。图中的标明的坐标信息解释如下：</p>
<blockquote>
<p>getTop()表示Textview上边缘距离父布局上边的距离</p>
</blockquote>

        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

    
  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="http://static.simpledesktops.com/uploads/desktops/2016/12/05/Untitled-1-03-01.png"
      alt="GenJi Wang">
  <p class="site-author-name" itemprop="name">GenJi Wang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  &copy; 1970 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">GenJi Wang</span>
</div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

<script src="/js/utils.js?v=7.4.1.js"></script>

<script src="/js/motion.js?v=7.4.1.js"></script>


<script src="/js/schemes/pisces.js?v=7.4.1.js"></script>


<script src="/js/next-boot.js?v=7.4.1.js"></script>




  








  
<script src="/js/local-search.js?v=7.4.1.js"></script>















  

  

  

</body>
</html>
