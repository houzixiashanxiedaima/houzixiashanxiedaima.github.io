import{r as U,a as j}from"./index._OACqPSs.js";var P={exports:{}},q={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $;function z(){if($)return q;$=1;var f=U(),v=Symbol.for("react.element"),g=Symbol.for("react.fragment"),R=Object.prototype.hasOwnProperty,m=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,w={key:!0,ref:!0,__self:!0,__source:!0};function o(p,l,s){var a,x={},h=null,u=null;s!==void 0&&(h=""+s),l.key!==void 0&&(h=""+l.key),l.ref!==void 0&&(u=l.ref);for(a in l)R.call(l,a)&&!w.hasOwnProperty(a)&&(x[a]=l[a]);if(p&&p.defaultProps)for(a in l=p.defaultProps,l)x[a]===void 0&&(x[a]=l[a]);return{$$typeof:v,type:p,key:h,ref:u,props:x,_owner:m.current}}return q.Fragment=g,q.jsx=o,q.jsxs=o,q}var F;function J(){return F||(F=1,P.exports=z()),P.exports}var e=J();const W="https://rss-cors-proxy.houzixiashanxiedaima.workers.dev/?url=",B=async f=>{const g=await(await fetch(f)).text(),m=new DOMParser().parseFromString(g,"text/xml");if(m.querySelector("parsererror"))throw new Error("XML è§£æå¤±è´¥");const o=[];return m.querySelector("feed")!==null?m.querySelectorAll("entry").forEach(s=>{const a=s.querySelector("title")?.textContent||"æ— æ ‡é¢˜",x=s.querySelector("link")?.getAttribute("href")||"",h=s.querySelector("published")?.textContent||s.querySelector("updated")?.textContent||"",u=s.querySelector("summary")?.textContent||"",A=s.querySelector("content")?.textContent||s.querySelector("summary")?.textContent||"æ— å†…å®¹";o.push({title:a,link:x,pubDate:h,contentSnippet:u.substring(0,200),content:A})}):m.querySelectorAll("item").forEach(s=>{const a=s.querySelector("title")?.textContent||"æ— æ ‡é¢˜",x=s.querySelector("link")?.textContent||"",h=s.querySelector("pubDate")?.textContent||"",u=s.querySelector("description")?.textContent||"",L=s.querySelector("encoded")?.textContent||s.querySelector("content\\:encoded")?.textContent||""||u||"æ— å†…å®¹",_=s.querySelector("media\\:content, content"),O=s.querySelector("media\\:thumbnail, thumbnail"),N=s.querySelector("enclosure");let y;O?y=O.getAttribute("url")||void 0:_?y=_.getAttribute("url")||void 0:N&&N.getAttribute("type")?.startsWith("image/")&&(y=N.getAttribute("url")||void 0),o.push({title:a,link:x,pubDate:h,contentSnippet:u.substring(0,200),content:L,thumbnail:y})}),o};function X(){const[f,v]=j.useState([]),[g,R]=j.useState(null),[m,w]=j.useState([]),[o,p]=j.useState(null),[l,s]=j.useState(!1),[a,x]=j.useState(""),h=(t,r)=>r==="Articles"||r==="SocialMedia"?"article":r==="Videos"?"video":r==="Audios"?"audio":r==="Pictures"?"image":r==="Notifications"?"notification":t.includes("bilibili/user/video")?"video":t.includes("xiaoyuzhou/podcast")?"audio":t.includes("telegram/channel")&&r==="Pictures"?"image":t.includes("github.com")&&t.includes("releases.atom")?"notification":"article",u=t=>{const n=new DOMParser().parseFromString(t,"text/xml"),i=new Map;n.querySelectorAll("body > outline").forEach(d=>{const C=d.getAttribute("text")||"æœªåˆ†ç±»",M=(k,S)=>{const D=k.getAttribute("xmlUrl");if(D){i.has(S)||i.set(S,[]);const E=i.get(S);E.push({id:`${Date.now()}_${E.length}`,title:k.getAttribute("title")||k.getAttribute("text")||"æœªå‘½å",url:D,category:S,type:h(D,S)})}else{const E=k.getAttribute("text")||"æœªå‘½å";k.querySelectorAll(":scope > outline").forEach(I=>M(I,`${S} / ${E}`))}};d.querySelectorAll(":scope > outline").forEach(k=>M(k,C))});const c=[];return i.forEach((d,C)=>{c.push({name:C,feeds:d,collapsed:!1})}),c};j.useEffect(()=>{(async()=>{try{const n=await(await fetch("/follow.opml")).text(),i=u(n);v(i);const b=i.reduce((c,d)=>c+d.feeds.length,0);console.log(`âœ… è‡ªåŠ¨åŠ è½½ ${b} ä¸ªè®¢é˜…æºï¼Œåˆ†ä¸º ${i.length} ä¸ªåˆ†ç±»`)}catch(r){console.error("âŒ è‡ªåŠ¨åŠ è½½ OPML å¤±è´¥:",r)}})()},[]);const A=t=>{const r=t.target.files?.[0];if(!r)return;const n=new FileReader;n.onload=i=>{const b=i.target?.result,c=u(b);v(c);const d=c.reduce((C,M)=>C+M.feeds.length,0);alert(`æˆåŠŸå¯¼å…¥ ${d} ä¸ªè®¢é˜…æºï¼Œåˆ†ä¸º ${c.length} ä¸ªåˆ†ç±»ï¼`)},n.readAsText(r)},L=t=>{v(r=>r.map(n=>n.name===t?{...n,collapsed:!n.collapsed}:n))},_=async t=>{s(!0),R(t),w([]),p(null);try{const r=W+encodeURIComponent(t.url),n=await B(r);w(n),n.length>0&&p(n[0])}catch(r){console.error("è·å– RSS å¤±è´¥:",r),alert("è·å– RSS å¤±è´¥: "+r.message)}finally{s(!1)}},O=t=>({Articles:"ğŸ“°",Videos:"ğŸ¬",Audios:"ğŸ§",Pictures:"ğŸ–¼ï¸",SocialMedia:"ğŸ’¬",Notifications:"ğŸ””"})[t]||"ğŸ“",N=t=>({article:"ğŸ“„",video:"â–¶ï¸",audio:"ğŸµ",image:"ğŸ–¼ï¸",notification:"ğŸ””"})[t||"article"],y=f.map(t=>({...t,feeds:t.feeds.filter(r=>r.title.toLowerCase().includes(a.toLowerCase()))})).filter(t=>t.feeds.length>0),T=t=>{if(!t)return"æœªçŸ¥æ—¶é—´";const r=new Date(t);if(isNaN(r.getTime()))return"æœªçŸ¥æ—¶é—´";const n=Date.now()-r.getTime(),i=Math.floor(n/1e3),b=Math.floor(i/60),c=Math.floor(b/60),d=Math.floor(c/24);return i<60?"åˆšåˆš":b<60?`${b} åˆ†é’Ÿå‰`:c<24?`${c} å°æ—¶å‰`:d<30?`${d} å¤©å‰`:r.toLocaleDateString("zh-CN")};return e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsxs("aside",{className:"w-72 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 overflow-y-auto flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-bold mb-3 text-gray-900 dark:text-gray-100",children:"RSS é˜…è¯»å™¨"}),f.length>0&&e.jsxs("label",{className:"block px-4 py-2 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-center rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors mb-3",children:["ğŸ”„ é‡æ–°å¯¼å…¥ OPML",e.jsx("input",{type:"file",accept:".opml,.xml",onChange:A,className:"hidden"})]}),f.length>0&&e.jsx("input",{type:"text",placeholder:"ğŸ” æœç´¢è®¢é˜…æº...",value:a,onChange:t=>x(t.target.value),className:"w-full mt-3 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y.length===0?e.jsx("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:f.length===0?"æ­£åœ¨åŠ è½½è®¢é˜…æº...":"æ— åŒ¹é…çš„è®¢é˜…æº"}):y.map(t=>e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("button",{onClick:()=>L(t.name),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 dark:bg-gray-750 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:O(t.name)}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.name}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",t.feeds.length,")"]})]}),e.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform ${t.collapsed?"":"rotate-90"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),!t.collapsed&&e.jsx("div",{className:"bg-white dark:bg-gray-800",children:t.feeds.map(r=>e.jsxs("button",{onClick:()=>_(r),className:`w-full text-left px-6 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2 transition-colors border-l-4 ${g?.id===r.id?"bg-blue-50 dark:bg-blue-900/20 border-blue-500":"border-transparent"}`,children:[e.jsx("span",{className:"text-sm flex-shrink-0",children:N(r.type)}),e.jsx("span",{className:"truncate text-sm text-gray-900 dark:text-gray-100",children:r.title})]},r.id))})]},t.name))})]}),e.jsx("div",{className:"w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 overflow-y-auto flex flex-col",children:g?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-lg",children:N(g.type)}),e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:g.title})]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m.length," ç¯‡æ–‡ç« "]})]}),l?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"åŠ è½½ä¸­..."})]})}):e.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:m.map((t,r)=>e.jsx("button",{onClick:()=>p(t),className:"w-full text-left",children:e.jsxs("div",{className:`flex gap-3 items-center rounded-xl border transition-colors bg-gray-50 border-gray-200 dark:bg-gray-800/80 dark:border-gray-700 hover:border-blue-400 dark:hover:border-blue-400 ${o?.link===t.link?"ring-2 ring-blue-400/50":""}`,children:[e.jsxs("div",{className:"flex-1 min-w-0 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-1",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:g?.title}),e.jsx("span",{className:"h-1 w-1 rounded-full bg-amber-500 inline-block"}),e.jsx("span",{children:T(t.pubDate)})]}),e.jsx("h3",{className:"text-base font-semibold mb-1 line-clamp-2 text-gray-900 dark:text-gray-100",children:t.title}),e.jsx("p",{className:"text-sm leading-relaxed text-gray-600 dark:text-gray-300 line-clamp-2",children:t.contentSnippet})]}),t.thumbnail&&e.jsx("div",{className:"relative w-24 h-24 mr-3 flex-shrink-0 overflow-hidden rounded-xl bg-gray-100 dark:bg-gray-700",children:e.jsx("img",{src:t.thumbnail,alt:"",loading:"lazy",className:"w-full h-full object-cover"})})]})},r))})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 dark:text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-2 block",children:"ğŸ“°"}),e.jsx("p",{children:"é€‰æ‹©ä¸€ä¸ªè®¢é˜…æºå¼€å§‹é˜…è¯»"})]})})}),e.jsx("main",{className:"flex-1 bg-white dark:bg-gray-800 overflow-y-auto",children:o?e.jsxs("article",{className:"w-full h-full px-12 py-8 max-w-none",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-gray-900 dark:text-gray-100",children:o.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mb-6 pb-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("span",{children:o.pubDate?new Date(o.pubDate).toLocaleString("zh-CN"):"æœªçŸ¥æ—¶é—´"}),e.jsx("a",{href:o.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 hover:underline",children:"æŸ¥çœ‹åŸæ–‡ â†’"})]}),e.jsx("div",{className:`prose prose-lg dark:prose-invert max-w-none
                prose-headings:text-gray-900 dark:prose-headings:text-gray-100
                prose-p:text-gray-700 dark:prose-p:text-gray-300
                prose-a:text-blue-500 dark:prose-a:text-blue-400
                prose-strong:text-gray-900 dark:prose-strong:text-gray-100
                prose-code:text-gray-900 dark:prose-code:text-gray-100
                prose-pre:bg-gray-100 dark:prose-pre:bg-gray-900
                prose-img:rounded-lg`,dangerouslySetInnerHTML:{__html:o.content}})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-2 block",children:"ğŸ“–"}),e.jsx("p",{children:"é€‰æ‹©ä¸€ç¯‡æ–‡ç« å¼€å§‹é˜…è¯»"})]})})})]})}export{X as default};
