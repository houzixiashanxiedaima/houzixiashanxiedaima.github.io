<!DOCTYPE html><html lang="zh-CN" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.17.1"><meta name="description" content="git-pkgs 的一个错误报告让我陷入深渊：被git忽略的文件显示为幻影差异，原因是go-git的gitignore实现不匹配git的。"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self'; font-src 'self' data:;"><link rel="canonical" href="https://blog.yuyins.com/reading-list/the-many-flavors-of-ignore-files-3md69e/"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://blog.yuyins.com/reading-list/the-many-flavors-of-ignore-files-3md69e/"><meta property="og:title" content="忽略文件的多种实现"><meta property="og:description" content="git-pkgs 的一个错误报告让我陷入深渊：被git忽略的文件显示为幻影差异，原因是go-git的gitignore实现不匹配git的。"><meta property="og:image" content="https://blog.yuyins.com/favicon.svg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog.yuyins.com/reading-list/the-many-flavors-of-ignore-files-3md69e/"><meta property="twitter:title" content="忽略文件的多种实现"><meta property="twitter:description" content="git-pkgs 的一个错误报告让我陷入深渊：被git忽略的文件显示为幻影差异，原因是go-git的gitignore实现不匹配git的。"><meta property="twitter:image" content="https://blog.yuyins.com/favicon.svg"><title>忽略文件的多种实现</title><!-- Theme and color scheme script (runs before page loads to prevent flash) --><script>
			// 初始化配色方案 - 默认使用 stone-amber
			const colorScheme = localStorage.getItem('colorScheme') || 'stone-amber';
			document.documentElement.setAttribute('data-color', colorScheme);

			// 强制使用浅色主题
			document.documentElement.setAttribute('data-theme', 'light');
		</script><link rel="stylesheet" href="/_astro/_slug_.85a8WIJw.css">
<style>.blog-post-container[data-astro-cid-wrgicudb]{width:100%;margin:0 auto;padding:2rem 0}.blog-post[data-astro-cid-wrgicudb]{width:100%;min-width:0;max-width:42rem;margin:0 auto}.article-header[data-astro-cid-wrgicudb]{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border)}.article-header[data-astro-cid-wrgicudb] h1[data-astro-cid-wrgicudb]{font-size:2rem;line-height:1.3;margin-bottom:1rem;font-weight:700;color:var(--foreground);word-break:break-word}.article-meta[data-astro-cid-wrgicudb]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:var(--muted-foreground)}.source-tag[data-astro-cid-wrgicudb]{background-color:var(--muted);color:var(--foreground);padding:.125rem .5rem;border-radius:9999px;font-weight:500;font-size:.75rem;text-decoration:none;transition:opacity .2s}.source-tag[data-astro-cid-wrgicudb]:hover{opacity:.8}.separator[data-astro-cid-wrgicudb]{color:var(--border)}.article-content[data-astro-cid-wrgicudb]{line-height:1.8;margin-bottom:3rem;font-size:1.0625rem;color:var(--foreground)}.article-content[data-astro-cid-wrgicudb] h2{margin-top:2rem;margin-bottom:1rem;font-size:1.5rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] h3{margin-top:1.5rem;margin-bottom:.75rem;font-size:1.25rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] p{margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] a{color:var(--accent);text-decoration:underline;text-underline-offset:2px}.article-content[data-astro-cid-wrgicudb] img{max-width:100%;height:auto;border-radius:.5rem;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] blockquote{border-left:4px solid var(--border);padding-left:1rem;margin:1.5rem 0;color:var(--muted-foreground);font-style:italic}.article-content[data-astro-cid-wrgicudb] pre{background:var(--muted);padding:1rem;border-radius:.5rem;overflow-x:auto;font-family:monospace;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] ul,.article-content[data-astro-cid-wrgicudb] ol{padding-left:1.5rem;margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] li{margin-bottom:.5rem}.article-footer[data-astro-cid-wrgicudb]{padding-top:2rem;border-top:1px solid var(--border);display:flex;flex-direction:column;gap:1.5rem;align-items:center}.action-row[data-astro-cid-wrgicudb]{display:flex;justify-content:center}.read-original-btn[data-astro-cid-wrgicudb]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background-color:var(--foreground);color:var(--background);border-radius:.5rem;font-weight:500;text-decoration:none;transition:opacity .2s}.read-original-btn[data-astro-cid-wrgicudb]:hover{opacity:.9}.back-to-list[data-astro-cid-wrgicudb]{text-align:center}.back-link[data-astro-cid-wrgicudb]{color:var(--muted-foreground);text-decoration:none;font-size:.875rem;transition:color .2s}.back-link[data-astro-cid-wrgicudb]:hover{color:var(--foreground)}
</style></head> <body data-astro-cid-sckkx6r4> <a id="skip-to-content" href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-accent focus:text-background" data-astro-cid-sckkx6r4>Skip to content</a> <header class="header" data-astro-cid-3ef6ksr2> <nav class="header-nav" aria-label="Main navigation" data-astro-cid-3ef6ksr2> <a href="/" class="header-logo" data-astro-cid-3ef6ksr2>
AstroBlog
</a> <div class="header-links" data-astro-cid-3ef6ksr2> <ul class="nav-list" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href="/" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 文章 </a> </li><li data-astro-cid-3ef6ksr2> <a href="/category" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 分类 </a> </li><li data-astro-cid-3ef6ksr2> <a href="/reading-list" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 订阅 </a> </li><li data-astro-cid-3ef6ksr2> <a href="/about" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 关于 </a> </li> </ul> <div class="header-actions" data-astro-cid-3ef6ksr2> <div id="search" data-astro-cid-otpdt6jm> <button id="search-button" class="search-toggle" aria-label="打开搜索" title="搜索 (⌘K)" data-astro-cid-otpdt6jm> <svg class="search-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></circle> <path d="M20 20L16.5 16.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></path> </svg> </button> <dialog id="search-dialog" class="search-modal" data-astro-cid-otpdt6jm> <div class="modal-content" data-astro-cid-otpdt6jm> <div class="modal-header" data-astro-cid-otpdt6jm> <h2 class="modal-title" data-astro-cid-otpdt6jm>搜索文章</h2> <button id="close-search" class="close-button" aria-label="关闭搜索" data-astro-cid-otpdt6jm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-otpdt6jm></path> </svg> </button> </div> <div id="pagefind-ui" data-astro-cid-otpdt6jm></div> </div> </dialog> </div> <script type="module">let d=!1;const c="pagefind-loaded";async function l(t=0){if(sessionStorage.getItem(c)==="true")return g(),!0;const r=document.getElementById("pagefind-ui");if(!r)return!1;r.innerHTML='<div style="padding: 2rem; text-align: center; color: var(--muted-foreground);">加载中...</div>';try{return await new Promise((o,s)=>{const a=document.createElement("script");a.src="/pagefind/pagefind-ui.js",a.onload=o,a.onerror=s,document.head.appendChild(a)}),g(),sessionStorage.setItem(c,"true"),!0}catch(i){return console.error("Failed to load search:",i),t<2?(console.log(`Retrying search load... (${t+1}/2)`),await new Promise(o=>setTimeout(o,1e3)),l(t+1)):(r&&(r.innerHTML=`
          <div style="padding: 2rem; text-align: center;">
            <p style="color: var(--muted-foreground); margin-bottom: 1rem;">搜索功能加载失败</p>
            <button id="retry-search" style="padding: 0.5rem 1rem; background: var(--accent); color: var(--accent-foreground); border: none; border-radius: 0.375rem; cursor: pointer;">
              重试
            </button>
          </div>
        `,document.getElementById("retry-search")?.addEventListener("click",()=>{sessionStorage.removeItem(c),l(0)})),!1)}}function g(){typeof PagefindUI<"u"&&(new PagefindUI({element:"#pagefind-ui",showSubResults:!0,showImages:!1,excerptLength:15,translations:{placeholder:"搜索文章...",clear_search:"清除",load_more:"加载更多",search_label:"搜索此站点",filters_label:"筛选",zero_results:"未找到结果 [SEARCH_TERM]",many_results:"找到 [COUNT] 个结果 [SEARCH_TERM]",one_result:"找到 [COUNT] 个结果 [SEARCH_TERM]",alt_search:"未找到 [SEARCH_TERM] 的结果。显示 [DIFFERENT_TERM] 的结果",search_suggestion:"未找到 [SEARCH_TERM] 的结果。尝试以下搜索：",searching:"搜索中 [SEARCH_TERM]..."}}),setTimeout(()=>{const t=document.querySelector(".pagefind-ui__search-input");t instanceof HTMLElement&&t.focus()},100))}function u(){if(d)return;d=!0;const t=document.getElementById("search-button"),n=document.getElementById("search-dialog"),r=document.getElementById("close-search");if(!t||!n||!r)return;let i=sessionStorage.getItem(c)==="true";const o=async()=>{n.showModal(),document.body.style.overflow="hidden",i?setTimeout(()=>{const e=document.querySelector(".pagefind-ui__search-input");e instanceof HTMLElement&&e.focus()},100):await l()&&(i=!0)},s=()=>{n.close(),document.body.style.overflow=""},a=e=>{e.target===n&&s()},m=e=>{e.key==="Escape"&&n.open&&s()},f=e=>{(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),n.open?s():o())};t.addEventListener("click",o),r.addEventListener("click",s),n.addEventListener("click",a),document.addEventListener("keydown",m),document.addEventListener("keydown",f),document.addEventListener("astro:before-swap",()=>{t.removeEventListener("click",o),r.removeEventListener("click",s),n.removeEventListener("click",a),document.removeEventListener("keydown",m),document.removeEventListener("keydown",f),d=!1},{once:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();document.addEventListener("astro:page-load",u);</script> <link href="/pagefind/pagefind-ui.css" rel="stylesheet">  </div> </div> </nav> </header>  <main id="main-content" data-pagefind-body class="main-content main-content--wide" data-astro-cid-sckkx6r4>  <div class="blog-post-container" data-astro-cid-wrgicudb> <article class="blog-post" data-astro-cid-wrgicudb> <header class="article-header" data-astro-cid-wrgicudb> <h1 data-astro-cid-wrgicudb>忽略文件的多种实现</h1> <div class="article-meta" data-astro-cid-wrgicudb> <a href="https://nesbitt.io" target="_blank" rel="noopener noreferrer" class="source-tag" data-astro-cid-wrgicudb>nesbitt.io</a> <span class="separator" data-astro-cid-wrgicudb>·</span> <time data-astro-cid-wrgicudb>2026年2月12日</time> </div> </header> <!-- 使用清洗后的安全 HTML 内容 --> <div class="article-content app-prose" data-astro-cid-wrgicudb><p>A <a href="https://github.com/git-pkgs/git-pkgs/issues/53#issuecomment-3857707729" target="_blank" rel="noopener noreferrer">bug report</a> in git-pkgs led me down a rabbit hole: files that git ignored were showing up as phantom diffs, and the cause turned out to be <a href="https://github.com/go-git/go-git/issues/108" target="_blank" rel="noopener noreferrer">go-git’s gitignore implementation</a>, which doesn’t match git’s actual behavior for unanchored patterns in nested directories. I went looking for a Go library that fully matched git’s pattern semantics and couldn’t find one, so I wrote <a href="https://github.com/git-pkgs/gitignore" target="_blank" rel="noopener noreferrer">git-pkgs/gitignore</a> with a wildmatch engine modeled on git’s own <code>wildmatch.c</code>.</p>

<p>Building that made me appreciate how much complexity hides behind <code>.gitignore</code>, and got me thinking about all the other tools with their own ignore files. Most claim to use “gitignore syntax” without specifying which parts, and that phrase turns out to be doing a lot of work. Every tool wants to be git until it has to implement git’s edge cases.</p>

<h3>gitignore</h3>

<p>Most people know that <code>*.log</code> ignores log files and <code>node_modules/</code> ignores the node_modules directory. But gitignore does far more than simple glob matching. I covered the basics in <a href="/2026/02/05/git-magic-files.html" target="_blank" rel="noopener noreferrer">Git’s Magic Files</a>, but getting a correct implementation working forced me to deal with all of it. The <a href="https://git-scm.com/docs/gitignore" target="_blank" rel="noopener noreferrer">gitignore docs</a> describe the behavior in prose; the real authority is the implementation in <a href="https://github.com/git/git/blob/master/dir.c" target="_blank" rel="noopener noreferrer">dir.c</a> and <a href="https://github.com/git/git/blob/master/wildmatch.c" target="_blank" rel="noopener noreferrer">wildmatch.c</a>, with tests in <a href="https://github.com/git/git/blob/master/t/t0008-ignores.sh" target="_blank" rel="noopener noreferrer">t0008-ignores.sh</a> and <a href="https://github.com/git/git/blob/master/t/t3070-wildmatch.sh" target="_blank" rel="noopener noreferrer">t3070-wildmatch.sh</a>.</p>

<p><strong>Four layers of patterns.</strong> Git doesn’t just read one <code>.gitignore</code> file. It checks patterns from four sources in order of increasing priority: the global excludes file (<code>core.excludesFile</code>, defaulting to <code>~/.config/git/ignore</code>), then <code>.git/info/exclude</code> for repo-local patterns that aren’t committed, then the root <code>.gitignore</code>, then <code>.gitignore</code> files in each subdirectory. A pattern in <code>src/.gitignore</code> only applies to files under <code>src/</code>. Patterns in deeper directories override patterns in parent directories, and the last matching pattern wins. If you’re debugging why a file isn’t being ignored (or why it is), <code>git check-ignore -v &lt;path&gt;</code> will tell you exactly which pattern in which file is responsible.</p>

<p><strong>Anchored vs. unanchored patterns.</strong> A pattern with no slash in it, like <code>*.log</code>, is unanchored and matches at any depth because git effectively prepends <code>**/</code> to it. But the moment a pattern contains a slash, including a leading <code>/</code>, it becomes anchored to its <code>.gitignore</code>’s directory. This distinction is where go-git’s implementation broke down for us.</p>

<table>
  <thead>
    <tr>
      <th>Pattern</th>
      <th>Matches</th>
      <th>Doesn’t match</th>
      <th>Why</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>debug.log</code></td>
      <td><code>debug.log</code>, <code>logs/debug.log</code></td>
      <td> </td>
      <td>Unanchored, matches at any depth</td>
    </tr>
    <tr>
      <td><code>/debug.log</code></td>
      <td><code>debug.log</code> at root only</td>
      <td><code>logs/debug.log</code></td>
      <td>Leading <code>/</code> anchors to root</td>
    </tr>
    <tr>
      <td><code>doc/frotz</code></td>
      <td><code>doc/frotz</code></td>
      <td><code>a/doc/frotz</code></td>
      <td>Contains <code>/</code>, so anchored</td>
    </tr>
    <tr>
      <td><code>build/</code></td>
      <td><code>build/</code> (dir), <code>src/build/</code> (dir)</td>
      <td><code>build</code> (file)</td>
      <td>Trailing <code>/</code> restricts to directories</td>
    </tr>
  </tbody>
</table>

<p><strong>Wildcards.</strong> <code>*</code> matches any string within a single path segment but does not cross <code>/</code> boundaries. <code>?</code> matches exactly one character, also not <code>/</code>. These follow the rules of git’s <code>wildmatch.c</code>, which is subtly different from shell globbing or Go’s <code>filepath.Match</code>.</p>

<p><strong>Doublestar <code>**</code>.</strong> Only special when it appears as a complete path segment between slashes: <code>**/logs</code> matches <code>logs</code> at any depth, <code>logs/**</code> matches everything under <code>logs/</code>, and <code>foo/**/bar</code> matches <code>foo/bar</code>, <code>foo/a/bar</code>, <code>foo/a/b/c/bar</code> with zero or more intermediate directories. But <code>foo**bar</code> is not special because the stars aren’t a standalone segment; they’re just two regular <code>*</code> wildcards that won’t cross a <code>/</code>.</p>

<p><strong>Bracket expressions.</strong> <code>[abc]</code> matches one character from the set, ranges like <code>[a-z]</code> and <code>[0-9]</code> work as expected, and both <code>[!a-z]</code> and <code>[^a-z]</code> negate the match. All 12 POSIX character classes are supported: <code>[:alnum:]</code>, <code>[:alpha:]</code>, <code>[:blank:]</code>, <code>[:cntrl:]</code>, <code>[:digit:]</code>, <code>[:graph:]</code>, <code>[:lower:]</code>, <code>[:print:]</code>, <code>[:punct:]</code>, <code>[:space:]</code>, <code>[:upper:]</code>, <code>[:xdigit:]</code>. You can mix classes with ranges in a single expression: <code>[a-c[:digit:]x-z]</code>. The edge cases are where it gets interesting: <code>]</code> as the first character after <code>[</code> is a literal member of the class, not the closing bracket. Ranges are byte-value ordered, so <code>[B-a]</code> matches bytes 66 through 97, which includes uppercase B through Z, several symbols, and lowercase a.</p>

<p><strong>Directory-only patterns.</strong> A trailing <code>/</code> means the pattern only matches directories, so <code>build/</code> matches the directory <code>build</code> but not a file named <code>build</code>, and it also matches everything inside that directory because once a directory is ignored git skips it entirely and never looks at its contents.</p>

<p><strong>Negation.</strong> A leading <code>!</code> re-includes something a previous pattern excluded. The subtlety is that you can’t re-include a file if its parent directory was already excluded, because git never descends into the excluded directory to check. To ignore everything except one nested path, you need to re-include each intermediate directory:</p>

<div><div><pre><code>/*
!/foo
/foo/*
!/foo/bar
</code></pre></div></div>

<p>This ignores everything except <code>foo/bar</code>. You have to re-include <code>foo/</code>, then re-exclude <code>foo/*</code>, then re-include <code>foo/bar</code>. Skipping the middle step means <code>foo/bar</code> stays excluded.</p>

<p><strong>Escaping.</strong> A backslash makes the next character literal, so <code>\!important</code> matches a file literally named <code>!important</code> rather than being a negation pattern, and <code>\#comment</code> matches a file named <code>#comment</code> rather than being treated as a comment line.</p>

<p><strong>Trailing spaces.</strong> Unescaped trailing spaces on a pattern line are stripped, but trailing tabs are not. A backslash before a trailing space preserves it. Leading spaces are always significant: `  hello<code> is a valid pattern matching a file named </code>  hello`.</p>

<p><strong>Tracked files are immune.</strong> If a file is already tracked by git, adding it to <code>.gitignore</code> does nothing. You need <code>git rm --cached</code> first. This is probably the single most common source of confusion with gitignore. There’s also <code>git update-index --assume-unchanged</code> which tells git to <a href="https://luisdalmolin.dev/blog/ignoring-files-in-git-without-gitignore/" target="_blank" rel="noopener noreferrer">pretend a tracked file hasn’t changed</a>, useful for local config tweaks you don’t want showing up in <code>git status</code>.</p>

<h3>Everything else</h3>

<p><a href="https://git-scm.com/docs/gitignore" target="_blank" rel="noopener noreferrer"><code>.gitignore</code></a> gets treated as the original, though CVS had <a href="https://www.gnu.org/software/trans-coord/manual/cvs/html_node/cvsignore.html" target="_blank" rel="noopener noreferrer"><code>.cvsignore</code></a> in the early 1990s and version control systems like <a href="https://www.bitkeeper.org/man/ignore.html" target="_blank" rel="noopener noreferrer">BitKeeper</a> and <a href="https://www.perforce.com/manuals/cmdref/Content/CmdRef/P4IGNORE.html" target="_blank" rel="noopener noreferrer">Perforce</a> had their own versions well before git existed. Most modern tools take their syntax from git, roughly in order of how likely you are to encounter them:</p>

<ul>
  <li><a href="https://docs.docker.com/build/concepts/context/" target="_blank" rel="noopener noreferrer"><code>.dockerignore</code></a> for Docker build context</li>
  <li><a href="https://docs.npmjs.com/cli/v11/using-npm/developers/" target="_blank" rel="noopener noreferrer"><code>.npmignore</code></a> for npm package publishing</li>
  <li><a href="https://prettier.io/docs/ignore" target="_blank" rel="noopener noreferrer"><code>.prettierignore</code></a>, <a href="https://eslint.org/docs/latest/use/configure/ignore" target="_blank" rel="noopener noreferrer"><code>.eslintignore</code></a>, <a href="https://stylelint.io/user-guide/ignore-code/" target="_blank" rel="noopener noreferrer"><code>.stylelintignore</code></a> for JavaScript linters and formatters</li>
  <li><a href="https://www.selenic.com/mercurial/hgignore.5.html" target="_blank" rel="noopener noreferrer"><code>.hgignore</code></a> for Mercurial</li>
  <li><a href="https://github.com/containers/common/blob/main/docs/containerignore.5.md" target="_blank" rel="noopener noreferrer"><code>.containerignore</code></a> for Podman and Buildah (the OCI alternative to <code>.dockerignore</code>)</li>
  <li><a href="https://cloud.google.com/sdk/gcloud/reference/topic/gcloudignore" target="_blank" rel="noopener noreferrer"><code>.gcloudignore</code></a> for Google Cloud</li>
  <li><a href="https://vercel.com/docs/deployments/vercel-ignore" target="_blank" rel="noopener noreferrer"><code>.vercelignore</code></a> for Vercel (<code>.nowignore</code> was the legacy name)</li>
  <li><a href="https://devcenter.heroku.com/articles/slug-compiler" target="_blank" rel="noopener noreferrer"><code>.slugignore</code></a> for Heroku</li>
  <li><a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3-configuration.html" target="_blank" rel="noopener noreferrer"><code>.ebignore</code></a> for AWS Elastic Beanstalk</li>
  <li><a href="https://docs.cloudfoundry.org/devguide/deploy-apps/deploy-app.html" target="_blank" rel="noopener noreferrer"><code>.cfignore</code></a> for Cloud Foundry</li>
  <li><a href="https://helm.sh/docs/chart_template_guide/helm_ignore_file/" target="_blank" rel="noopener noreferrer"><code>.helmignore</code></a> for Helm charts</li>
  <li><a href="https://learn.microsoft.com/en-us/azure/devops/artifacts/reference/artifactignore" target="_blank" rel="noopener noreferrer"><code>.artifactignore</code></a> for Azure DevOps</li>
  <li><a href="https://learn.microsoft.com/en-us/azure/developer/azure-developer-cli/service-packaging-ignore-files" target="_blank" rel="noopener noreferrer"><code>.funcignore</code></a> for Azure Functions</li>
  <li><a href="https://code.visualstudio.com/api/working-with-extensions/publishing-extension" target="_blank" rel="noopener noreferrer"><code>.vscodeignore</code></a> for VS Code extension packaging</li>
  <li><a href="https://docs.chef.io/chef_repo/" target="_blank" rel="noopener noreferrer"><code>.chefignore</code></a> for Chef</li>
  <li><a href="https://web.archive.org/web/20220811170451/http://doc.bazaar.canonical.com/latest/en/user-guide/controlling_registration.html" target="_blank" rel="noopener noreferrer"><code>.bzrignore</code></a> for Bazaar</li>
  <li><code>.ignore</code>, <code>.rgignore</code>, <code>.agignore</code> for <a href="https://github.com/BurntSushi/ripgrep" target="_blank" rel="noopener noreferrer">ripgrep</a> and <a href="https://github.com/ggreer/the_silver_searcher" target="_blank" rel="noopener noreferrer">the silver searcher</a></li>
</ul>

<h3>How others differ</h3>

<p>Docker’s is probably the most consequential ignore file after git’s, because it affects build context size and therefore build speed and layer caching. But it’s still just one flat file with no cascading, no per-directory overrides, and no global config. The pattern matching differs in subtle ways too: gitignore automatically prepends <code>**/</code> to unanchored patterns so they match at any depth, while Docker’s implementation (using Go’s <code>filepath.Match</code> under the hood) doesn’t do the same implicit anchoring. The <code>@balena/dockerignore</code> npm package has good documentation on these differences.</p>

<p>npm’s is interesting because of its inverted relationship with <code>package.json</code>. You can use a <code>files</code> array in <code>package.json</code> to allowlist instead of blocklist, and if you do, <code>.npmignore</code> is ignored. If there’s no <code>.npmignore</code> at all, npm falls back to <code>.gitignore</code>, which catches people out when they publish packages and find that their <code>dist/</code> directory was excluded because gitignore told npm to skip it. Running <code>npm pack --dry-run</code> before publishing shows you exactly which files would be included, which would have saved me hours the first time I hit this.</p>

<p>Mercurial’s <code>.hgignore</code> is more powerful than gitignore. It lets you choose your syntax per section with <code>syntax: glob</code> or <code>syntax: regexp</code>, and you can combine both in the same file, switching between them as needed. Glob patterns for the simple stuff, a regex for that one weird build artifact naming scheme, all in one file. It’s the only ignore file I know of that gives you regex, and the ability to mix syntaxes is something git never adopted.</p>

<h3>“Uses gitignore syntax”</h3>

<p>Most tools say “uses gitignore syntax” in their docs. What they usually mean is: glob patterns, one per line, <code>#</code> for comments, maybe <code>!</code> for negation. That’s a reasonable subset, but the differences bite you when you assume full compatibility.</p>

<p>Some don’t support negation at all, some don’t support comments, and some treat <code>*</code> as matching directory separators while others don’t. Doublestar <code>**</code> is supported by most but not all, and trailing <code>/</code> for directory-only matching varies enough between tools that you can’t assume it works the same way everywhere.</p>

<p>The underlying cause is implementation diversity. Tools using Go’s <code>filepath.Match</code> get different behavior from tools using the <code>ignore</code> npm package, which get different behavior from tools using Python’s <code>pathspec</code> library, which get different behavior from tools calling out to git’s own matching code. Each reimplementation makes slightly different choices about edge cases, and the gitignore spec is informal enough that these choices are all defensible. This is exactly what I ran into with go-git: it’s a mature, widely-used library, and its gitignore implementation still doesn’t handle unanchored patterns correctly in nested directories.</p>

<p>A proper compatibility matrix across all these tools (supports negation? comments? doublestar? directory-only matching? cascading?) would be useful reference material. I haven’t found one, and writing it would mean empirically testing each tool rather than trusting their docs. Create a test fixture directory with files designed to probe each feature, write the ignore file, run the operation, and see what actually gets included. The tricky part is that each tool’s operation is different: <code>npm pack --dry-run</code>, <code>docker build</code>, <code>git status</code>, <code>eslint .</code>. You’d need per-tool test harnesses.</p>

<h3>CommonIgnore</h3>

<p>One corner of the ecosystem actually tried to consolidate rather than adding yet another format. ripgrep and the silver searcher (ag) both deprecated their tool-specific ignore files (<code>.rgignore</code> and <code>.agignore</code>) in favor of a shared <code>.ignore</code> file. ripgrep’s precedence chain is <code>.gitignore</code> then <code>.ignore</code> then <code>.rgignore</code>, with each layer overriding the previous. BurntSushi extracted the matching logic into the <a href="https://crates.io/crates/ignore" target="_blank" rel="noopener noreferrer"><code>ignore</code></a> crate (part of the ripgrep monorepo, 91M+ downloads), and other tools like <code>fd</code> picked it up too. It’s tool-agnostic by convention rather than by any formal standard, but it’s the closest anyone has come to sharing an ignore format across tools.</p>

<p>Markdown had a similar problem for years. Every tool claimed to support “Markdown” but each implemented a slightly different dialect, with different rules for edge cases around nesting, link parsing, and emphasis. <a href="https://commonmark.org/" target="_blank" rel="noopener noreferrer">CommonMark</a> fixed this by writing an unambiguous formal spec with hundreds of examples that serve as a test suite. Now tools can test their parser against the spec rather than guessing at intent, and users can rely on consistent behavior across implementations.</p>

<p>It’s not hard to imagine something similar for ignore files. Git’s <a href="https://git-scm.com/docs/gitignore" target="_blank" rel="noopener noreferrer">documentation</a> describes the behavior in prose, which leaves room for interpretation on things like how <code>*</code> interacts with <code>/</code>, whether <code>**</code> must be surrounded by separators, and what happens when bracket ranges span from uppercase to lowercase. A formal spec with a shared test suite could let tool authors say “we implement level 1” (basic globs and comments) or “level 2” (add negation and doublestar) rather than the current vague gesture at gitignore compatibility. The <a href="https://github.com/git/git/blob/master/t/t3070-wildmatch.sh" target="_blank" rel="noopener noreferrer">wildmatch test cases</a> in git’s own test suite are a starting point, but they only cover pattern matching, not the layering, anchoring, and directory semantics that trip up most implementations.</p></div> <footer class="article-footer" data-astro-cid-wrgicudb> <div class="action-row" data-astro-cid-wrgicudb> <a href="https://nesbitt.io/2026/02/12/the-many-flavors-of-ignore-files.html" target="_blank" rel="noopener noreferrer" class="read-original-btn" data-astro-cid-wrgicudb>
阅读原文 ↗
</a> </div> <div class="back-to-list" data-astro-cid-wrgicudb> <a href="/reading-list" class="back-link" data-astro-cid-wrgicudb>← 返回订阅列表</a> </div> </footer> </article> </div>  </main> <footer class="site-footer" aria-label="Site footer" data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <p class="footer-text" data-astro-cid-sz7xmlte>
&copy; 2026 AstroBlog
</p> <p class="footer-text" data-astro-cid-sz7xmlte>
Built with  <a href="https://astro.build/" target="_blank" rel="noopener noreferrer" class="footer-link" data-astro-cid-sz7xmlte>
Astro
</a> </p> </div> </footer>  </body></html> 