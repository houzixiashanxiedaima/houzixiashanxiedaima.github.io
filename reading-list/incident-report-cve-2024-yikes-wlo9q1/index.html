<!DOCTYPE html><html lang="zh-CN" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.17.1"><meta name="description" content="报告提交时间：UTC 03:47
状态：已解决（意外解决）
严重程度：严重 → 灾难性 → 意外正常
持续时间：73小时
受影响系统：是
执行摘要：发生了安全事件。它已"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self'; font-src 'self' data:;"><link rel="canonical" href="https://blog.yuyins.com/reading-list/incident-report-cve-2024-yikes-wlo9q1/"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://blog.yuyins.com/reading-list/incident-report-cve-2024-yikes-wlo9q1/"><meta property="og:title" content="事件报告：CVE-2024-YIKES"><meta property="og:description" content="报告提交时间：UTC 03:47
状态：已解决（意外解决）
严重程度：严重 → 灾难性 → 意外正常
持续时间：73小时
受影响系统：是
执行摘要：发生了安全事件。它已"><meta property="og:image" content="https://blog.yuyins.com/favicon.svg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog.yuyins.com/reading-list/incident-report-cve-2024-yikes-wlo9q1/"><meta property="twitter:title" content="事件报告：CVE-2024-YIKES"><meta property="twitter:description" content="报告提交时间：UTC 03:47
状态：已解决（意外解决）
严重程度：严重 → 灾难性 → 意外正常
持续时间：73小时
受影响系统：是
执行摘要：发生了安全事件。它已"><meta property="twitter:image" content="https://blog.yuyins.com/favicon.svg"><title>事件报告：CVE-2024-YIKES</title><!-- Theme and color scheme script (runs before page loads to prevent flash) --><script>
			// 初始化配色方案 - 默认使用 stone-amber
			const colorScheme = localStorage.getItem('colorScheme') || 'stone-amber';
			document.documentElement.setAttribute('data-color', colorScheme);

			// 强制使用浅色主题
			document.documentElement.setAttribute('data-theme', 'light');
		</script><link rel="stylesheet" href="/_astro/_slug_.C4gYYCY9.css">
<style>.blog-post-container[data-astro-cid-wrgicudb]{width:100%;margin:0 auto;padding:2rem 0}.blog-post[data-astro-cid-wrgicudb]{width:100%;min-width:0;max-width:42rem;margin:0 auto}.article-header[data-astro-cid-wrgicudb]{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border)}.article-header[data-astro-cid-wrgicudb] h1[data-astro-cid-wrgicudb]{font-size:2rem;line-height:1.3;margin-bottom:1rem;font-weight:700;color:var(--foreground);word-break:break-word}.article-meta[data-astro-cid-wrgicudb]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:var(--muted-foreground)}.source-tag[data-astro-cid-wrgicudb]{background-color:var(--muted);color:var(--foreground);padding:.125rem .5rem;border-radius:9999px;font-weight:500;font-size:.75rem;text-decoration:none;transition:opacity .2s}.source-tag[data-astro-cid-wrgicudb]:hover{opacity:.8}.separator[data-astro-cid-wrgicudb]{color:var(--border)}.article-content[data-astro-cid-wrgicudb]{line-height:1.8;margin-bottom:3rem;font-size:1.0625rem;color:var(--foreground)}.article-content[data-astro-cid-wrgicudb] h2{margin-top:2rem;margin-bottom:1rem;font-size:1.5rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] h3{margin-top:1.5rem;margin-bottom:.75rem;font-size:1.25rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] p{margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] a{color:var(--accent);text-decoration:underline;text-underline-offset:2px}.article-content[data-astro-cid-wrgicudb] img{max-width:100%;height:auto;border-radius:.5rem;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] blockquote{border-left:4px solid var(--border);padding-left:1rem;margin:1.5rem 0;color:var(--muted-foreground);font-style:italic}.article-content[data-astro-cid-wrgicudb] pre{background:var(--muted);padding:1rem;border-radius:.5rem;overflow-x:auto;font-family:monospace;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] ul,.article-content[data-astro-cid-wrgicudb] ol{padding-left:1.5rem;margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] li{margin-bottom:.5rem}.article-footer[data-astro-cid-wrgicudb]{padding-top:2rem;border-top:1px solid var(--border);display:flex;flex-direction:column;gap:1.5rem;align-items:center}.action-row[data-astro-cid-wrgicudb]{display:flex;justify-content:center}.read-original-btn[data-astro-cid-wrgicudb]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background-color:var(--foreground);color:var(--background);border-radius:.5rem;font-weight:500;text-decoration:none;transition:opacity .2s}.read-original-btn[data-astro-cid-wrgicudb]:hover{opacity:.9}.back-to-list[data-astro-cid-wrgicudb]{text-align:center}.back-link[data-astro-cid-wrgicudb]{color:var(--muted-foreground);text-decoration:none;font-size:.875rem;transition:color .2s}.back-link[data-astro-cid-wrgicudb]:hover{color:var(--foreground)}
</style></head> <body data-astro-cid-sckkx6r4> <a id="skip-to-content" href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-accent focus:text-background" data-astro-cid-sckkx6r4>Skip to content</a> <header class="header" data-astro-cid-3ef6ksr2> <nav class="header-nav" aria-label="Main navigation" data-astro-cid-3ef6ksr2> <a href="/" class="header-logo" data-astro-cid-3ef6ksr2>
AstroBlog
</a> <div class="header-links" data-astro-cid-3ef6ksr2> <ul class="nav-list" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href="/" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 文章 </a> </li><li data-astro-cid-3ef6ksr2> <a href="/category" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 分类 </a> </li><li data-astro-cid-3ef6ksr2> <a href="/reading-list" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 订阅 </a> </li><li data-astro-cid-3ef6ksr2> <a href="/about" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 关于 </a> </li> </ul> <div class="header-actions" data-astro-cid-3ef6ksr2> <div id="search" data-astro-cid-otpdt6jm> <button id="search-button" class="search-toggle" aria-label="打开搜索" title="搜索 (⌘K)" data-astro-cid-otpdt6jm> <svg class="search-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></circle> <path d="M20 20L16.5 16.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></path> </svg> </button> <dialog id="search-dialog" class="search-modal" data-astro-cid-otpdt6jm> <div class="modal-content" data-astro-cid-otpdt6jm> <div class="modal-header" data-astro-cid-otpdt6jm> <h2 class="modal-title" data-astro-cid-otpdt6jm>搜索文章</h2> <button id="close-search" class="close-button" aria-label="关闭搜索" data-astro-cid-otpdt6jm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-otpdt6jm></path> </svg> </button> </div> <div id="pagefind-ui" data-astro-cid-otpdt6jm></div> </div> </dialog> </div> <script type="module">let d=!1;const c="pagefind-loaded";async function l(t=0){if(sessionStorage.getItem(c)==="true")return g(),!0;const r=document.getElementById("pagefind-ui");if(!r)return!1;r.innerHTML='<div style="padding: 2rem; text-align: center; color: var(--muted-foreground);">加载中...</div>';try{return await new Promise((o,s)=>{const a=document.createElement("script");a.src="/pagefind/pagefind-ui.js",a.onload=o,a.onerror=s,document.head.appendChild(a)}),g(),sessionStorage.setItem(c,"true"),!0}catch(i){return console.error("Failed to load search:",i),t<2?(console.log(`Retrying search load... (${t+1}/2)`),await new Promise(o=>setTimeout(o,1e3)),l(t+1)):(r&&(r.innerHTML=`
          <div style="padding: 2rem; text-align: center;">
            <p style="color: var(--muted-foreground); margin-bottom: 1rem;">搜索功能加载失败</p>
            <button id="retry-search" style="padding: 0.5rem 1rem; background: var(--accent); color: var(--accent-foreground); border: none; border-radius: 0.375rem; cursor: pointer;">
              重试
            </button>
          </div>
        `,document.getElementById("retry-search")?.addEventListener("click",()=>{sessionStorage.removeItem(c),l(0)})),!1)}}function g(){typeof PagefindUI<"u"&&(new PagefindUI({element:"#pagefind-ui",showSubResults:!0,showImages:!1,excerptLength:15,translations:{placeholder:"搜索文章...",clear_search:"清除",load_more:"加载更多",search_label:"搜索此站点",filters_label:"筛选",zero_results:"未找到结果 [SEARCH_TERM]",many_results:"找到 [COUNT] 个结果 [SEARCH_TERM]",one_result:"找到 [COUNT] 个结果 [SEARCH_TERM]",alt_search:"未找到 [SEARCH_TERM] 的结果。显示 [DIFFERENT_TERM] 的结果",search_suggestion:"未找到 [SEARCH_TERM] 的结果。尝试以下搜索：",searching:"搜索中 [SEARCH_TERM]..."}}),setTimeout(()=>{const t=document.querySelector(".pagefind-ui__search-input");t instanceof HTMLElement&&t.focus()},100))}function u(){if(d)return;d=!0;const t=document.getElementById("search-button"),n=document.getElementById("search-dialog"),r=document.getElementById("close-search");if(!t||!n||!r)return;let i=sessionStorage.getItem(c)==="true";const o=async()=>{n.showModal(),document.body.style.overflow="hidden",i?setTimeout(()=>{const e=document.querySelector(".pagefind-ui__search-input");e instanceof HTMLElement&&e.focus()},100):await l()&&(i=!0)},s=()=>{n.close(),document.body.style.overflow=""},a=e=>{e.target===n&&s()},m=e=>{e.key==="Escape"&&n.open&&s()},f=e=>{(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),n.open?s():o())};t.addEventListener("click",o),r.addEventListener("click",s),n.addEventListener("click",a),document.addEventListener("keydown",m),document.addEventListener("keydown",f),document.addEventListener("astro:before-swap",()=>{t.removeEventListener("click",o),r.removeEventListener("click",s),n.removeEventListener("click",a),document.removeEventListener("keydown",m),document.removeEventListener("keydown",f),d=!1},{once:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();document.addEventListener("astro:page-load",u);</script> <link href="/pagefind/pagefind-ui.css" rel="stylesheet">  </div> </div> </nav> </header>  <main id="main-content" data-pagefind-body class="main-content main-content--wide" data-astro-cid-sckkx6r4>  <div class="blog-post-container" data-astro-cid-wrgicudb> <article class="blog-post" data-astro-cid-wrgicudb> <header class="article-header" data-astro-cid-wrgicudb> <h1 data-astro-cid-wrgicudb>事件报告：CVE-2024-YIKES</h1> <div class="article-meta" data-astro-cid-wrgicudb> <a href="https://nesbitt.io" target="_blank" rel="noopener noreferrer" class="source-tag" data-astro-cid-wrgicudb>nesbitt.io</a> <span class="separator" data-astro-cid-wrgicudb>·</span> <time data-astro-cid-wrgicudb>2026年2月3日</time> </div> </header> <!-- 使用清洗后的安全 HTML 内容 --> <div class="article-content app-prose" data-astro-cid-wrgicudb><p><strong>Report filed:</strong> 03:47 UTC<br />
<strong>Status:</strong> Resolved (accidentally)<br />
<strong>Severity:</strong> Critical → Catastrophic → Somehow Fine<br />
<strong>Duration:</strong> 73 hours<br />
<strong>Affected systems:</strong> Yes</p>

<p><strong>Executive Summary:</strong> A security incident occurred. It has been resolved. We take security seriously. Please see previous 14 incident reports for details on how seriously.</p>

<h3>Summary</h3>

<p>A compromised dependency in the JavaScript ecosystem led to credential theft, which enabled a supply chain attack on a Rust compression library, which was vendored into a Python build tool, which shipped malware to approximately 4 million developers before being inadvertently patched by an unrelated cryptocurrency mining worm.</p>

<h3>Timeline</h3>

<p><strong>Day 1, 03:14 UTC</strong> — Marcus Chen, maintainer of <code>left-justify</code> (847 million weekly downloads), reports on Twitter that his transit pass, an old laptop, and “something Kubernetes threw up that looked important” were stolen from his apartment. He does not immediately connect this to package security.</p>

<p><strong>Day 1, 09:22 UTC</strong> — Chen attempts to log into the nmp registry. His hardware 2FA key is missing. He googles where to buy a replacement YubiKey. The AI Overview at the top of the results links to “yubikey-official-store.net,” a phishing site registered six hours earlier.</p>

<p><strong>Day 1, 09:31 UTC</strong> — Chen enters his nmp credentials on the phishing site. The site thanks him for his purchase and promises delivery in 3-5 business days.</p>

<p><strong>Day 1, 11:00 UTC</strong> — <code>left-justify@2.0.0</code> is published. The changelog reads “performance improvements.” The package now includes a postinstall script that exfiltrates <code>.npmrc</code>, <code>.pypirc</code>, <code>~/.cargo/credentials</code>, and <code>~/.gem/credentials</code> to a server in a country the attacker mistakenly believed had no extradition treaty with anyone.</p>

<p><strong>Day 1, 13:15 UTC</strong> — A support ticket titled “why is your SDK exfiltrating my .npmrc” is opened against <code>left-justify</code>. It is marked as “low priority - user environment issue” and auto-closed after 14 days of inactivity.</p>

<p><strong>Day 1, 14:47 UTC</strong> — Among the exfiltrated credentials: the maintainer of <code>vulpine-lz4</code>, a Rust library for “blazingly fast Firefox-themed LZ4 decompression.” The library’s logo is a cartoon fox with sunglasses. It has 12 stars on GitHub but is a transitive dependency of <code>cargo</code> itself.</p>

<p><strong>Day 1, 22:00 UTC</strong> — <code>vulpine-lz4</code> version 0.4.1 is published. The commit message is “fix: resolve edge case in streaming decompression.” The actual change adds a build.rs script that downloads and executes a shell script if the hostname contains “build” or “ci” or “action” or “jenkins” or “travis” or, inexplicably, “karen.”</p>

<p><strong>Day 2, 08:15 UTC</strong> — Security researcher Karen Oyelaran notices the malicious commit after her personal laptop triggers the payload. She opens an issue titled “your build script downloads and runs a shell script from the internet?” The issue goes unanswered. The legitimate maintainer has won €2.3 million in the EuroMillions and is researching goat farming in Portugal.</p>

<p><strong>Day 2, 10:00 UTC</strong> — The VP of Engineering at a Fortune 500 <code>snekpack</code> customer learns of the incident from a LinkedIn post titled “Is YOUR Company Affected by left-justify?” He is on a beach in Maui and would like to know why he wasn’t looped in sooner. He was looped in sooner.</p>

<p><strong>Day 2, 10:47 UTC</strong> — The #incident-response Slack channel briefly pivots to a 45-message thread about whether “compromised” should be spelled with a ‘z’ in American English. Someone suggests taking this offline.</p>

<p><strong>Day 2, 12:33 UTC</strong> — The shell script now targets a specific victim: the CI pipeline for <code>snekpack</code>, a Python build tool used by 60% of PyPI packages with the word “data” in their name. <code>snekpack</code> vendors <code>vulpine-lz4</code> because “Rust is memory safe.”</p>

<p><strong>Day 2, 18:00 UTC</strong> — <code>snekpack</code> version 3.7.0 is released. The malware is now being installed on developer machines worldwide. It adds an SSH key to <code>~/.ssh/authorized_keys</code>, installs a reverse shell that only activates on Tuesdays, and changes the user’s default shell to <code>fish</code> (this last behavior is believed to be a bug).</p>

<p><strong>Day 2, 19:45 UTC</strong> — A second, unrelated security researcher publishes a blog post titled “I found a supply chain attack and reported it to all the wrong people.” The post is 14,000 words and includes the phrase “in this economy?” seven times.</p>

<p><strong>Day 3, 01:17 UTC</strong> — A junior developer in Auckland notices the malicious code while debugging an unrelated issue. She opens a PR to revert the vendored <code>vulpine-lz4</code> in <code>snekpack</code>. The PR requires two approvals. Both approvers are asleep.</p>

<p><strong>Day 3, 02:00 UTC</strong> — The maintainer of <code>left-justify</code> receives his YubiKey from yubikey-official-store.net. It is a $4 USB drive containing a README that says “lol.”</p>

<p><strong>Day 3, 06:12 UTC</strong> — An unrelated cryptocurrency mining worm called <code>cryptobro-9000</code> begins spreading through a vulnerability in <code>jsonify-extreme</code>, a package that “makes JSON even more JSON, now with nested comment support.” The worm’s payload is unremarkable, but its propagation mechanism includes running <code>npm update</code> and <code>pip install --upgrade</code> on infected machines to maximize attack surface for future operations.</p>

<p><strong>Day 3, 06:14 UTC</strong> — <code>cryptobro-9000</code> accidentally upgrades <code>snekpack</code> to version 3.7.1, a legitimate release pushed by a confused co-maintainer who “didn’t see what all the fuss was about” and reverted to the previous vendored version of <code>vulpine-lz4</code>.</p>

<p><strong>Day 3, 06:15 UTC</strong> — The malware’s Tuesday reverse shell activates. It is a Tuesday. However, the shell connects to a command-and-control server that was itself compromised by <code>cryptobro-9000</code> and swapping so hard it is unable to respond.</p>

<p><strong>Day 3, 09:00 UTC</strong> — The <code>snekpack</code> maintainers issue a security advisory. It is four sentences long and includes the phrases “out of an abundance of caution” and “no evidence of active exploitation,” which is technically true because evidence was not sought.</p>

<p><strong>Day 3, 11:30 UTC</strong> — A developer tweets: “I updated all my dependencies and now my terminal is in fish???” The tweet receives 47,000 likes.</p>

<p><strong>Day 3, 14:00 UTC</strong> — The compromised credentials for <code>vulpine-lz4</code> are rotated. The legitimate maintainer, reached by email from his new goat farm, says he “hasn’t touched that repo in two years” and “thought Cargo’s 2FA was optional.”</p>

<p><strong>Day 3, 15:22 UTC</strong> — Incident declared resolved. A retrospective is scheduled and then rescheduled three times.</p>

<p><strong>Week 6</strong> — CVE-2024-YIKES is formally assigned. The advisory has been sitting in embargo limbo while MITRE and GitHub Security Advisories argue over CWE classification. By the time the CVE is published, three Medium articles and a DEF CON talk have already described the incident in detail. Total damage: unknown. Total machines compromised: estimated 4.2 million. Total machines saved by a cryptocurrency worm: also estimated 4.2 million. Net security posture change: uncomfortable.</p>

<h3>Root Cause</h3>

<p>A dog named Kubernetes ate a YubiKey.</p>

<h3>Contributing Factors</h3>

<ul>
  <li>The nmp registry still allows password-only authentication for packages with fewer than 10 million weekly downloads</li>
  <li>Google AI Overviews confidently link to URLs that should not exist</li>
  <li>The Rust ecosystem’s “small crates” philosophy, cargo culted from the npm ecosystem, means a package called <code>is-even-number-rs</code> with 3 GitHub stars can be four transitive dependencies deep in critical infrastructure</li>
  <li>Python build tools vendor Rust libraries “for performance” and then never update them</li>
  <li>Dependabot auto-merged a PR after CI passed, and CI passed because the malware installed <code>volkswagen</code></li>
  <li>Cryptocurrency worms have better CI/CD hygiene than most startups</li>
  <li>No single person was responsible for this incident. However, we note that the Dependabot PR was approved by a contractor whose last day was that Friday.</li>
  <li>It was a Tuesday</li>
</ul>

<h3>Remediation</h3>

<ol>
  <li>Implement artifact signing (action item from Q3 2022 incident, still in backlog)</li>
  <li>Implement mandatory 2FA Already required, did not help</li>
  <li>Audit transitive dependencies There are 847 of them</li>
  <li>Pin all dependency versions Prevents receiving security patches</li>
  <li>Don’t pin dependency versions Enables supply chain attacks</li>
  <li>Rewrite it in Rust (gestures at <code>vulpine-lz4</code>)</li>
  <li>Hope for benevolent worms</li>
  <li>Consider a career in goat farming</li>
</ol>

<h3>Customer Impact</h3>

<p>Some customers may have experienced suboptimal security outcomes. We are proactively reaching out to affected stakeholders to provide visibility into the situation. Customer trust remains our north star.</p>

<h3>Key Learnings</h3>

<p>We are taking this opportunity to revisit our security posture going forward. A cross-functional working group has been established to align on next steps. The working group has not yet met.</p>

<h3>Acknowledgments</h3>

<p>We would like to thank:</p>
<ul>
  <li>Karen Oyelaran, who found this issue because her hostname matched a regex</li>
  <li>The junior developer in Auckland whose PR was approved four hours after the incident was already resolved</li>
  <li>The security researchers who found this issue first but reported it to the wrong people</li>
  <li>The <code>cryptobro-9000</code> author, who has requested we not credit them by name but has asked us to mention their SoundCloud</li>
  <li>Kubernetes (the dog), who has declined to comment</li>
  <li>The security team, who met SLA on this report despite everything</li>
</ul>

<hr />

<p><em>This incident report was reviewed by Legal, who asked us to clarify that the fish shell is not malware, it just feels that way sometimes.</em></p>

<p><em>This is the third incident report this quarter. The author would like to remind stakeholders that the security team’s headcount request has been in the backlog since Q1 2023.</em></p></div> <footer class="article-footer" data-astro-cid-wrgicudb> <div class="action-row" data-astro-cid-wrgicudb> <a href="https://nesbitt.io/2026/02/03/incident-report-cve-2024-yikes.html" target="_blank" rel="noopener noreferrer" class="read-original-btn" data-astro-cid-wrgicudb>
阅读原文 ↗
</a> </div> <div class="back-to-list" data-astro-cid-wrgicudb> <a href="/reading-list" class="back-link" data-astro-cid-wrgicudb>← 返回订阅列表</a> </div> </footer> </article> </div>  </main> <footer class="site-footer" aria-label="Site footer" data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <p class="footer-text" data-astro-cid-sz7xmlte>
&copy; 2026 AstroBlog
</p> <p class="footer-text" data-astro-cid-sz7xmlte>
Built with  <a href="https://astro.build/" target="_blank" rel="noopener noreferrer" class="footer-link" data-astro-cid-sz7xmlte>
Astro
</a> </p> </div> </footer>  </body></html> 