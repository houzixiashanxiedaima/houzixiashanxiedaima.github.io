<!DOCTYPE html><html lang="zh-CN" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.17.1"><meta name="description" content="本项目的所有显著变更均会记录在此文件中。格式基于 Keep a Changelog。
[1.2.0] - 2025-09-14

- mathjs 依赖已被移除。体积 14MB，包含 200+ 个函数。十二个函数使用。"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self'; font-src 'self' data:;"><link rel="canonical" href="https://blog.yuyins.com/reading-list/changelogmd-7xcjds/"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://blog.yuyins.com/reading-list/changelogmd-7xcjds/"><meta property="og:title" content="更新日志.md"><meta property="og:description" content="本项目的所有显著变更均会记录在此文件中。格式基于 Keep a Changelog。
[1.2.0] - 2025-09-14

- mathjs 依赖已被移除。体积 14MB，包含 200+ 个函数。十二个函数使用。"><meta property="og:image" content="https://blog.yuyins.com/favicon.svg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog.yuyins.com/reading-list/changelogmd-7xcjds/"><meta property="twitter:title" content="更新日志.md"><meta property="twitter:description" content="本项目的所有显著变更均会记录在此文件中。格式基于 Keep a Changelog。
[1.2.0] - 2025-09-14

- mathjs 依赖已被移除。体积 14MB，包含 200+ 个函数。十二个函数使用。"><meta property="twitter:image" content="https://blog.yuyins.com/favicon.svg"><title>更新日志.md</title><!-- Theme and color scheme script (runs before page loads to prevent flash) --><script>
			// 初始化配色方案 - 默认使用 stone-amber
			const colorScheme = localStorage.getItem('colorScheme') || 'stone-amber';
			document.documentElement.setAttribute('data-color', colorScheme);

			// 强制使用浅色主题
			document.documentElement.setAttribute('data-theme', 'light');
		</script><link rel="stylesheet" href="/_astro/_slug_.BK6BiV5P.css">
<style>.blog-post-container[data-astro-cid-wrgicudb]{width:100%;margin:0 auto;padding:2rem 0}.blog-post[data-astro-cid-wrgicudb]{width:100%;min-width:0;max-width:42rem;margin:0 auto}.article-header[data-astro-cid-wrgicudb]{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border)}.article-header[data-astro-cid-wrgicudb] h1[data-astro-cid-wrgicudb]{font-size:2rem;line-height:1.3;margin-bottom:1rem;font-weight:700;color:var(--foreground);word-break:break-word}.article-meta[data-astro-cid-wrgicudb]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:var(--muted-foreground)}.source-tag[data-astro-cid-wrgicudb]{background-color:var(--muted);color:var(--foreground);padding:.125rem .5rem;border-radius:9999px;font-weight:500;font-size:.75rem;text-decoration:none;transition:opacity .2s}.source-tag[data-astro-cid-wrgicudb]:hover{opacity:.8}.separator[data-astro-cid-wrgicudb]{color:var(--border)}.article-content[data-astro-cid-wrgicudb]{line-height:1.8;margin-bottom:3rem;font-size:1.0625rem;color:var(--foreground)}.article-content[data-astro-cid-wrgicudb] h2{margin-top:2rem;margin-bottom:1rem;font-size:1.5rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] h3{margin-top:1.5rem;margin-bottom:.75rem;font-size:1.25rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] p{margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] a{color:var(--accent);text-decoration:underline;text-underline-offset:2px}.article-content[data-astro-cid-wrgicudb] img{max-width:100%;height:auto;border-radius:.5rem;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] blockquote{border-left:4px solid var(--border);padding-left:1rem;margin:1.5rem 0;color:var(--muted-foreground);font-style:italic}.article-content[data-astro-cid-wrgicudb] pre{background:var(--muted);padding:1rem;border-radius:.5rem;overflow-x:auto;font-family:monospace;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] ul,.article-content[data-astro-cid-wrgicudb] ol{padding-left:1.5rem;margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] li{margin-bottom:.5rem}.article-footer[data-astro-cid-wrgicudb]{padding-top:2rem;border-top:1px solid var(--border);display:flex;flex-direction:column;gap:1.5rem;align-items:center}.action-row[data-astro-cid-wrgicudb]{display:flex;justify-content:center}.read-original-btn[data-astro-cid-wrgicudb]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background-color:var(--foreground);color:var(--background);border-radius:.5rem;font-weight:500;text-decoration:none;transition:opacity .2s}.read-original-btn[data-astro-cid-wrgicudb]:hover{opacity:.9}.back-to-list[data-astro-cid-wrgicudb]{text-align:center}.back-link[data-astro-cid-wrgicudb]{color:var(--muted-foreground);text-decoration:none;font-size:.875rem;transition:color .2s}.back-link[data-astro-cid-wrgicudb]:hover{color:var(--foreground)}
</style></head> <body data-astro-cid-sckkx6r4> <a id="skip-to-content" href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-accent focus:text-background" data-astro-cid-sckkx6r4>Skip to content</a> <header class="header" data-astro-cid-3ef6ksr2> <nav class="header-nav" aria-label="Main navigation" data-astro-cid-3ef6ksr2> <a href="/" class="header-logo" data-astro-cid-3ef6ksr2>
AstroBlog
</a> <div class="header-links" data-astro-cid-3ef6ksr2> <ul class="nav-list" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href="/" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 文章 </a> </li><li data-astro-cid-3ef6ksr2> <a href="/category" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 分类 </a> </li><li data-astro-cid-3ef6ksr2> <a href="/reading-list" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 订阅 </a> </li><li data-astro-cid-3ef6ksr2> <a href="/about" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> 关于 </a> </li> </ul> <div class="header-actions" data-astro-cid-3ef6ksr2> <div id="search" data-astro-cid-otpdt6jm> <button id="search-button" class="search-toggle" aria-label="打开搜索" title="搜索 (⌘K)" data-astro-cid-otpdt6jm> <svg class="search-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></circle> <path d="M20 20L16.5 16.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></path> </svg> </button> <dialog id="search-dialog" class="search-modal" data-astro-cid-otpdt6jm> <div class="modal-content" data-astro-cid-otpdt6jm> <div class="modal-header" data-astro-cid-otpdt6jm> <h2 class="modal-title" data-astro-cid-otpdt6jm>搜索文章</h2> <button id="close-search" class="close-button" aria-label="关闭搜索" data-astro-cid-otpdt6jm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-otpdt6jm></path> </svg> </button> </div> <div id="pagefind-ui" data-astro-cid-otpdt6jm></div> </div> </dialog> </div> <script type="module">let d=!1;const c="pagefind-loaded";async function l(t=0){if(sessionStorage.getItem(c)==="true")return g(),!0;const r=document.getElementById("pagefind-ui");if(!r)return!1;r.innerHTML='<div style="padding: 2rem; text-align: center; color: var(--muted-foreground);">加载中...</div>';try{return await new Promise((o,s)=>{const a=document.createElement("script");a.src="/pagefind/pagefind-ui.js",a.onload=o,a.onerror=s,document.head.appendChild(a)}),g(),sessionStorage.setItem(c,"true"),!0}catch(i){return console.error("Failed to load search:",i),t<2?(console.log(`Retrying search load... (${t+1}/2)`),await new Promise(o=>setTimeout(o,1e3)),l(t+1)):(r&&(r.innerHTML=`
          <div style="padding: 2rem; text-align: center;">
            <p style="color: var(--muted-foreground); margin-bottom: 1rem;">搜索功能加载失败</p>
            <button id="retry-search" style="padding: 0.5rem 1rem; background: var(--accent); color: var(--accent-foreground); border: none; border-radius: 0.375rem; cursor: pointer;">
              重试
            </button>
          </div>
        `,document.getElementById("retry-search")?.addEventListener("click",()=>{sessionStorage.removeItem(c),l(0)})),!1)}}function g(){typeof PagefindUI<"u"&&(new PagefindUI({element:"#pagefind-ui",showSubResults:!0,showImages:!1,excerptLength:15,translations:{placeholder:"搜索文章...",clear_search:"清除",load_more:"加载更多",search_label:"搜索此站点",filters_label:"筛选",zero_results:"未找到结果 [SEARCH_TERM]",many_results:"找到 [COUNT] 个结果 [SEARCH_TERM]",one_result:"找到 [COUNT] 个结果 [SEARCH_TERM]",alt_search:"未找到 [SEARCH_TERM] 的结果。显示 [DIFFERENT_TERM] 的结果",search_suggestion:"未找到 [SEARCH_TERM] 的结果。尝试以下搜索：",searching:"搜索中 [SEARCH_TERM]..."}}),setTimeout(()=>{const t=document.querySelector(".pagefind-ui__search-input");t instanceof HTMLElement&&t.focus()},100))}function u(){if(d)return;d=!0;const t=document.getElementById("search-button"),n=document.getElementById("search-dialog"),r=document.getElementById("close-search");if(!t||!n||!r)return;let i=sessionStorage.getItem(c)==="true";const o=async()=>{n.showModal(),document.body.style.overflow="hidden",i?setTimeout(()=>{const e=document.querySelector(".pagefind-ui__search-input");e instanceof HTMLElement&&e.focus()},100):await l()&&(i=!0)},s=()=>{n.close(),document.body.style.overflow=""},a=e=>{e.target===n&&s()},m=e=>{e.key==="Escape"&&n.open&&s()},f=e=>{(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),n.open?s():o())};t.addEventListener("click",o),r.addEventListener("click",s),n.addEventListener("click",a),document.addEventListener("keydown",m),document.addEventListener("keydown",f),document.addEventListener("astro:before-swap",()=>{t.removeEventListener("click",o),r.removeEventListener("click",s),n.removeEventListener("click",a),document.removeEventListener("keydown",m),document.removeEventListener("keydown",f),d=!1},{once:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();document.addEventListener("astro:page-load",u);</script> <link href="/pagefind/pagefind-ui.css" rel="stylesheet">  </div> </div> </nav> </header>  <main id="main-content" data-pagefind-body class="main-content main-content--wide" data-astro-cid-sckkx6r4>  <div class="blog-post-container" data-astro-cid-wrgicudb> <article class="blog-post" data-astro-cid-wrgicudb> <header class="article-header" data-astro-cid-wrgicudb> <h1 data-astro-cid-wrgicudb>更新日志.md</h1> <div class="article-meta" data-astro-cid-wrgicudb> <a href="https://nesbitt.io" target="_blank" rel="noopener noreferrer" class="source-tag" data-astro-cid-wrgicudb>nesbitt.io</a> <span class="separator" data-astro-cid-wrgicudb>·</span> <time data-astro-cid-wrgicudb>2026年2月16日</time> </div> </header> <!-- 使用清洗后的安全 HTML 内容 --> <div class="article-content app-prose" data-astro-cid-wrgicudb><p>All notable changes to this project will be documented in this file. The format is based on <a href="https://keepachangelog.com/" target="_blank" rel="noopener noreferrer">Keep a Changelog</a>.</p>

<hr />

<h2>[1.2.0] - 2025-09-14</h2>

<h3>Removed</h3>
<ul>
  <li><code>mathjs</code> dependency. 14MB, 200+ functions. Twelve functions used.</li>
</ul>

<h3>Added</h3>
<ul>
  <li>Custom math utilities module (<code>src/math-utils.js</code>). Addition, subtraction, multiplication, division, a handful of trig functions. <code>Co-authored-by: chatgpt</code></li>
</ul>

<h3>Changed</h3>
<ul>
  <li>
    <p>Bundle size reduced by 68%. Build time down from 12s to 4s.</p>
  </li>
  <li>
    <p>Module: 47 lines across 1 file. 0 tests. 0 dependencies.</p>
  </li>
</ul>

<hr />

<h2>[1.3.0] - 2025-10-03</h2>

<h3>Added</h3>
<ul>
  <li>Percentage calculations. The replacement didn’t include them.</li>
  <li>Rounding functions (<code>round</code>, <code>ceil</code>, <code>floor</code>). These were being done inline in 14 different places, three different ways.</li>
</ul>

<h3>Fixed</h3>
<ul>
  <li>Division by zero no longer returns <code>Infinity</code>. Accounting flagged this after an invoice rendered a line item total as “$Infinity.” (Fixes #127 “Invoice total is $Infinity”)</li>
  <li><code>round(2.675, 2)</code> now returns <code>2.68</code> instead of <code>2.67</code>. Floating point. Added a workaround.</li>
  <li>Rounding workaround broke negative numbers. All credits issued in the last 48 hours were rounded in the customer’s favor. Escalation: finance.</li>
  <li>
    <p>Subtotal calculation was concatenating instead of adding. The pricing form submits values as strings. In JavaScript, <code>'149.99' + '24.99'</code> is the string <code>'149.9924.99'</code>, not <code>174.98</code>. (Fixes #148 “Customer charged $149 million for a $175 order”)</p>
  </li>
  <li>Module: 106 lines across 1 file. 0 tests. 0 dependencies.</li>
</ul>

<hr />

<h2>[1.4.0] - 2025-10-22</h2>

<h3>Added</h3>
<ul>
  <li>Expression parser for user-defined pricing formulas. Sales wanted this for months.</li>
</ul>

<h3>Security</h3>
<ul>
  <li>
    <p><strong>CVE-2025-41547</strong>: Expression parser was using <code>eval()</code>. What we were told was a recursive descent parser turned out to be a <code>Function()</code> constructor wrapping user input. A customer entered <code>require('child_process').exec('rm -rf /')</code> as a pricing formula. WAF caught it. Parser replaced.</p>
  </li>
  <li>
    <p>Module: 531 lines across 1 file. 0 tests. 0 dependencies.</p>
  </li>
</ul>

<hr />

<h2>[2.0.0] - 2025-11-15</h2>

<h3>Changed</h3>
<ul>
  <li>Rewritten. <code>Co-authored-by: gpt-4o</code></li>
</ul>

<h3>Added</h3>
<ul>
  <li>Matrix operations for reporting pivot tables.</li>
  <li>Statistical functions (<code>mean</code>, <code>median</code>, <code>standardDeviation</code>).</li>
  <li>Arbitrary precision decimals for currency. Previous implementation used IEEE 754 floating point for monetary values.</li>
</ul>

<h3>Fixed</h3>
<ul>
  <li>Expression parser does not handle operator precedence. <code>2 + 3 * 4</code> returns <code>20</code>. Enterprise customers have been receiving wrong bulk pricing since October.</li>
  <li>Currency amounts now stored as integers (cents) in the database. Retroactive correction tracked in JIRA-4521 through JIRA-4523.</li>
  <li>Matrix multiplication dimensions were backwards. Dashboard was multiplying a 3x2 by a 2x3 and getting a 2x2 result instead of 3x3.</li>
  <li>
    <p>Input validation checked <code>result === NaN</code> to catch bad calculations. This never catches anything, because <code>NaN === NaN</code> is <code>false</code> in JavaScript. Invalid calculations were silently passing through to invoices as <code>NaN</code>. The PDF renderer prints this as “NaN” in the total field. (Fixes #209 “What does NaN mean and why do I owe it”)</p>
  </li>
  <li>Module: 842 lines across 4 files. 47 tests. 0 dependencies.</li>
</ul>

<hr />

<h2>[2.0.2-hotfix] - 2025-11-18</h2>

<h3>Fixed</h3>
<ul>
  <li>Arbitrary precision decimals don’t handle negative numbers. All refunds since November 15 were applied as charges. (Fixes #203 “Refund charged me twice instead of refunding”) Escalation: legal. Further details tracked outside version control.</li>
</ul>

<hr />

<h2>[2.2.0] - 2025-12-17</h2>

<h3>Added</h3>
<ul>
  <li>Big number support. JavaScript’s <code>Number.MAX_SAFE_INTEGER</code> is 9,007,199,254,740,991. Required after a client began invoicing in Indonesian rupiah. Implementation is strings with manual digit-by-digit arithmetic. Addition works. Subtraction works when the result is positive. Multiplication works up to 15 digits.</li>
  <li>Long division. <code>Co-authored-by: copilot</code></li>
</ul>

<h3>Deprecated</h3>
<ul>
  <li><code>divide()</code>, which silently truncated past 15 digits, renamed to <code>divideLegacy()</code>.</li>
</ul>

<h3>Fixed</h3>
<ul>
  <li>An enterprise client’s order for exactly 9,999,999,999,999,999 rupiah was billed as 10,000,000,000,000,000. JavaScript silently rounds integers above <code>MAX_SAFE_INTEGER</code> to the nearest representable value. The big number module was supposed to prevent this but was not being called for integer-only amounts. Rounding discrepancy: 1 rupiah.</li>
  <li>
    <p>Long division infinite loops on repeating decimals. <code>1 / 3</code> does not terminate. Added a cap of 1,000 iterations, so <code>1 / 3</code> now returns a string with 1,003 characters. (Fixes #256 “Invoice PDF is 47 pages long for a single line item”)</p>
  </li>
  <li>Module: 1,891 lines across 6 files. 74 tests. 0 dependencies.</li>
</ul>

<hr />

<h2>[3.0.0] - 2026-01-20</h2>

<h3>Changed</h3>
<ul>
  <li>Rewritten (third iteration). <code>Co-authored-by: claude-sonnet</code></li>
</ul>

<h3>Added</h3>
<ul>
  <li>Plugin system for extensibility.</li>
</ul>

<h3>Removed</h3>
<ul>
  <li>
    <p>Vendored copy of mathjs that was committed in an earlier session. No commit message references its addition.</p>
  </li>
  <li>
    <p>Module: 2,814 lines across 11 files. 340 tests. 0 dependencies.</p>
  </li>
</ul>

<hr />

<h2>[3.0.1] - 2026-01-23</h2>

<h3>Removed</h3>
<ul>
  <li>Plugin system. Zero adoption. No usage documentation exists.</li>
</ul>

<h3>Added</h3>
<ul>
  <li>mathjs test suite added to the repository as a reference for expected behavior. Added <code>test/vendor/</code> to <code>.npmignore</code> so it doesn’t ship with the package.</li>
</ul>

<h3>Security</h3>
<ul>
  <li>Two test files were copy-pasted from a Stack Overflow answer that was itself taken from a GPL-licensed numerical methods textbook. Escalation: legal. Tests rewritten. Assertions are mathematically identical with different variable names.</li>
</ul>

<h3>Fixed</h3>
<ul>
  <li><code>factorial(171)</code> returns <code>Infinity</code>. Technically correct (it exceeds <code>Number.MAX_VALUE</code>) but the big number module was supposed to handle this. It doesn’t, because <code>factorial()</code> calls <code>multiply()</code> not <code>bigMultiply()</code>. The test suite tests up to <code>factorial(5)</code>, which returns 120.</li>
  <li>
    <p><code>min()</code> with no arguments returns <code>Infinity</code>. <code>max()</code> with no arguments returns <code>-Infinity</code>. This is correct per the JavaScript spec but the pricing engine calls <code>min()</code> on an empty array when a product has no discount tiers. (Fixes #271 “Discount: $Infinity”) Patched by checking for empty arrays. The check uses <code>arr.length == false</code>, which works because <code>0 == false</code> is <code>true</code> in JavaScript.</p>
  </li>
  <li>Module: 2,814 lines across 11 files. 340 tests. 4,281 vendored tests. 0 dependencies.</li>
</ul>

<hr />

<h2>[3.1.0] - 2026-01-29</h2>

<h3>Fixed</h3>
<ul>
  <li>Trig functions were treating all inputs as degrees. They should be radians. The original prompt said “make trig functions” and did not specify. (Fixes #285 “Delivery distances are wrong by varying amounts depending on the city”) Geospatial calculations incorrect from 2025-10-01 to 2026-01-29.</li>
  <li>A hardcoded <code>3.14159</code> instead of <code>Math.PI</code> in the billing cycle pro-ration function. Present since 1.2.0. Monthly invoices 0.00005% incorrect for five months.</li>
</ul>

<hr />

<h2>[3.2.0] - 2026-02-11</h2>

<h3>Added</h3>
<ul>
  <li>Logarithms. Finance needs them for compound interest.</li>
</ul>

<h3>Fixed</h3>
<ul>
  <li><code>log(0)</code> returns <code>-Infinity</code>, which is distinct from <code>Infinity</code>. Both are valid JavaScript numbers. Both are <code>typeof 'number'</code>. Neither is <code>NaN</code>. The PDF renderer handles <code>NaN</code> (after 2.0.1) but did not anticipate two different infinities. Negative infinity invoices print the minus sign. Positive infinity invoices do not. (Fixes #299 “Invoice shows just a minus sign with no amount”)</li>
  <li>
    <p><code>log()</code> is the natural logarithm. Finance wanted <code>log10()</code>. (Fixes #303 “Loan approved at 2.3x the correct interest rate”) Disclosure: customer dispute.</p>
  </li>
  <li>Module: 3,102 lines across 14 files. 340 tests. 4,281 vendored tests. 0 dependencies. 1 README. 1 contributing guide.</li>
</ul>

<hr />

<h2>[3.3.0] - 2026-02-20</h2>

<h3>Security</h3>
<ul>
  <li>Our “zero-dependency” math module imports <code>Buffer</code> for the big number implementation. In the browser build this pulls in a 500KB polyfill. Bundle size is now larger than when we had mathjs.</li>
</ul>

<h3>Changed</h3>
<ul>
  <li>Replaced <code>Buffer</code> with <code>Uint8Array</code>. Bundle size is down. Performance is down 340%. Big number division takes 8 seconds for anything over 20 digits. Performance regression observed in production.</li>
</ul>

<h3>Fixed</h3>
<ul>
  <li>Pricing tier validation used chained comparisons: <code>if (amount &gt; 100 &gt; 50)</code>. JavaScript evaluates left to right. <code>amount &gt; 100</code> returns <code>true</code> or <code>false</code>, then <code>true &gt; 50</code> is <code>false</code> and <code>false &gt; 50</code> is <code>false</code>. Every order was falling into the lowest pricing tier. (Fixes #312 “All customers getting the $5/mo plan”)</li>
  <li><code>Intl.NumberFormat</code> grouping separator changed from U+00A0 to U+202F in Chrome 119. Invoice amounts formatted in Chrome no longer pass string equality checks against amounts formatted in Safari or server-side Node 18. (Fixes #315 “Invoice validation fails in Chrome”)</li>
</ul>

<hr />

<h2>[4.0.0-rc.FINAL] - 2026-03-01</h2>

<h3>Changed</h3>
<ul>
  <li>Rewritten (spec-driven). Specification: 4,200 words. <code>Co-authored-by: cursor-agent</code></li>
</ul>

<h3>Fixed</h3>
<ul>
  <li>The spec specified IEEE 754 double-precision floating-point. This is the default JavaScript number type. The generated implementation followed the spec and reintroduced precision issues from versions prior to 2.0.0. Reverted to string-based big numbers from 2.x and integrated them into the 4.x architecture.</li>
  <li>
    <p>Integration of 2.x big numbers with 4.x created a circular require between <code>core.js</code> and <code>bignum.js</code>. Fixed by putting everything in one file. <code>Co-authored-by: devin</code></p>
  </li>
  <li>Module: 4,127 lines across 1 file. 2,100 tests. 4,281 vendored tests. 0 dependencies.</li>
</ul>

<hr />

<h2>[4.1.0] - 2026-03-18</h2>

<h3>Security</h3>
<ul>
  <li><strong>CVE-2026-10283</strong>: Prototype pollution in the expression parser. <code>{"__proto__": {"isAdmin": true}}</code> in the variable context modifies <code>Object.prototype</code> for every subsequent request in the process. (Fixes #327 “Expression parser allowed prototype pollution”) Disclosure: external. Expression parser rewritten (third iteration).</li>
</ul>

<h3>Fixed</h3>
<ul>
  <li>
    <p><code>typeof NaN</code> is <code>'number'</code> in JavaScript. The input validation checks <code>typeof result === 'number'</code> to confirm calculations succeeded. <code>NaN</code> passes this check. (Fixes #331 “Not a Number is a number?”) Replaced with <code>Number.isFinite()</code>, which rejects <code>NaN</code>, <code>Infinity</code>, and <code>-Infinity</code>.</p>
  </li>
  <li>
    <p>Module: 4,612 lines across 1 file. 2,100 tests. 4,281 vendored tests. 0 dependencies.</p>
  </li>
</ul>

<hr />

<h2>[4.3.0] - 2026-04-01</h2>

<h3>Fixed</h3>
<ul>
  <li><code>max(0, -0)</code> returns <code>-0</code>. JavaScript considers <code>0 === -0</code> to be true but <code>Object.is(0, -0)</code> to be false. (Fixes #342 “How is my balance negative zero dollars”) Audit requested written explanation of negative zero.</li>
  <li>Exchange rate conversion for a micro-pricing feature. <code>parseInt(0.0000001)</code> returns <code>1</code>. JavaScript converts the number to the string <code>"1e-7"</code> before parsing, and <code>parseInt</code> stops at the first non-numeric character, which is <code>e</code>. A per-API-call rate of $0.0000001 was being billed as $1. (Fixes #349 “Am I being charged $1 per API call or $0.0000001”)</li>
  <li>
    <p>Floor price validation used <code>Number.MIN_VALUE</code> as a minimum threshold, expecting it to be the smallest number JavaScript can represent. <code>Number.MIN_VALUE</code> is <code>5e-324</code>. It is positive. It is the smallest <em>positive</em> number, not the most negative. The minimum price floor was effectively zero. (Fixes #353 “We are paying customers to use the product”)</p>
  </li>
  <li>Module: 4,891 lines across 1 file. 2,140 tests. 4,281 vendored tests. 0 dependencies.</li>
</ul>

<hr />

<h2>[5.0.0-beta.FINAL] - 2026-04-05</h2>

<h3>Changed</h3>
<ul>
  <li>
    <p>Split into a monorepo. Seven packages: <code>@our/math-core</code>, <code>@our/math-bignum</code>, <code>@our/math-trig</code>, <code>@our/math-stats</code>, <code>@our/math-matrix</code>, <code>@our/math-parse</code>, <code>@our/math-utils</code>. The last one re-exports the other six. <code>Co-authored-by: windsurf-cascade</code></p>
  </li>
  <li>
    <p>Module: 6,430 lines across 7 packages. 2,140 tests. 4,281 vendored tests. 6 internal dependencies. 0 external dependencies.</p>
  </li>
</ul>

<hr />

<h2>[5.0.0] - 2026-04-08</h2>

<h3>Changed</h3>
<ul>
  <li>
    <p>Collapsed back into a single package. <code>"workspace:*"</code> did not resolve when published to npm. Monorepo configuration lacks documentation.</p>
  </li>
  <li>
    <p>Module: 6,430 lines across 1 package. 2,140 tests. 4,281 vendored tests. 0 dependencies.</p>
  </li>
</ul>

<hr />

<h2>[5.1.0] - 2026-04-15</h2>

<h3>Added</h3>
<ul>
  <li>Complex number support. The prompt was “add any missing math functions.” <code>Co-authored-by: gemini-2.5-pro</code></li>
</ul>

<h3>Fixed</h3>
<ul>
  <li><code>sqrt(-1)</code> returns <code>{re: 0, im: 1}</code> instead of <code>NaN</code>. Several call sites check <code>isNaN()</code> to validate input. These now silently accept negative numbers, which propagate as objects through the calculation pipeline until the invoice template renders the total as <code>[object Object]</code>.</li>
</ul>

<h3>Reverted</h3>
<ul>
  <li>Complex numbers.</li>
</ul>

<h3>Fixed</h3>
<ul>
  <li>Three invoices went out showing “[object Object]” as the amount due. (Fixes #371, #372, #374 “What is [object Object] and why do I owe it”)</li>
</ul>

<h3>Removed</h3>
<ul>
  <li>
    <p>Two vendored copies of mathjs found in <code>node_modules/@our/math-utils/node_modules/mathjs</code> and <code>node_modules/@our/math-parse/node_modules/mathjs</code>. Different versions (11.8.0 and 13.2.1). npm did not dedupe them. Neither was declared as a dependency. Origin undetermined.</p>
  </li>
  <li>
    <p>Module: 6,430 lines across 1 package. 2,140 tests. 4,281 vendored tests. 0 declared dependencies. Bundle size: 41MB.</p>
  </li>
</ul>

<hr />

<h2>[5.3.0] - 2026-05-05</h2>

<h3>Fixed</h3>
<ul>
  <li><code>mean()</code> divides by <code>arguments.length</code> instead of by the count of values in the array. Called as <code>mean([1, 2, 3])</code>, <code>arguments.length</code> is 1 because there is one argument: the array. Returns the sum. This has been wrong since 2.0.0. (Fixes #385 “Average order value looks incredible but is it real”) The board was pleased with the growth.</li>
  <li>Locale handling. <code>parseFloat("1.500,00")</code> returns <code>1.5</code> in every locale because <code>parseFloat</code> doesn’t care about your locale. German and French customers report all amounts over a thousand euros are being billed as single-digit. (Fixes #392 “Billed 1 euro 50 for a 1,500 euro order”)</li>
  <li>
    <p>Sorting. <code>[1, 5, 11, 2, 23].sort()</code> returns <code>[1, 11, 2, 23, 5]</code>. JavaScript’s default sort is lexicographic. (Fixes #398 “Top customers report is alphabetical somehow”) Ranking incorrect since launch.</p>
  </li>
  <li>Module: 6,430 lines across 1 package. 2,140 tests. 4,281 vendored tests. 0 dependencies.</li>
</ul>

<hr />

<h2>[6.0.0] - 2026-05-15</h2>

<h3>Added</h3>
<ul>
  <li>Began reintroducing <code>mathjs</code> for “the hard parts.” Keeping custom code for “the easy parts.”</li>
</ul>

<h3>Fixed</h3>
<ul>
  <li>
    <p>Custom <code>add()</code> and mathjs <code>math.add()</code> return different results for certain floating point inputs. Standardized on mathjs, then custom, then mathjs. Implementation alternates between mathjs and custom.</p>
  </li>
  <li>
    <p>Module: 6,430 lines across 1 package. 2,140 tests. 4,281 vendored tests. 1 dependency (14MB).</p>
  </li>
</ul>

<hr />

<h2>[6.1.0] - 2026-05-20</h2>

<h3>Removed</h3>
<ul>
  <li>Custom implementation.</li>
</ul>

<h3>Added</h3>
<ul>
  <li>
    <p><code>mathjs</code>.</p>
  </li>
  <li>
    <p>Module: 1 dependency.</p>
  </li>
</ul></div> <footer class="article-footer" data-astro-cid-wrgicudb> <div class="action-row" data-astro-cid-wrgicudb> <a href="https://nesbitt.io/2026/02/16/changelog.html" target="_blank" rel="noopener noreferrer" class="read-original-btn" data-astro-cid-wrgicudb>
阅读原文 ↗
</a> </div> <div class="back-to-list" data-astro-cid-wrgicudb> <a href="/reading-list" class="back-link" data-astro-cid-wrgicudb>← 返回订阅列表</a> </div> </footer> </article> </div>  </main> <footer class="site-footer" aria-label="Site footer" data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <p class="footer-text" data-astro-cid-sz7xmlte>
&copy; 2026 AstroBlog
</p> <p class="footer-text" data-astro-cid-sz7xmlte>
Built with  <a href="https://astro.build/" target="_blank" rel="noopener noreferrer" class="footer-link" data-astro-cid-sz7xmlte>
Astro
</a> </p> </div> </footer>  </body></html> 