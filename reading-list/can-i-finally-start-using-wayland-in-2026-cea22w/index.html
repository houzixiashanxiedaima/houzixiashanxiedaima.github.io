<!DOCTYPE html><html lang="zh-CN" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.17.1"><meta name="description" content="WaylandÊòØXÊúçÂä°Âô®ÔºàX11„ÄÅXorgÔºâÁöÑÂêéÁªßËÄÖÔºåÁî®‰∫éÂÆûÁé∞LinuxÂõæÂΩ¢Ê†à„ÄÇWaylandÈ°πÁõÆÂÆûÈôÖ‰∏äÂßã‰∫é2008Âπ¥ÔºåÊØîÊàëÂàõÂª∫i3Âπ≥Èì∫Á™óÂè£ÁÆ°ÁêÜÂô®Êó©‰∏ÄÂπ¥„ÄÇ"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self'; font-src 'self' data:;"><link rel="canonical" href="https://blog.yuyins.com/reading-list/can-i-finally-start-using-wayland-in-2026-cea22w/"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://blog.yuyins.com/reading-list/can-i-finally-start-using-wayland-in-2026-cea22w/"><meta property="og:title" content="2026Âπ¥ÔºåÊàëÁªà‰∫éÂèØ‰ª•ÂºÄÂßã‰ΩøÁî®Wayland‰∫ÜÂêóÔºü"><meta property="og:description" content="WaylandÊòØXÊúçÂä°Âô®ÔºàX11„ÄÅXorgÔºâÁöÑÂêéÁªßËÄÖÔºåÁî®‰∫éÂÆûÁé∞LinuxÂõæÂΩ¢Ê†à„ÄÇWaylandÈ°πÁõÆÂÆûÈôÖ‰∏äÂßã‰∫é2008Âπ¥ÔºåÊØîÊàëÂàõÂª∫i3Âπ≥Èì∫Á™óÂè£ÁÆ°ÁêÜÂô®Êó©‰∏ÄÂπ¥„ÄÇ"><meta property="og:image" content="https://blog.yuyins.com/favicon.svg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog.yuyins.com/reading-list/can-i-finally-start-using-wayland-in-2026-cea22w/"><meta property="twitter:title" content="2026Âπ¥ÔºåÊàëÁªà‰∫éÂèØ‰ª•ÂºÄÂßã‰ΩøÁî®Wayland‰∫ÜÂêóÔºü"><meta property="twitter:description" content="WaylandÊòØXÊúçÂä°Âô®ÔºàX11„ÄÅXorgÔºâÁöÑÂêéÁªßËÄÖÔºåÁî®‰∫éÂÆûÁé∞LinuxÂõæÂΩ¢Ê†à„ÄÇWaylandÈ°πÁõÆÂÆûÈôÖ‰∏äÂßã‰∫é2008Âπ¥ÔºåÊØîÊàëÂàõÂª∫i3Âπ≥Èì∫Á™óÂè£ÁÆ°ÁêÜÂô®Êó©‰∏ÄÂπ¥„ÄÇ"><meta property="twitter:image" content="https://blog.yuyins.com/favicon.svg"><title>2026Âπ¥ÔºåÊàëÁªà‰∫éÂèØ‰ª•ÂºÄÂßã‰ΩøÁî®Wayland‰∫ÜÂêóÔºü</title><!-- Theme and color scheme script (runs before page loads to prevent flash) --><script>
			// ÂàùÂßãÂåñÈÖçËâ≤ÊñπÊ°à - ÈªòËÆ§‰ΩøÁî® stone-amber
			const colorScheme = localStorage.getItem('colorScheme') || 'stone-amber';
			document.documentElement.setAttribute('data-color', colorScheme);

			// Âº∫Âà∂‰ΩøÁî®ÊµÖËâ≤‰∏ªÈ¢ò
			document.documentElement.setAttribute('data-theme', 'light');
		</script><link rel="stylesheet" href="/_astro/_slug_.AC5XNt97.css">
<style>.blog-post-container[data-astro-cid-wrgicudb]{width:100%;margin:0 auto;padding:2rem 0}.blog-post[data-astro-cid-wrgicudb]{width:100%;min-width:0;max-width:42rem;margin:0 auto}.article-header[data-astro-cid-wrgicudb]{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border)}.article-header[data-astro-cid-wrgicudb] h1[data-astro-cid-wrgicudb]{font-size:2rem;line-height:1.3;margin-bottom:1rem;font-weight:700;color:var(--foreground);word-break:break-word}.article-meta[data-astro-cid-wrgicudb]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:var(--muted-foreground)}.source-tag[data-astro-cid-wrgicudb]{background-color:var(--muted);color:var(--foreground);padding:.125rem .5rem;border-radius:9999px;font-weight:500;font-size:.75rem;text-decoration:none;transition:opacity .2s}.source-tag[data-astro-cid-wrgicudb]:hover{opacity:.8}.separator[data-astro-cid-wrgicudb]{color:var(--border)}.article-content[data-astro-cid-wrgicudb]{line-height:1.8;margin-bottom:3rem;font-size:1.0625rem;color:var(--foreground)}.article-content[data-astro-cid-wrgicudb] h2{margin-top:2rem;margin-bottom:1rem;font-size:1.5rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] h3{margin-top:1.5rem;margin-bottom:.75rem;font-size:1.25rem;font-weight:600}.article-content[data-astro-cid-wrgicudb] p{margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] a{color:var(--accent);text-decoration:underline;text-underline-offset:2px}.article-content[data-astro-cid-wrgicudb] img{max-width:100%;height:auto;border-radius:.5rem;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] blockquote{border-left:4px solid var(--border);padding-left:1rem;margin:1.5rem 0;color:var(--muted-foreground);font-style:italic}.article-content[data-astro-cid-wrgicudb] pre{background:var(--muted);padding:1rem;border-radius:.5rem;overflow-x:auto;font-family:monospace;margin:1.5rem 0}.article-content[data-astro-cid-wrgicudb] ul,.article-content[data-astro-cid-wrgicudb] ol{padding-left:1.5rem;margin-bottom:1.25rem}.article-content[data-astro-cid-wrgicudb] li{margin-bottom:.5rem}.article-footer[data-astro-cid-wrgicudb]{padding-top:2rem;border-top:1px solid var(--border);display:flex;flex-direction:column;gap:1.5rem;align-items:center}.action-row[data-astro-cid-wrgicudb]{display:flex;justify-content:center}.read-original-btn[data-astro-cid-wrgicudb]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background-color:var(--foreground);color:var(--background);border-radius:.5rem;font-weight:500;text-decoration:none;transition:opacity .2s}.read-original-btn[data-astro-cid-wrgicudb]:hover{opacity:.9}.back-to-list[data-astro-cid-wrgicudb]{text-align:center}.back-link[data-astro-cid-wrgicudb]{color:var(--muted-foreground);text-decoration:none;font-size:.875rem;transition:color .2s}.back-link[data-astro-cid-wrgicudb]:hover{color:var(--foreground)}
</style></head> <body data-astro-cid-sckkx6r4> <a id="skip-to-content" href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-accent focus:text-background" data-astro-cid-sckkx6r4>Skip to content</a> <header class="header" data-astro-cid-3ef6ksr2> <nav class="header-nav" aria-label="Main navigation" data-astro-cid-3ef6ksr2> <a href="/" class="header-logo" data-astro-cid-3ef6ksr2>
AstroBlog
</a> <div class="header-links" data-astro-cid-3ef6ksr2> <ul class="nav-list" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href="/" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> ÊñáÁ´† </a> </li><li data-astro-cid-3ef6ksr2> <a href="/category" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> ÂàÜÁ±ª </a> </li><li data-astro-cid-3ef6ksr2> <a href="/reading-list" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> ËÆ¢ÈòÖ </a> </li><li data-astro-cid-3ef6ksr2> <a href="/about" class="nav-link" data-astro-prefetch="true" data-astro-cid-3ef6ksr2> ÂÖ≥‰∫é </a> </li> </ul> <div class="header-actions" data-astro-cid-3ef6ksr2> <div id="search" data-astro-cid-otpdt6jm> <button id="search-button" class="search-toggle" aria-label="ÊâìÂºÄÊêúÁ¥¢" title="ÊêúÁ¥¢ (‚åòK)" data-astro-cid-otpdt6jm> <svg class="search-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></circle> <path d="M20 20L16.5 16.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" data-astro-cid-otpdt6jm></path> </svg> </button> <dialog id="search-dialog" class="search-modal" data-astro-cid-otpdt6jm> <div class="modal-content" data-astro-cid-otpdt6jm> <div class="modal-header" data-astro-cid-otpdt6jm> <h2 class="modal-title" data-astro-cid-otpdt6jm>ÊêúÁ¥¢ÊñáÁ´†</h2> <button id="close-search" class="close-button" aria-label="ÂÖ≥Èó≠ÊêúÁ¥¢" data-astro-cid-otpdt6jm> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-otpdt6jm> <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-astro-cid-otpdt6jm></path> </svg> </button> </div> <div id="pagefind-ui" data-astro-cid-otpdt6jm></div> </div> </dialog> </div> <script type="module">let d=!1;const c="pagefind-loaded";async function l(t=0){if(sessionStorage.getItem(c)==="true")return g(),!0;const r=document.getElementById("pagefind-ui");if(!r)return!1;r.innerHTML='<div style="padding: 2rem; text-align: center; color: var(--muted-foreground);">Âä†ËΩΩ‰∏≠...</div>';try{return await new Promise((o,s)=>{const a=document.createElement("script");a.src="/pagefind/pagefind-ui.js",a.onload=o,a.onerror=s,document.head.appendChild(a)}),g(),sessionStorage.setItem(c,"true"),!0}catch(i){return console.error("Failed to load search:",i),t<2?(console.log(`Retrying search load... (${t+1}/2)`),await new Promise(o=>setTimeout(o,1e3)),l(t+1)):(r&&(r.innerHTML=`
          <div style="padding: 2rem; text-align: center;">
            <p style="color: var(--muted-foreground); margin-bottom: 1rem;">ÊêúÁ¥¢ÂäüËÉΩÂä†ËΩΩÂ§±Ë¥•</p>
            <button id="retry-search" style="padding: 0.5rem 1rem; background: var(--accent); color: var(--accent-foreground); border: none; border-radius: 0.375rem; cursor: pointer;">
              ÈáçËØï
            </button>
          </div>
        `,document.getElementById("retry-search")?.addEventListener("click",()=>{sessionStorage.removeItem(c),l(0)})),!1)}}function g(){typeof PagefindUI<"u"&&(new PagefindUI({element:"#pagefind-ui",showSubResults:!0,showImages:!1,excerptLength:15,translations:{placeholder:"ÊêúÁ¥¢ÊñáÁ´†...",clear_search:"Ê∏ÖÈô§",load_more:"Âä†ËΩΩÊõ¥Â§ö",search_label:"ÊêúÁ¥¢Ê≠§Á´ôÁÇπ",filters_label:"Á≠õÈÄâ",zero_results:"Êú™ÊâæÂà∞ÁªìÊûú [SEARCH_TERM]",many_results:"ÊâæÂà∞ [COUNT] ‰∏™ÁªìÊûú [SEARCH_TERM]",one_result:"ÊâæÂà∞ [COUNT] ‰∏™ÁªìÊûú [SEARCH_TERM]",alt_search:"Êú™ÊâæÂà∞ [SEARCH_TERM] ÁöÑÁªìÊûú„ÄÇÊòæÁ§∫ [DIFFERENT_TERM] ÁöÑÁªìÊûú",search_suggestion:"Êú™ÊâæÂà∞ [SEARCH_TERM] ÁöÑÁªìÊûú„ÄÇÂ∞ùËØï‰ª•‰∏ãÊêúÁ¥¢Ôºö",searching:"ÊêúÁ¥¢‰∏≠ [SEARCH_TERM]..."}}),setTimeout(()=>{const t=document.querySelector(".pagefind-ui__search-input");t instanceof HTMLElement&&t.focus()},100))}function u(){if(d)return;d=!0;const t=document.getElementById("search-button"),n=document.getElementById("search-dialog"),r=document.getElementById("close-search");if(!t||!n||!r)return;let i=sessionStorage.getItem(c)==="true";const o=async()=>{n.showModal(),document.body.style.overflow="hidden",i?setTimeout(()=>{const e=document.querySelector(".pagefind-ui__search-input");e instanceof HTMLElement&&e.focus()},100):await l()&&(i=!0)},s=()=>{n.close(),document.body.style.overflow=""},a=e=>{e.target===n&&s()},m=e=>{e.key==="Escape"&&n.open&&s()},f=e=>{(e.metaKey||e.ctrlKey)&&e.key==="k"&&(e.preventDefault(),n.open?s():o())};t.addEventListener("click",o),r.addEventListener("click",s),n.addEventListener("click",a),document.addEventListener("keydown",m),document.addEventListener("keydown",f),document.addEventListener("astro:before-swap",()=>{t.removeEventListener("click",o),r.removeEventListener("click",s),n.removeEventListener("click",a),document.removeEventListener("keydown",m),document.removeEventListener("keydown",f),d=!1},{once:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u();document.addEventListener("astro:page-load",u);</script> <link href="/pagefind/pagefind-ui.css" rel="stylesheet">  </div> </div> </nav> </header>  <main id="main-content" data-pagefind-body class="main-content main-content--wide" data-astro-cid-sckkx6r4>  <div class="blog-post-container" data-astro-cid-wrgicudb> <article class="blog-post" data-astro-cid-wrgicudb> <header class="article-header" data-astro-cid-wrgicudb> <h1 data-astro-cid-wrgicudb>2026Âπ¥ÔºåÊàëÁªà‰∫éÂèØ‰ª•ÂºÄÂßã‰ΩøÁî®Wayland‰∫ÜÂêóÔºü</h1> <div class="article-meta" data-astro-cid-wrgicudb> <a href="https://michael.stapelberg.ch" target="_blank" rel="noopener noreferrer" class="source-tag" data-astro-cid-wrgicudb>michael.stapelberg.ch</a> <span class="separator" data-astro-cid-wrgicudb>¬∑</span> <time data-astro-cid-wrgicudb>2026Âπ¥1Êúà4Êó•</time> </div> </header> <!-- ‰ΩøÁî®Ê∏ÖÊ¥óÂêéÁöÑÂÆâÂÖ® HTML ÂÜÖÂÆπ --> <div class="article-content app-prose" data-astro-cid-wrgicudb><p>Wayland is the successor to the X server (X11, Xorg) to implement the graphics
stack on Linux. The <a href="https://en.wikipedia.org/wiki/Wayland_(protocol)" target="_blank" rel="noopener noreferrer">Wayland</a>
project was actually started in 2008, a year before I created the <a href="https://i3wm.org/" target="_blank" rel="noopener noreferrer">i3 tiling
window manager for X11</a> in 2009 ‚Äî but for the last 18 years
(!), Wayland was never usable on my computers. I don‚Äôt want to be stuck on
deprecated software, so I try to start using Wayland each year, and this
articles outlines what keeps me from migrating to Wayland in 2026.</p>
<h2>Historical context</h2>
<p>For the first few years, Wayland rarely even started on my machines. When I was
lucky enough for something to show up, I could start some toy demo apps in the
demo compositor Weston.</p>
<p>Around 2014, GNOME started supporting Wayland. KDE followed a few years later.
Major applications (like Firefox, Chrome or Emacs) have been slower to adopt
Wayland and needed users to opt into experimental implementations via custom
flags or environment variables, until very recently, or ‚Äî in some cases, like
<code>geeqie</code> ‚Äî still as of today.</p>
<p>Unfortunately, the driver support situation remained poor for many years.  With
nVidia graphics cards, which <a href="/posts/2017-12-11-dell-up3218k/" target="_blank" rel="noopener noreferrer">are the only cards that support my 8K
monitor</a>, Wayland would either not work at all
or exhibit heavy graphics glitches and crashes.</p>
<p>In the 2020s, more and more distributions announced looking to switch to Wayland
by default or even <a href="https://www.phoronix.com/news/Fedora-40-Eyes-No-X11-Session" target="_blank" rel="noopener noreferrer">drop their X11
sessions</a>, and RHEL
is <a href="https://www.redhat.com/en/blog/rhel-10-plans-wayland-and-xorg-server" target="_blank" rel="noopener noreferrer">winding down their contributions to the X
server</a>.</p>
<p>Modern Linux distributions like <a href="https://asahilinux.org/" target="_blank" rel="noopener noreferrer">Asahi Linux</a> (for
Macs, with their own GPU driver!) clearly consider Wayland their primary desktop
stack, and only support X11 on a best-effort basis.</p>
<p>So the pressure to switch to Wayland is mounting! Is it ready now? What‚Äôs
missing?</p>
<h2>Making Wayland start</h2>
<h3>Hardware</h3>
<p>I‚Äôm testing with my lab PC, which is a slightly upgraded version of <a href="/posts/2022-01-15-high-end-linux-pc/" target="_blank" rel="noopener noreferrer">my 2022
high-end Linux PC</a>.</p>
<p>I describe my setup in more details in <a href="/posts/2020-05-23-desk-setup/" target="_blank" rel="noopener noreferrer">stapelberg uses this: my 2020 desk
setup</a>.</p>
<p>Most importantly for this article, I use a <a href="/posts/2017-12-11-dell-up3218k/" target="_blank" rel="noopener noreferrer">Dell 8K 32"
monitor</a> (resolution: 7680x4320!), which, in my
experience, is only compatible with nVidia graphics cards (I try other cards
sometimes).</p>
<p>Hence, both the lab PC and my main PC contain an nVidia GPU:</p>
<ul>
<li>The lab PC contains a nVidia GeForce RTX 4070 Ti.</li>
<li>The main PC contains a nVidia GeForce RTX 3060 Ti.</li>
</ul>
<p>(In case you‚Äôre wondering why I use the older card in my PC: I had a crash once
where I suspected the GPU, so I switched back from the 4070 to my older 3060.)</p>
<h3>nVidia driver support</h3>
<p>For many years, nVidia drivers were entirely unsupported under Wayland.</p>
<p>Apparently, nVidia refused to support the API that Wayland was using, insisting
that their EGLStreams approach was superior. Luckily, with nVidia driver 495
(late 2021), they added support for GBM (Generic Buffer Manager).</p>
<p>But, even with GBM support, while you could now start many Wayland sessions, the
session wouldn‚Äôt run smoothly: You would see severe graphics glitches and
artifacts, preventing you from getting any work done.</p>
<p>The solution for the glitches was <em>explicit sync</em> support: because the nVidia
driver does not support <em>implicit sync</em> (like AMD or Intel), Wayland (and
wlroots, and sway) needed to get <a href="https://zamundaaa.github.io/wayland/2024/04/05/explicit-sync.html" target="_blank" rel="noopener noreferrer">explicit sync
support</a>.</p>
<p>Sway 1.11 (June 2025) and wlroots 0.19.0 are the first version with explicit
sync support.</p>
<h3>Not working: TILE support for 8K monitor</h3>
<p>With the nVidia driver now working <em>per se</em> with Wayland, unfortunately that‚Äôs
still not good enough to use Wayland in my setup: my <a href="/posts/2017-12-11-dell-up3218k/" target="_blank" rel="noopener noreferrer">Dell UP3218K
monitor</a> requires two DisplayPort 1.4
connections with MST (Multi Stream Transport) and <code>TILE</code> support. This
combination worked just fine under X11 for the last 8+ years.</p>
<p>While GNOME successfully configures the monitor with its native resolution of
7680x4320@60, the monitor incorrectly shows up as two separate monitors in sway.</p>
<p>The reason behind this behavior is that <a href="https://gitlab.freedesktop.org/wlroots/wlroots/-/issues/1580" target="_blank" rel="noopener noreferrer">wlroots does not support the <code>TILE</code>
property (issue #1580 from
2019)</a>. Luckily,
in 2023, contributor <code>EBADBEEF</code> sent <a href="https://gitlab.freedesktop.org/wlroots/wlroots/-/merge_requests/4154" target="_blank" rel="noopener noreferrer">draft merge request
!4154</a>,
which adds support for the <code>TILE</code> property.</p>
<p>But, even with the <code>TILE</code> patch, my monitor would not work correctly: The right
half of the monitor would just stay black. The full picture is visible when
taking a screenshot with <code>grim</code>, so it seems like an output issue. I had a few
exchanges about this with <code>EBADBEEF</code> starting in August 2025 (thanks for taking
a look!), but we couldn‚Äôt figure out the issue.</p>
<p>A quarter later, I had made good experiences regarding debugging complex issues
with the coding assistant <a href="https://claude.com/product/claude-code" target="_blank" rel="noopener noreferrer">Claude Code</a>
(Opus 4.5 at the time of writing), so I decided to give it another try. Over two
days, I ran a number of tests to narrow down the issue, letting Claude analyze
source code (of sway, wlroots, Xorg, mesa, ‚Ä¶) and produce test programs that I
could run manually.</p>
<p>Ultimately, I ended up with a minimal reproducer program (independent of
Wayland) that shows how the <code>SRC_X</code> DRM property does not work on nVidia (but
does work on Intel, for example!): I posted a <a href="https://forums.developer.nvidia.com/t/bug-right-half-right-tile-of-my-8k-monitor-is-black-on-wlroots-based-wayland-compositors/355579" target="_blank" rel="noopener noreferrer">bug report with a video in the
nVidia
forum</a>
and hope an nVidia engineer will take a look!</p>
<p>Crucially, with the bug now identified, I had Claude implement a workaround:
copy the right half of the screen (at <code>SRC_X=3840</code>) to another buffer, and then
display <em>that buffer</em>, but with <code>SRC_X=0</code>.</p>
<p>With <a href="https://gitlab.freedesktop.org/wlroots/wlroots/-/merge_requests/4154#note_3249071" target="_blank" rel="noopener noreferrer">that
patch</a>
applied, for the first time, I can use Sway on my 8K monitor! ü•≥</p>
<hr />
<p>By the way, when I mentioned that GNOME successfully configures the native
resolution, that doesn‚Äôt mean the monitor is usable with GNOME! While GNOME
supports tiled displays, the updates of individual tiles are not synchronized,
so you see heavy tearing in the middle of the screen, much worse than anything I
have ever observed under X11. GNOME/mutter <a href="https://gitlab.gnome.org/GNOME/mutter/-/merge_requests/4822" target="_blank" rel="noopener noreferrer">merge request
!4822</a> should
hopefully address this.</p>
<h3>Software: NixOS</h3>
<p>During 2025, I <a href="/posts/tags/nix/" target="_blank" rel="noopener noreferrer">switched all my computers to NixOS</a>. Its
declarative approach is really nice for doing such tests, because you can
reliably restore your system to an earlier version.</p>
<p>To make a Wayland/sway session available on my NixOS 25.11 installation, I added
the following lines to my NixOS configuration file (<code>configuration.nix</code>):</p>
<div><pre><code><span><span><span># GDM display manager (can launch both X11/i3 and Wayland/Sway sessions)</span>
</span></span><span><span>services<span>.</span>displayManager<span>.</span>gdm<span>.</span>enable <span>=</span> <span>true</span>;
</span></span><span><span>services<span>.</span>displayManager<span>.</span>gdm<span>.</span>autoSuspend <span>=</span> <span>false</span>;
</span></span><span><span>
</span></span><span><span><span># enable GNOME (for testing)</span>
</span></span><span><span>services<span>.</span>desktopManager<span>.</span>gnome<span>.</span>enable <span>=</span> <span>true</span>;
</span></span><span><span>
</span></span><span><span>programs<span>.</span>sway <span>=</span> {
</span></span><span><span>  enable <span>=</span> <span>true</span>;
</span></span><span><span>  wrapperFeatures<span>.</span>gtk <span>=</span> <span>true</span>;
</span></span><span><span>  extraOptions <span>=</span> [ <span>"--unsupported-gpu"</span> ];
</span></span><span><span>};
</span></span></code></pre></div><p>I also added the following Wayland-specific programs to <code>environment.systemPackages</code>:</p>
<div><pre><code><span><span>environment<span>.</span>systemPackages <span>=</span> <span>with</span> pkgs; [
</span></span><span><span>  <span># ‚Ä¶</span>
</span></span><span><span>  foot          <span># terminal emulator</span>
</span></span><span><span>  wtype         <span># replacement for xdotool type</span>
</span></span><span><span>  fuzzel        <span># fuzzy matching program starter</span>
</span></span><span><span>  wayland-utils <span># for wayland-info(1)</span>
</span></span><span><span>  gammastep     <span># redshift replacement</span>
</span></span><span><span>];
</span></span></code></pre></div><p>Note that activating this configuration kills your running X11 session, if any.</p>
<p>Just to be sure, I rebooted the entire machine after changing the configuration.</p>
<h2>Experiment results</h2>
<p>With this setup, I spent about one full work day in a Wayland session. Trying to
actually get some work done uncovers issues that might not show in casual
testing. Most of the day was spent trying to fix Wayland issues üòÖ. The
following sections explain what I have learned/observed.</p>
<h3>Desktop: i3 ‚Üí sway</h3>
<p>Many years ago, when Wayland became more popular, people asked on the i3 issue
tracker if i3 would be ported to Wayland. I said no: How could I port a program
to an environment that doesn‚Äôt even run on any of my computers? But also, I knew
that with working a full-time job, I wouldn‚Äôt have time to be an early adopter
and shape Wayland development.</p>
<p>This attitude resulted in Drew DeVault starting the
<a href="https://en.wikipedia.org/wiki/Sway_(window_manager)" target="_blank" rel="noopener noreferrer">Sway</a> project around 2016,
which aims to be a Wayland version of i3. I don‚Äôt see Sway as
competition. Rather, I thought it was amazing that people liked the i3 project
so much that they would go through the trouble of creating a similar program for
other environments! What a nice compliment! üòä</p>
<p>Sway aims to be compatible with i3 configuration files, and it mostly is.</p>
<p>If you‚Äôre curious, here is what I changed from the Sway defaults, mostly moving
key bindings around for the <a href="https://neo-layout.org/" target="_blank" rel="noopener noreferrer">NEO keyboard layout</a> I
use, and configuring <code>input</code>/<code>output</code> blocks that I formerly configured in <a href="https://github.com/stapelberg/configfiles/blob/c896b138b2f50e1badf1ee862678adb820d58473/xsession" target="_blank" rel="noopener noreferrer">my
<code>~/.xsession</code>
file</a>:</p>

my changes to the default Sway config
<div><pre><code><span><span><span>--- /home/michael/src/sway/config.in	2025-09-24 19:08:38.876573260 +0200
</span></span></span><span><span><span></span><span>+++ /home/michael/.config/sway/config	2025-12-31 15:50:38.616697542 +0100
</span></span></span><span><span><span></span><span>@@ -9,19 +9,76 @@
</span></span></span><span><span><span></span> # Logo key. Use Mod1 for Alt.
</span></span><span><span> set $mod Mod4
</span></span><span><span> # Home row direction keys, like vim
</span></span><span><span><span>-set $left h
</span></span></span><span><span><span>-set $down j
</span></span></span><span><span><span>-set $up k
</span></span></span><span><span><span>-set $right l
</span></span></span><span><span><span></span><span>+set $left n
</span></span></span><span><span><span>+set $down r
</span></span></span><span><span><span>+set $up t
</span></span></span><span><span><span>+set $right d
</span></span></span><span><span><span></span> # Your preferred terminal emulator
</span></span><span><span> set $term foot
</span></span><span><span> # Your preferred application launcher
</span></span><span><span><span>-set $menu wmenu-run
</span></span></span><span><span><span></span><span>+set $menu fuzzel
</span></span></span><span><span><span>+
</span></span></span><span><span><span>+font pango:Bitstream Vera Sans Mono 8
</span></span></span><span><span><span>+
</span></span></span><span><span><span>+titlebar_padding 4 2
</span></span></span><span><span><span>+
</span></span></span><span><span><span>+# Make Xwayland windows recognizeable:
</span></span></span><span><span><span>+for_window [shell="xwayland"] title_format "%title [Xwayland]"
</span></span></span><span><span><span>+
</span></span></span><span><span><span>+workspace_layout stacking
</span></span></span><span><span><span>+
</span></span></span><span><span><span>+# Open two terminal windows side-by-side on new workspaces:
</span></span></span><span><span><span>+# https://github.com/stapelberg/workspace-populate-for-i3
</span></span></span><span><span><span>+exec ~/go/bin/workspace-populate-for-i3
</span></span></span><span><span><span>+
</span></span></span><span><span><span>+exec gammastep -l 47.31:8.50 -b 0.9
</span></span></span><span><span><span>+
</span></span></span><span><span><span>+input * {
</span></span></span><span><span><span>+   xkb_layout "de"
</span></span></span><span><span><span>+   xkb_variant "neo"
</span></span></span><span><span><span>+	repeat_delay 250
</span></span></span><span><span><span>+	repeat_rate 30
</span></span></span><span><span><span>+}
</span></span></span><span><span><span>+
</span></span></span><span><span><span>+input * {
</span></span></span><span><span><span>+	accel_profile adaptive
</span></span></span><span><span><span>+	pointer_accel 0.2
</span></span></span><span><span><span>+}
</span></span></span><span><span><span></span> 
</span></span><span><span> ### Output configuration
</span></span><span><span> #
</span></span><span><span><span>-# Default wallpaper (more resolutions are available in @datadir@/backgrounds/sway/)
</span></span></span><span><span><span>-output * bg @datadir@/backgrounds/sway/Sway_Wallpaper_Blue_1920x1080.png fill
</span></span></span><span><span><span></span><span>+output * bg /dev/null fill #333333
</span></span></span><span><span><span>+output * scale 3
</span></span></span><span><span><span></span> #
</span></span><span><span> # Example configuration:
</span></span><span><span> #
</span></span><span><span><span>@@ -33,14 +90,41 @@
</span></span></span><span><span><span></span> #
</span></span><span><span> # Example configuration:
</span></span><span><span> #
</span></span><span><span><span>-# exec swayidle -w \
</span></span></span><span><span><span>-#          timeout 300 'swaylock -f -c 000000' \
</span></span></span><span><span><span>-#          timeout 600 'swaymsg "output * power off"' resume 'swaymsg "output * power on"' \
</span></span></span><span><span><span>-#          before-sleep 'swaylock -f -c 000000'
</span></span></span><span><span><span></span><span>+exec swayidle -w \
</span></span></span><span><span><span>+         before-sleep '~/swaylock.sh' \
</span></span></span><span><span><span>+         lock '~/swaylock.sh'
</span></span></span><span><span><span></span> #
</span></span><span><span> # This will lock your screen after 300 seconds of inactivity, then turn off
</span></span><span><span> # your displays after another 300 seconds, and turn your screens back on when
</span></span><span><span> # resumed. It will also lock your screen before your computer goes to sleep.
</span></span><span><span><span>+bindsym $mod+l exec loginctl lock-session
</span></span></span><span><span><span>+
</span></span></span><span><span><span>+  # Notifications
</span></span></span><span><span><span>+  bindsym $mod+period exec dunstctl close
</span></span></span><span><span><span></span> 
</span></span><span><span> ### Input configuration
</span></span><span><span> #
</span></span><span><span><span>@@ -63,11 +147,13 @@
</span></span></span><span><span><span></span>     # Start a terminal
</span></span><span><span>     bindsym $mod+Return exec $term
</span></span><span><span> 
</span></span><span><span>     # Kill focused window
</span></span><span><span><span>-    bindsym $mod+Shift+q kill
</span></span></span><span><span><span></span><span>+    bindsym $mod+Shift+x kill
</span></span></span><span><span><span></span> 
</span></span><span><span>     # Start your launcher
</span></span><span><span><span>-    bindsym $mod+d exec $menu
</span></span></span><span><span><span></span><span>+    bindsym $mod+a exec $menu
</span></span></span><span><span><span></span> 
</span></span><span><span>     # Drag floating windows by holding down $mod and left mouse button.
</span></span><span><span>     # Resize them with right mouse button + $mod.
</span></span><span><span><span>@@ -142,12 +228,11 @@
</span></span></span><span><span><span></span>     bindsym $mod+v splitv
</span></span><span><span> 
</span></span><span><span>     # Switch the current container between different layout styles
</span></span><span><span><span>-    bindsym $mod+s layout stacking
</span></span></span><span><span><span></span><span>+    bindsym $mod+i layout stacking
</span></span></span><span><span><span></span>     bindsym $mod+w layout tabbed
</span></span><span><span><span>-    bindsym $mod+e layout toggle split
</span></span></span><span><span><span></span> 
</span></span><span><span>     # Make the current focus fullscreen
</span></span><span><span><span>-    bindsym $mod+f fullscreen
</span></span></span><span><span><span></span><span>+    bindsym $mod+e fullscreen
</span></span></span><span><span><span></span> 
</span></span><span><span>     # Toggle the current focus between tiling and floating mode
</span></span><span><span>     bindsym $mod+Shift+space floating toggle
</span></span><span><span><span>@@ -156,7 +241,7 @@
</span></span></span><span><span><span></span>     bindsym $mod+space focus mode_toggle
</span></span><span><span> 
</span></span><span><span>     # Move focus to the parent container
</span></span><span><span><span>-    bindsym $mod+a focus parent
</span></span></span><span><span><span></span><span>+    bindsym $mod+u focus parent
</span></span></span><span><span><span></span> #
</span></span><span><span> # Scratchpad:
</span></span><span><span> #
</span></span><span><span><span>@@ -192,37 +277,25 @@
</span></span></span><span><span><span></span>     bindsym Return mode "default"
</span></span><span><span>     bindsym Escape mode "default"
</span></span><span><span> }
</span></span><span><span><span>-bindsym $mod+r mode "resize"
</span></span></span><span><span><span></span><span>+#bindsym $mod+r mode "resize"
</span></span></span><span><span><span></span> 
</span></span><span><span> #
</span></span><span><span> # Status Bar:
</span></span><span><span> #
</span></span><span><span> # Read `man 5 sway-bar` for more information about this section.
</span></span><span><span> bar {
</span></span><span><span><span>-    position top
</span></span></span><span><span><span></span> 
</span></span><span><span>     # When the status_command prints a new line to stdout, swaybar updates.
</span></span><span><span>     # The default just shows the current date and time.
</span></span><span><span><span>-    status_command while date +'%Y-%m-%d %X'; do sleep 1; done
</span></span></span><span><span><span></span><span>+    status_command i3status
</span></span></span><span><span><span></span> }
</span></span><span><span> 
</span></span></code></pre></div>
<p>I encountered the following issues with Sway:</p>
<ol>
<li>
<p>I don‚Äôt know how I can configure the same libinput settings that I had
before.  See <a href="xinput-list-props-mx-ergo.txt" target="_blank" rel="noopener noreferrer"><code>xinput-list-props-mx-ergo.txt</code></a>
for what I have on X11. Sway‚Äôs available <code>accel_profile</code> settings do not seem
to match what I used before.</p>
</li>
<li>
<p>The mouse cursor / pointer seems laggy, somehow?! It seems to take longer to
react when I move the trackball, and it also seems to move less smoothly
across the screen.</p>
<p><a href="https://github.com/emersion" target="_blank" rel="noopener noreferrer">Simon Ser</a> suspects that this might be because
hardware cursor support might not work with the nVidia drivers currently.</p>
</li>
<li>
<p>No Xwayland scaling: programs started via Xwayland are blurry (by default) or
double-scaled (when setting <code>Xft.dpi: 288</code>). This is a Sway-specific
limitation: <a href="https://pointieststick.com/2022/06/17/this-week-in-kde-non-blurry-xwayland-apps/" target="_blank" rel="noopener noreferrer">KDE fixed this in
2022</a>. From
<a href="https://github.com/swaywm/sway/issues/2966" target="_blank" rel="noopener noreferrer">Sway issue #2966</a>, I can tell
that Sway developers do not seem to like this approach for some reason, but
that‚Äôs <em>very unfortunate</em> for my migration: The backwards compatibility
option of running older programs through Xwayland is effectively unavailable
to me.</p>
</li>
<li>
<p>Sometimes, keyboard shortcuts seem to be executed twice! Like, when I focused
the first of five Chrome windows in a stack and moved that window to another
workspace, <em>two windows</em> would be moved instead of one. I also see messages
like this one (not exactly correlated with the double-shortcut problem,
though):</p>
<pre><code>[ERROR] [wlr] [libinput] event0  - https: kinT (kint36): client bug: event
processing lagging behind by 32ms, your system is too slow
</code></pre><p>‚Ä¶and that seems wrong to me. My <a href="/posts/2025-05-15-my-2025-high-end-linux-pc/" target="_blank" rel="noopener noreferrer">high-end Linux
PC</a> certainly isn‚Äôt slow by any
measure.</p>
</li>
</ol>
<h3>GTK: Font size</h3>
<p>When I first started GTK programs like GIMP or Emacs, I noticed all fonts were
way too large! Apparently, I still had some scaling-related settings that I
needed to reset like so:</p>
<pre><code>gsettings reset org.gnome.desktop.interface scaling-factor
gsettings reset org.gnome.desktop.interface text-scaling-factor
</code></pre><p>Debugging tip: Display GNOME settings using <code>dconf dump /</code> (stored in
<code>~/.config/dconf</code>).</p>
<h3>GTK: Backend</h3>
<p>Some programs like <code>geeqie</code> apparently need an explicit <code>export GDK_BACKEND=wayland</code> environment variable, otherwise they run in
Xwayland. Weird.</p>
<h3>Font rendering</h3>
<p>I also noticed that font rendering is different between X11 and Wayland! The
difference is visible in Chrome browser tab titles and the URL bar, for example:</p>















<a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/2026-01-03-chrome-wayland-x11.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/2026-01-03-chrome-wayland-x11_hu_8822a57b2d4633df.png" width="600" height="219" /></a>



<p>At first I thought that maybe Wayland defaults to different font-antialiasing
and font-hinting settings, but I tried experimenting with the following settings
(which default to <code>font-antialiasing=grayscale</code> and <code>font-hinting=slight</code>), but
couldn‚Äôt get things to render like they did before:</p>
<pre><code>gsettings set org.gnome.desktop.interface font-antialiasing 'rgba'
gsettings set org.gnome.desktop.interface font-hinting 'full'
</code></pre><p><strong>Update</strong>: Thanks to
<a href="https://fosstodon.org/@whynothugo/115836011150423009" target="_blank" rel="noopener noreferrer">Hugo</a> for pointing out
that under Wayland, GTK3 ignores the <code>~/.config/gtk-3.0/settings.ini</code>
configuration file and uses dconf exclusively! Setting the following dconf
setting makes the font rendering match:</p>
<pre><code>gsettings set org.gnome.desktop.interface font-name 'Cantarell 11'
</code></pre><h3>Screen locker: swaylock</h3>
<p>The obvious replacement for <a href="http://i3wm.org/i3lock/" target="_blank" rel="noopener noreferrer"><code>i3lock</code></a> is
<a href="https://github.com/swaywm/swaylock" target="_blank" rel="noopener noreferrer"><code>swaylock</code></a>.</p>
<p>I quickly ran into a difference in architecture between the two programs:</p>
<ul>
<li>
<p>i3lock shows a screen locker window. When you kill i3lock, the screen is
unlocked.</p>
</li>
<li>
<p>When you kill swaylock, you end up in a <em>Red Screen Of Death</em>.</p>
<p>To get out of this state, you need to restart swaylock and unlock. You can
unlock from the command line by sending <code>SIGUSR1</code> to the <code>swaylock</code> process.</p>
</li>
</ul>
<p>This was very surprising to me, but is by (Wayland) design! See <a href="https://github.com/swaywm/sway/issues/7046" target="_blank" rel="noopener noreferrer">Sway issue
#7046</a> for details, and this quote from
the <a href="https://wayland.app/protocols/ext-session-lock-v1" target="_blank" rel="noopener noreferrer"><code>ext-session-lock-v1</code> Wayland protocol</a>:</p>
<blockquote>
<p>‚ÄúThe compositor must stop rendering and provide input to normal
clients. Instead the compositor must blank all outputs with an opaque color
such that their normal content is fully hidden.‚Äù</p>
</blockquote>
<p>OK, so when you start <code>swaylock</code> via SSH for testing, remember to always unlock
instead of just cancelling <code>swaylock</code> with Ctrl+C. And hope it never crashes.</p>
<p>I used to start <code>i3lock</code> via a wrapper script, which turns off the monitor
(input wakes it up):</p>
<div><pre><code><span><span><span>#!/bin/sh
</span></span></span><span><span><span></span><span># Turns on DPMS, mutes all output, locks the screen.</span>
</span></span><span><span><span># Reverts all settings on unlock, or when killed.</span>
</span></span><span><span>
</span></span><span><span>revert<span>()</span> <span>{</span>
</span></span><span><span>    xset dpms <span>0</span> <span>0</span> <span>0</span>
</span></span><span><span>    pactl set-sink-mute @DEFAULT_SINK@ <span>0</span>
</span></span><span><span><span>}</span>
</span></span><span><span><span>trap</span> revert SIGHUP SIGINT SIGTERM
</span></span><span><span>xset +dpms dpms <span>15</span> <span>15</span> <span>15</span>
</span></span><span><span><span>(</span>sleep <span>1</span> <span>&amp;&amp;</span> xset dpms force off<span>)</span> &amp;
</span></span><span><span>pactl set-sink-mute @DEFAULT_SINK@ <span>1</span>
</span></span><span><span>i3lock --raw 3840x2160:rgb --image ~/i3lock-wallpaper-3840x2160.rgb -n 
</span></span><span><span>revert
</span></span></code></pre></div><p>With Wayland, the DPMS behavior has to be implemented differently, with <code>swayidle</code>:</p>
<div><pre><code><span><span><span>#!/bin/sh
</span></span></span><span><span><span></span><span># Turns on DPMS, mutes all output, locks the screen.</span>
</span></span><span><span><span># Reverts all settings on unlock, or when killed.</span>
</span></span><span><span>
</span></span><span><span>swayidle -w <span>\
</span></span></span><span><span><span></span>  timeout <span>5</span> <span>'swaymsg "output * dpms off"'</span> <span>\
</span></span></span><span><span><span></span>  resume <span>'swaymsg "output * dpms on"'</span> &amp;
</span></span><span><span><span>swayidle</span><span>=</span><span>$!</span>
</span></span><span><span>
</span></span><span><span>revert<span>()</span> <span>{</span>
</span></span><span><span>    <span>kill</span> <span>$swayidle</span>
</span></span><span><span>    pactl set-sink-mute @DEFAULT_SINK@ <span>0</span>
</span></span><span><span><span>}</span>
</span></span><span><span><span>trap</span> revert SIGHUP SIGINT SIGTERM
</span></span><span><span>
</span></span><span><span>pactl set-sink-mute @DEFAULT_SINK@ <span>1</span>
</span></span><span><span>swaylock --image ~/i3lock-wallpaper-3840x2160.jpg
</span></span><span><span>revert
</span></span></code></pre></div><h3>i3 IPC automation</h3>
<p>The i3 window manager can be extended via its <a href="https://i3wm.org/docs/ipc.html" target="_blank" rel="noopener noreferrer">IPC interface (interprocess
communication)</a>.</p>
<p>I use a few small tools that use this interface.</p>
<p>I noticed the following issues when using these tools with Sway:</p>
<ol>
<li>
<p>Tools using the <a href="https://pkg.go.dev/go.i3wm.org/i3/v4" target="_blank" rel="noopener noreferrer"><code>go.i3wm.org/i3/v4</code> Go
package</a> need a <a href="https://github.com/RasmusLindroth/i3keys/blob/99e368e4cbb4f82f4e9461c3fd43054add0c3c37/i3parse/config.go#L67" target="_blank" rel="noopener noreferrer">special socket path
hook
currently</a>. We
should probably include transparent handling in the package to ease the
transition.</p>
</li>
<li>
<p>Tools started with <code>exec</code> from the Sway config unexpectedly keep running even
when you exit Sway (<code>swaymsg exit</code>) and log into a new session!</p>
</li>
<li>
<p>My
<a href="https://github.com/stapelberg/workspace-populate-for-i3" target="_blank" rel="noopener noreferrer">workspace-populate-for-i3</a>
did not work:</p>
<ul>
<li>Sway does not implement i3‚Äôs <a href="https://i3wm.org/docs/layout-saving.html" target="_blank" rel="noopener noreferrer">layout
saving/restoring</a> because Drew
decided in 2017 that <a href="https://github.com/swaywm/sway/issues/1005#issuecomment-331526652" target="_blank" rel="noopener noreferrer">the feature is ‚Äútoo complicated and hacky for too
little
benefit‚Äù</a>. Too
bad. I have a couple of layouts I liked that I‚Äôll need to replicate
differently.</li>
<li>Sway does not match workspace nodes with <code>[con_id]</code> criteria. There‚Äôs
<a href="https://github.com/swaywm/sway/pull/8980" target="_blank" rel="noopener noreferrer">pull request #8980</a> (posted
independently, five days ago) to fix that.</li>
</ul>
</li>
<li>
<p>My <a href="https://github.com/stapelberg/wsmgr-for-i3" target="_blank" rel="noopener noreferrer">wsmgr-for-i3</a> worked
partially:</p>
<ul>
<li>Restoring workspaces (<code>wsmgr restore</code>) worked.</li>
<li>Sway‚Äôs <a href="https://i3wm.org/docs/userguide.html#_renaming_workspaces" target="_blank" rel="noopener noreferrer"><code>rename workspace</code>
command</a>
implementation does not seem to pick up workspace numbers from the target
name.</li>
</ul>
</li>
</ol>
<h3>Terminal: foot</h3>
<p>On X11, I use the <a href="https://wiki.archlinux.org/title/Rxvt-unicode" target="_blank" rel="noopener noreferrer">rxvt-unicode</a>
(URxvt) terminal emulator. It has a couple of quality-of-life features that I
don‚Äôt want to lose, aside from being fast and coming with a minimal look:</p>
<ul>
<li>Backwards search through your scrollback (= command output)</li>
<li>Opening URLs in your scrollback using keyboard shortcuts</li>
<li>Opening a new terminal window in the same working directory</li>
<li>Updating the terminal title from your shell</li>
</ul>
<p>In earlier experiments, I tried Alacritty or Kitty, but wasn‚Äôt happy with
either.</p>
<p>Thanks to <a href="https://anarc.at/software/desktop/wayland/#terminal-xterm-foot" target="_blank" rel="noopener noreferrer">anarcat‚Äôs blog post ‚ÄúWayland: i3 to Sway
migration‚Äù</a>, I
discovered the <a href="https://codeberg.org/dnkl/foot" target="_blank" rel="noopener noreferrer"><code>foot</code> terminal emulator</a>, which
looks like a really nice option!</p>
<p>I started a <a href="https://github.com/stapelberg/configfiles/commit/7cc2c08dca5dd195ce47166c57deb44e7d68909d" target="_blank" rel="noopener noreferrer"><code>foot.ini</code> config
file</a>
to match my URxvt config, but later I noticed that at least some colors don‚Äôt
seem to match (some text lines with green/red background looked different). I‚Äôm
not sure why and have not yet looked into it any further.</p>
<p>I noticed the following issues using <code>foot</code>:</p>
<ul>
<li>
<p>Pressing Ctrl+Enter (which I seem to do by mistake quite a bit) results in
escape sequences, whereas URxvt just treats Ctrl+Enter like Enter.</p>
<p>This can be worked around in your shell (Zsh, in my case), see <a href="https://codeberg.org/dnkl/foot/issues/628" target="_blank" rel="noopener noreferrer">foot issue
#628</a> for details.</p>
</li>
<li>
<p>Double-clicking on part of a URL with the mouse selects the URL (as expected),
but without the <code>https:</code> scheme prefix! Annoying when you do want to use the
mouse.</p>
<p>I can hold Ctrl to work around this, which will make <code>foot</code> select everything
under the pointer up to, and until, the next space characters.</p>
</li>
<li>
<p>Starting <a href="https://manpages.debian.org/screen.1" target="_blank" rel="noopener noreferrer"><code>screen(1)</code></a>
 in <code>foot</code> results in not having
color support for programs running inside the <code>screen</code> session. Probably a
terminfo-related problem somehow‚Ä¶? I can also reproduce this issue with GNOME
terminal. But with URxvt or <a href="https://en.wikipedia.org/wiki/Xterm" target="_blank" rel="noopener noreferrer">xterm</a>, it
works.</p>
</li>
<li>
<p>Selecting text highlights the text within the line, but not the entire line.
This is different from other terminal emulators I am used to, but I don‚Äôt see
an option to change it.</p>
<p>Here‚Äôs a screenshot showing <code>foot</code> after triple-clicking on the right of
‚Äúkthreadd‚Äù:</p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/foot-triple-long.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/foot-triple-long_hu_ac615569c350b15a.png" alt="triple-click in foot on a top(1) output line highlights the whole line" title="triple-click in foot on a top(1) output line highlights the whole line" width="600" height="188" /></a>
  
  

<p>But triple-clicking on an echo output line highlights only the contents, not
the whole line:</p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/foot-triple-short.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/foot-triple-short_hu_d228c42ae1be0723.png" alt="triple-click in foot on an echo output line highlights only the contents, not the whole line" title="triple-click in foot on an echo output line highlights only the contents, not the whole line" width="600" height="188" /></a>
  
  

</li>
</ul>
<h3>Text editor: Emacs</h3>
<p>I find Emacs‚Äôs Wayland support rather disappointing. The standard version of
Emacs only supports X11, so on Sway, it starts in Xwayland. Because Sway does
not support scaling with Xwayland, Emacs shows up blurry (top/background
window):</p>















<a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/emacs-blurry.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/emacs-blurry_hu_1f4eb4e05ba1b280.png" alt="Emacs being blurry in Xwayland" title="Emacs being blurry in Xwayland" width="600" height="178" /></a>



<p>Native Wayland support (bottom/foreground window) is only available in the
<code>pgtk</code> Emacs version (<code>emacs-pgtk</code> on NixOS). <code>pgtk</code> used to be a separate
branch, but was merged in Emacs¬†29 (July 2023). There seem to be issues
with <code>pgtk</code> on X11 (you get a warning when starting Emacs-pgtk on X11), so there
have to be two separate versions for now‚Ä¶</p>
<p>Unfortunately, the <code>pgtk</code> text rendering looks different than native X11 text
rendering! The line height and letter spacing seems different:</p>















<a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/2026-01-01-emacs-pgtk-text.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/2026-01-01-emacs-pgtk-text_hu_3f7d94e78f26ace1.png" alt="Different text rendering in Emacs (pgtk vs. X11)" title="Different text rendering in Emacs (pgtk vs. X11)" width="600" height="217" /></a>



<p>I‚Äôm not sure why it‚Äôs different! Does anybody know how to make it match the old
behavior?</p>
<p>Aside from the different text rendering, the other major issue for me is input
latency: Emacs-pgtk feels significantly slower (less responsive) than
Emacs. This was reported on Reddit multiple times (<a href="https://www.reddit.com/r/emacs/comments/1k9ihp7/emacs_sluggish_ui_with_pgtk_wayland_4k_fractional/" target="_blank" rel="noopener noreferrer">thread
1</a>,
<a href="https://www.reddit.com/r/emacs/comments/1acdieh/pgtk_emacs_high_input_lag_at_large_frame_sizes_on/" target="_blank" rel="noopener noreferrer">thread
2</a>)
and <a href="https://debbugs.gnu.org/cgi/bugreport.cgi?bug=71591" target="_blank" rel="noopener noreferrer">Emacs bug #71591</a>, but
there doesn‚Äôt seem to be any solution.</p>
<p>I‚Äôll also need a solution for running Emacs remotely. Thus far, I use X11
forwarding over SSH (which works fine and with low latency over fiber
connections). I should probably check out waypipe, but have not yet had a
chance.</p>
<h3>Browser: Chrome</h3>
<p>When starting Chrome and checking the <code>chrome://gpu</code> debug page, things look
good:</p>















<a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/chrome-gpu-wayland.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/chrome-gpu-wayland_hu_546fe7df2c265248.png" alt="chrome://gpu on Sway" title="chrome://gpu on Sway" width="600" height="619" /></a>



<p>But rather quickly, after moving and resizing browser windows, the GPU process
dies with messages like the following and, for example, WebGL is no longer
hardware accelerated:</p>
<pre><code>ERROR:ui/ozone/platform/wayland/gpu/gbm_pixmap_wayland.cc:95] Cannot create bo with format=RGBA_8888 and usage=Scanout|Rendering|Texturing
ERROR:ui/gfx/linux/gbm_wrapper.cc:405] Failed to create BO with modifiers: Invalid argument (22)
ERROR:ui/ozone/platform/wayland/gpu/gbm_pixmap_wayland.cc:95] Cannot create bo with format=RGBA_8888 and usage=Texturing
ERROR:gpu/command_buffer/service/shared_image/shared_image_factory.cc:981] CreateSharedImage: could not create backing.
ERROR:gpu/command_buffer/service/shared_image/shared_image_manager.cc:397] SharedImageManager::ProduceSkia: Trying to Produce a Skia representation from a non-existent mailbox.
ERROR:components/viz/service/gl/exit_code.cc:13] Restarting GPU process due to unrecoverable error. Context was lost.
R:gpu/ipc/client/command_buffer_proxy_impl.cc:321] GPU state invalid after WaitForGetOffsetInRange.
ERROR:content/browser/gpu/gpu_process_host.cc:1005] GPU process exited unexpectedly: exit_code=8704
</code></pre><p>Of course, using a browser without hardware acceleration is very frustrating,
especially at high resolutions. Starting Chrome with <code>--disable-gpu-compositing</code>
seems to work around the GPU process exiting, but Chrome still does not feel as
smooth as on X11.</p>
<p>Another big issue for me is that Sway does not open Chrome windows on the
workspace on which I closed them. Support for tracking and restoring the
<code>_NET_WM_DESKTOP</code> EWMH atom was added to i3 in <a href="https://github.com/i3/i3/commit/328035fb7e98630862ae8b43088631f62b807c77" target="_blank" rel="noopener noreferrer">January
2016</a>
and to Chrome in <a href="https://chromium.googlesource.com/chromium/src.git/+/06405c5944436b431f26037fdc93340842c51de5%5E%21/" target="_blank" rel="noopener noreferrer">May
2016</a>
and Firefox in <a href="https://hg-edge.mozilla.org/integration/autoland/rev/323e2a212629" target="_blank" rel="noopener noreferrer">March
2020</a>.</p>
<p>I typically have 5+ workspaces and even more Chrome windows at any given point,
so having to sort through 10+ Chrome windows every day (when I boot my work
computer) is <strong>very annoying</strong>.</p>
<p><a href="https://github.com/emersion" target="_blank" rel="noopener noreferrer">Simon Ser</a> said that this would be addressed with
a new Wayland protocol (<a href="https://gitlab.freedesktop.org/wayland/wayland-protocols/-/merge_requests/18" target="_blank" rel="noopener noreferrer"><code>xdg-session-management</code>, merge request
!18</a>).</p>
<h3>Screensharing</h3>
<p>I work remotely a lot, so screen sharing is a table-stakes feature for me.  I
use screen sharing in my browser almost every day, in different scenarios and
with different requirements.</p>
<p>In X11, I am used to the following experience with Chrome. I click the ‚ÄúWindow‚Äù
tab and see previews of my windows. When I select the window and confirm, its
contents get shared:</p>















<a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/screenshare-x11.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/screenshare-x11_hu_5eadab053d491b69.png" alt="screensharing behavior in Chrome (X11)" title="screensharing behavior in Chrome (X11)" width="600" height="338" /></a>



<p>To get screen sharing to work in Wayland/sway, you need to install
<code>xdg-desktop-portal</code> and <code>xdg-desktop-portal-wlr</code> (the latter is specific to
wlroots, which sway uses).</p>
<p>With these packages set up, this is the behavior I see:</p>
<ul>
<li>I can share a Chrome tab.</li>
<li>I can share the entire monitor.</li>
<li>I <em>cannot</em> share a specific window (the entire monitor shows up as a single
window).</li>
</ul>
<p>This is <a href="https://github.com/emersion/xdg-desktop-portal-wlr/issues/107" target="_blank" rel="noopener noreferrer">a limitation of <code>xdg-desktop-portal-wlr</code> (and
others)</a>, which
should be addressed with the upcoming Sway 1.12 release.</p>
<p>I changed my NixOS configuration to use sway and wlroots from git to try it
out. When I click on the ‚ÄúWindow‚Äù tab, I see a chooser in which I need to select
a window:</p>















<a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/screenshare-select1-featured.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/screenshare-select1-featured_hu_4b360882013550cc.png" alt="screensharing behavior in Sway" title="screensharing behavior in Sway" width="600" height="338" /></a>



<p>After selecting the window, I see <em>only that window‚Äôs contents</em> previewed in
Chrome:</p>















<a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/screenshare-select2.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/screenshare-select2_hu_a0d8fb229067ea48.png" alt="screensharing behavior in Sway" title="screensharing behavior in Sway" width="600" height="338" /></a>



<p>After confirming, I get another chooser and need to select the window
again. Notably, there is no connection between the previewed window and the
chosen window in this second step ‚Äî if I chose a different window, that‚Äôs what
will be shared:</p>















<a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/screenshare-select3.png" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/screenshare-select3_hu_de76f21970bd6130.png" alt="screensharing behavior in Sway" title="screensharing behavior in Sway" width="600" height="338" /></a>



<p>Now that window is screenshared (so the feature now works; nice!), but
unfortunately in low resolution, meaning the text is blurry for my co-workers.</p>
<p>I reported this as <a href="https://github.com/emersion/xdg-desktop-portal-wlr/issues/364" target="_blank" rel="noopener noreferrer">xdg-desktop-portal-wlr issue
#364</a> and it
seems like the issue is that the wrong scale factor is applied. The patch
provided in the issue works for me.</p>
<p>But, on a high level, the whole flow seems wrong: I shouldn‚Äôt see a chooser when
clicking on Chrome‚Äôs ‚ÄúWindow‚Äù tab. I should see previews of all windows. I
should be able to select the window in Chrome, not with a separate chooser.</p>
<h3>Scaling Glitches</h3>
<p>I also noticed a very annoying glitch when output scaling is enabled: the
contents of (some!) windows would ‚Äújump around‚Äù as I was switching between
windows (in a tabbed or stacked container) or between workspaces.</p>
<p>I first noticed this in the <code>foot</code> terminal emulator, where the behavior is as follows:</p>
<ol>
<li>Switch focus to another <code>foot</code> terminal by changing workspaces, or by
switching focus within a stacked or tabbed container.</li>
<li>The new <code>foot</code> terminal shows up with its text contents slightly offset.</li>
<li>Within a few milliseconds, <code>foot</code>‚Äôs text jumps to the correct position.</li>
</ol>
<p>I captured the following frame with my iPhone just as the content was moving a
few pixels, shortly after switching focus to this window:</p>















<a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/foot-move.jpg" target="_blank" rel="noopener noreferrer"><img src="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/foot-move_hu_ba49c2e51c18f85f.jpg" alt="foot content moving around" title="foot content moving around" width="600" height="338" /></a>



<p>Later, I also noticed that Chrome windows briefly <a href="https://github.com/emersion/xdg-desktop-portal-wlr/issues/364#issuecomment-3702287572" target="_blank" rel="noopener noreferrer">show up blurry after
switching</a>.</p>
<p>My guess is that because Sway sets the scale factor to 1 for invisible windows,
when switching focus you see a scale-1 content buffer until the application
provided its scale-3 content buffer.</p>
<h3>Notifications: dunst</h3>
<p>dunst supports Wayland natively. I tried dunst 1.13 and did not notice any
issues.</p>
<h3>Picker: rofi</h3>
<p>rofi works on Wayland since v2.0.0 (2025-09-01).</p>
<p>I use rofi with <a href="https://github.com/fdw/rofimoji" target="_blank" rel="noopener noreferrer">rofimoji</a> as my Emoji
picker. For text input, instead of <code>xdotool</code>, <code>wtype</code> seems to work. I didn‚Äôt
notice any issues.</p>
<h3>Screenshots: grim?</h3>
<p>Instead of my usual choice <a href="https://manpages.debian.org/maim.1" target="_blank" rel="noopener noreferrer"><code>maim(1)</code></a>
, I tried <a href="https://manpages.debian.org/grim.1" target="_blank" rel="noopener noreferrer"><code>grim(1)</code></a>
, but unfortunately <code>grim</code>‚Äôs <code>-T</code> flag to select the
window to capture is rather cumbersome to use (and captures in 1x scale).</p>
<p>Does anyone have any suggestions for a good alternative?</p>
<h2>Conclusion</h2>
<p>Finally I made some progress on getting a Wayland session to work in my
environment!</p>
<p>Before giving my verdict on this Wayland/sway experiment, let me explain that my
experience on X11/i3 is really good. I don‚Äôt see any tearing or other artifacts
or glitches in my day-to-day computer usage. I don‚Äôt use a compositor, so my
input latency is really good: I once measured it to approximately 763 Œºs in
Emacs on X11 with my custom-built keyboard (plus output latency), see <a href="/posts/2018-04-17-kinx-latency-measurement/" target="_blank" rel="noopener noreferrer">kinX:
latency measurement (2018)</a>.</p>
<p>So from my perspective, switching from this existing, flawlessly working stack
(for me) to Sway only brings downsides. I observe new graphical glitches that I
didn‚Äôt have before. The programs I spend most time in (Chrome and Emacs) run
noticeably worse. Because of the different implementations, or because I need to
switch programs entirely, I encounter a ton of new bugs.</p>
<p>For the first time, an on-par Wayland experience seems within reach, but
realistically it will require weeks or even months of work still. In my
experience, debugging sessions quickly take hours as I need to switch graphics
cards and rewire monitors to narrow down bugs. I don‚Äôt have the time to
contribute much to fixing these numerous issues unfortunately, so I‚Äôll keep
using X11/i3 for now.</p>
<p>For me, a Wayland/Sway session will be ready as my daily driver when:</p>
<ul>
<li>Sway no longer triggers some key bindings twice some times (‚Äúghost key
presses‚Äù)</li>
<li>I no longer see glitches when switching between windows or workspaces in Sway.</li>
<li>Chrome is continuously hardware-accelerated.</li>
<li>Chrome windows are restored to their previous workspace when starting.</li>
<li>Emacs either:
<ul>
<li>Runs via Xwayland and Sway makes scaling work.</li>
<li>Or if its <code>pgtk</code> variant fixes its input latency issues
and can be made to render text the same as before somehow.</li>
</ul>
</li>
</ul>
</div> <footer class="article-footer" data-astro-cid-wrgicudb> <div class="action-row" data-astro-cid-wrgicudb> <a href="https://michael.stapelberg.ch/posts/2026-01-04-wayland-sway-in-2026/" target="_blank" rel="noopener noreferrer" class="read-original-btn" data-astro-cid-wrgicudb>
ÈòÖËØªÂéüÊñá ‚Üó
</a> </div> <div class="back-to-list" data-astro-cid-wrgicudb> <a href="/reading-list" class="back-link" data-astro-cid-wrgicudb>‚Üê ËøîÂõûËÆ¢ÈòÖÂàóË°®</a> </div> </footer> </article> </div>  </main> <footer class="site-footer" aria-label="Site footer" data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <p class="footer-text" data-astro-cid-sz7xmlte>
&copy; 2026 AstroBlog
</p> <p class="footer-text" data-astro-cid-sz7xmlte>
Built with  <a href="https://astro.build/" target="_blank" rel="noopener noreferrer" class="footer-link" data-astro-cid-sz7xmlte>
Astro
</a> </p> </div> </footer>  </body></html> 